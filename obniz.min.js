var Obniz=function(e){var t={};function r(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){(function(t){const i=r(250),s=r(58),n="undefined"==typeof window;if(e.exports=class extends i{constructor(e,t){super(e,t)}repeat(e,t){if(this.looper)return void(this.looper=e);this.looper=e;let r=this;t||(t=100),async function e(){"function"==typeof r.looper&&(await r.looper(),setTimeout(e,t))}()}wsOnClose(){super.wsOnClose(),this.looper&&(this.looper=null)}message(e,t){let r=[];"string"==typeof e?r.push(e):r=e,this.send({message:{to:r,data:t}})}notifyToModule(e){if(super.notifyToModule(e),"object"==typeof e.message&&this.onmessage&&this.onmessage(e.message.data,e.message.from),"object"==typeof e.debug){if(e.debug.warning){let t="Warning: "+e.debug.warning.message;this.warning({alert:"warning",message:t})}if(e.debug.error){let t="Error: "+e.debug.error.message;this.error({alert:"error",message:t})}this.ondebug&&this.ondebug(e.debug)}}warning(e){if(this.isNode)console.error(e);else{if(e&&"object"==typeof e&&e.alert)return this.showAlertUI(e),void console.log(e.message);a(new Error(e))}}error(e){this.isNode?console.error(e):(e&&"object"==typeof e&&e.alert&&(this.showAlertUI(e),e=e.message),a(new Error(e)),console.error(new Error(e)))}static get api(){return s}},!n){function a(e){if(!window.parent||!window.parent.logger)throw e;window.parent.logger.onObnizError(e)}window&&window.parent&&window.parent.userAppLoaded&&window.parent.userAppLoaded(window)}r(5).context=r(13),r(5).context&&r(5).context.setBaseDir&&r(5).context.setBaseDir(t);let o=r(56);for(let e of o.keys())o(e)}).call(this,"/")},function(e,t,r){const i=r(218);let s={};e.exports=class e{constructor(e){this.delegate=e,this.COMMAND_FUNC_ID_ERROR=255,this.ioNotUsed=255}static get schema(){return i}static get CommandClasses(){return s}static addCommandClass(e,t){s[e]=t}static framed(e,t,r){var i,s=0;if(r&&(s=r.length),s<=63)i=0;else if(s<=16383)i=1;else{if(!(s<=1073741823))throw new Error("too big payload");i=2}var n=0==i?0:1==i?1:3,a=3+n,o=new Uint8Array(a+s),c=0;for(o[c++]=127&e,o[c++]=t,o[c++]=i<<6|s>>8*n;n>0;)n--,o[c++]=s>>8*n;return 0==s?o:(o.set(r,a),o)}static dequeueOne(e){if(!e||0==e.byteLength)return null;if(e.byteLength<3)throw new Error("something wrong. buf less than 3");if(128&e[0])throw new Error("reserved bit 1");var t=127&e[0],r=e[1],i=e[2]>>6&3,s=0==i?0:1==i?1:3;if(4==i)throw new Error("invalid length");for(var n=(63&e[2])<<8*s,a=3,o=s;o>0;)o--,n+=e[a]<<8*o,a++;return{module:t,func:r,payload:e.slice(3+s,3+s+n),next:e.slice(3+s+n)}}static compress(t,r){var i=null;function s(t,r,s){var n=e.framed(t,r,s);if(i){var a=new Uint8Array(i.length+n.length);a.set(i,0),a.set(n,i.length),i=a}else i=n}for(let e=0;e<t.length;e++){const i=t[e];i.parsed=s,i.parseFromJson(r)}return i}sendCommand(e,t){this.delegate&&this.delegate.onParsed&&this.delegate.onParsed(this.module,e,t),this.parsed&&this.parsed(this.module,e,t)}parseFromJson(e){}notifyFromBinary(e,t,r){switch(t){case this.COMMAND_FUNC_ID_ERROR:e.debug||(e.debug={});var i={module:this.module,_args:[...r]};3==r.byteLength?(i.err0=r[0],i.err1=r[1],i.function=r[2],i.message=`Error module=${this.module} func=${i.function} err0=${i.err0} returned=${i.err1}`):i.message=`Error module=${this.module} with + ${i._args}`,e.debug.error=i}}envelopWarning(e,t,r){e[t]||(e[t]={}),e[t].warning=r}envelopError(e,t,r){e[t]||(e[t]={}),e[t].error=r}isValidIO(e){return"number"==typeof e&&0<=e&&e<=11}getSchema(e){return i.getSchema(e)}validateCommandSchema(e,t,r,i){let s={valid:0,invalid:0,results:[],invalidButLike:[]};for(let n of e){let e=this.validate(n.uri,t);if(s.results.push(e),e.valid)s.valid++,n.onValid&&n.onValid.bind(this)(this.filter(n.uri,t),i);else{s.invalid++;let t=this.onlyTypeErrorMessage(e,r);t&&s.invalidButLike.push({uri:n.uri,message:t})}}return s}validate(e,t){let r=this.getSchema(e);return i.validateMultiple(t,r)}onlyTypeErrorMessage(e,t){if(e.valid)return!0;if(e.missing&&e.missing.length>0)return!1;let r=[i.errorCodes.ANY_OF_MISSING,i.errorCodes.ONE_OF_MISSING,i.errorCodes.ONE_OF_MULTIPLE,i.errorCodes.NOT_PASSED,i.errorCodes.OBJECT_REQUIRED,i.errorCodes.OBJECT_ADDITIONAL_PROPERTIES,i.errorCodes.CIRCULAR_REFERENCE,i.errorCodes.FORMAT_CUSTOM,i.errorCodes.KEYWORD_CUSTOM,i.errorCodes.UNKNOWN_PROPERTY],s=[];for(let n of e.errors){if(n.code===i.errorCodes.INVALID_TYPE){if("object"===n.params.type||"object"===n.params.expected)return!1}else if(r.includes(n.code))return!1;let e=t+n.dataPath.replace(/\//g,".");s.push(`[${e}]${n.message}`)}return s.join(";")}filter(e,t){let r=this.getSchema(e);return this._filterSchema(r,t)}_filterSchema(e,t){if(e.$ref){let r=i.getSchema(e.$ref);return this._filterSchema(r,t)}if(void 0===t)return e.default;if("string"===e.type||"integer"===e.type||"boolean"===e.type||"number"===e.type||"null"===e.type||"pass_all"===e.filter)return t;if("array"===e.type){let r=[];for(let i in t)r[i]=this._filterSchema(e.items,t[i]);return r}if("object"===e.type){let r={};for(let i in e.properties)r[i]=this._filterSchema(e.properties[i],t[i]);for(let i in e.patternProperties){let s=new RegExp(i);for(let n of Object.keys(t))s.test(n)&&(r[n]=this._filterSchema(e.patternProperties[i],t[n]))}return r}throw Error("unknown json schema type")}get WSCommandNotFoundError(){return n}};class n extends Error{}},function(e,t,r){(function(t){let i="undefined"==typeof window;e.exports=class{constructor(e){this.obniz=e}createCanvasContext(e,t){if(!this.obniz.isNode){var i=document.createElement("canvas");return i.width=e,i.height=t,i.style["-webkit-font-smoothing"]="none",document.getElementsByTagName("body")[0].appendChild(i),i.getContext("2d")}try{const{createCanvas:e}=r(16);return e(this.width,this.height)}catch(e){throw new Error("obniz.js require node-canvas to draw rich contents. see more detail on docs")}}static _keyFilter(e,t){var r={};return"object"!=typeof e?r:r=Object.keys(e).filter(e=>t.includes(e)).reduce((t,r)=>(t[r]=e[r],t),{})}static _requiredKeys(e,t){if("object"!=typeof e)return t[0];for(var r in t)if(!(t[r]in e))return t[r];return null}static dataArray2string(e){var s=null;try{if(i){const i=r(241).StringDecoder;i&&(s=new i("utf8").write(t.from(e)))}else TextDecoder&&(s=new TextDecoder("utf-8").decode(new Uint8Array(e)))}catch(e){}return s}static string2dataArray(e){if(i)return[...t(e)];if(TextEncoder){const t=new TextEncoder("utf-8").encode(e);for(var r=new Array(t.length),s=0;s<t.length;s++)r[s]=t[s];return r}return null}}}).call(this,r(4).Buffer)},function(e,t){e.exports=class{constructor(){this.keys=["vcc","gnd","signal"],this.requiredKeys=["signal"],this.drive="5v"}wired(e){this.obniz=e,e.setVccGnd(this.params.vcc,this.params.gnd,this.drive),this.ad=e.getAD(this.params.signal),this.ad.start(function(e){this.temp=this.calc(e),this.onchange(this.temp)}.bind(this))}onchange(e){}calc(e){return 0}}},function(e,t,r){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var i=r(244),s=r(243),n=r(242);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,r){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return d(this,e,t,r)}function d(e,t,r,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,i){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,r):new Uint8Array(t,r,i);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=l(e,t);return e}(e,t,r,i):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!c.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|m(t,r),s=(e=o(e,i)).write(t,r);s!==i&&(e=e.slice(0,s));return e}(e,t,r):function(e,t){if(c.isBuffer(t)){var r=0|p(t.length);return 0===(e=o(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?o(e,0):l(e,t);if("Buffer"===t.type&&n(t.data))return l(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(h(t),e=o(e,t<0?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function l(e,t){var r=t.length<0?0:0|p(t.length);e=o(e,r);for(var i=0;i<r;i+=1)e[i]=255&t[i];return e}function p(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function m(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return D(e).length;default:if(i)return z(e).length;t=(""+t).toLowerCase(),i=!0}}function f(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function g(e,t,r,i,s){if(0===e.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=s?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(s)return-1;r=e.length-1}else if(r<0){if(!s)return-1;r=0}if("string"==typeof t&&(t=c.from(t,i)),c.isBuffer(t))return 0===t.length?-1:y(e,t,r,i,s);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,i,s);throw new TypeError("val must be string, number or Buffer")}function y(e,t,r,i,s){var n,a=1,o=e.length,c=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;a=2,o/=2,c/=2,r/=2}function d(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(s){var h=-1;for(n=r;n<o;n++)if(d(e,n)===d(t,-1===h?0:n-h)){if(-1===h&&(h=n),n-h+1===c)return h*a}else-1!==h&&(n-=n-h),h=-1}else for(r+c>o&&(r=o-c),n=r;n>=0;n--){for(var u=!0,l=0;l<c;l++)if(d(e,n+l)!==d(t,l)){u=!1;break}if(u)return n}return-1}function v(e,t,r,i){r=Number(r)||0;var s=e.length-r;i?(i=Number(i))>s&&(i=s):i=s;var n=t.length;if(n%2!=0)throw new TypeError("Invalid hex string");i>n/2&&(i=n/2);for(var a=0;a<i;++a){var o=parseInt(t.substr(2*a,2),16);if(isNaN(o))return a;e[r+a]=o}return a}function _(e,t,r,i){return F(z(t,e.length-r),e,r,i)}function b(e,t,r,i){return F(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,i)}function w(e,t,r,i){return b(e,t,r,i)}function C(e,t,r,i){return F(D(t),e,r,i)}function x(e,t,r,i){return F(function(e,t){for(var r,i,s,n=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),i=r>>8,s=r%256,n.push(s),n.push(i);return n}(t,e.length-r),e,r,i)}function S(e,t,r){return 0===t&&r===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,r))}function A(e,t,r){r=Math.min(e.length,r);for(var i=[],s=t;s<r;){var n,a,o,c,d=e[s],h=null,u=d>239?4:d>223?3:d>191?2:1;if(s+u<=r)switch(u){case 1:d<128&&(h=d);break;case 2:128==(192&(n=e[s+1]))&&(c=(31&d)<<6|63&n)>127&&(h=c);break;case 3:n=e[s+1],a=e[s+2],128==(192&n)&&128==(192&a)&&(c=(15&d)<<12|(63&n)<<6|63&a)>2047&&(c<55296||c>57343)&&(h=c);break;case 4:n=e[s+1],a=e[s+2],o=e[s+3],128==(192&n)&&128==(192&a)&&128==(192&o)&&(c=(15&d)<<18|(63&n)<<12|(63&a)<<6|63&o)>65535&&c<1114112&&(h=c)}null===h?(h=65533,u=1):h>65535&&(h-=65536,i.push(h>>>10&1023|55296),h=56320|1023&h),i.push(h),s+=u}return function(e){var t=e.length;if(t<=q)return String.fromCharCode.apply(String,e);var r="",i=0;for(;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=q));return r}(i)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,r){return d(null,e,t,r)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,r){return function(e,t,r,i){return h(t),t<=0?o(e,t):void 0!==r?"string"==typeof i?o(e,t).fill(r,i):o(e,t).fill(r):o(e,t)}(null,e,t,r)},c.allocUnsafe=function(e){return u(null,e)},c.allocUnsafeSlow=function(e){return u(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,i=t.length,s=0,n=Math.min(r,i);s<n;++s)if(e[s]!==t[s]){r=e[s],i=t[s];break}return r<i?-1:i<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!n(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var i=c.allocUnsafe(t),s=0;for(r=0;r<e.length;++r){var a=e[r];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,s),s+=a.length}return i},c.byteLength=m,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)f(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)f(this,t,t+3),f(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)f(this,t,t+7),f(this,t+1,t+6),f(this,t+2,t+5),f(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?A(this,0,e):function(e,t,r){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return A(this,t,r);case"ascii":return O(this,t,r);case"latin1":case"binary":return E(this,t,r);case"base64":return S(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,r);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,r,i,s){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===s&&(s=this.length),t<0||r>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(i>=s&&t>=r)return 0;if(i>=s)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,i>>>=0,s>>>=0,this===e)return 0;for(var n=s-i,a=r-t,o=Math.min(n,a),d=this.slice(i,s),h=e.slice(t,r),u=0;u<o;++u)if(d[u]!==h[u]){n=d[u],a=h[u];break}return n<a?-1:a<n?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)},c.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var s=this.length-t;if((void 0===r||r>s)&&(r=s),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var n=!1;;)switch(i){case"hex":return v(this,e,t,r);case"utf8":case"utf-8":return _(this,e,t,r);case"ascii":return b(this,e,t,r);case"latin1":case"binary":return w(this,e,t,r);case"base64":return C(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,r);default:if(n)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),n=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var q=4096;function O(e,t,r){var i="";r=Math.min(e.length,r);for(var s=t;s<r;++s)i+=String.fromCharCode(127&e[s]);return i}function E(e,t,r){var i="";r=Math.min(e.length,r);for(var s=t;s<r;++s)i+=String.fromCharCode(e[s]);return i}function P(e,t,r){var i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var s="",n=t;n<r;++n)s+=L(e[n]);return s}function k(e,t,r){for(var i=e.slice(t,r),s="",n=0;n<i.length;n+=2)s+=String.fromCharCode(i[n]+256*i[n+1]);return s}function $(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,r,i,s,n){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<n)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function j(e,t,r,i){t<0&&(t=65535+t+1);for(var s=0,n=Math.min(e.length-r,2);s<n;++s)e[r+s]=(t&255<<8*(i?s:1-s))>>>8*(i?s:1-s)}function I(e,t,r,i){t<0&&(t=4294967295+t+1);for(var s=0,n=Math.min(e.length-r,4);s<n;++s)e[r+s]=t>>>8*(i?s:3-s)&255}function N(e,t,r,i,s,n){if(r+i>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function T(e,t,r,i,n){return n||N(e,0,r,4),s.write(e,t,r,i,23,4),r+4}function B(e,t,r,i,n){return n||N(e,0,r,8),s.write(e,t,r,i,52,8),r+8}c.prototype.slice=function(e,t){var r,i=this.length;if(e=~~e,t=void 0===t?i:~~t,e<0?(e+=i)<0&&(e=0):e>i&&(e=i),t<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=c.prototype;else{var s=t-e;r=new c(s,void 0);for(var n=0;n<s;++n)r[n]=this[n+e]}return r},c.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var i=this[e],s=1,n=0;++n<t&&(s*=256);)i+=this[e+n]*s;return i},c.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var i=this[e+--t],s=1;t>0&&(s*=256);)i+=this[e+--t]*s;return i},c.prototype.readUInt8=function(e,t){return t||$(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||$(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||$(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||$(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||$(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var i=this[e],s=1,n=0;++n<t&&(s*=256);)i+=this[e+n]*s;return i>=(s*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||$(e,t,this.length);for(var i=t,s=1,n=this[e+--i];i>0&&(s*=256);)n+=this[e+--i]*s;return n>=(s*=128)&&(n-=Math.pow(2,8*t)),n},c.prototype.readInt8=function(e,t){return t||$(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||$(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){t||$(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return t||$(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||$(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||$(e,4,this.length),s.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||$(e,4,this.length),s.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||$(e,8,this.length),s.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||$(e,8,this.length),s.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,r,i){(e=+e,t|=0,r|=0,i)||R(this,e,t,r,Math.pow(2,8*r)-1,0);var s=1,n=0;for(this[t]=255&e;++n<r&&(s*=256);)this[t+n]=e/s&255;return t+r},c.prototype.writeUIntBE=function(e,t,r,i){(e=+e,t|=0,r|=0,i)||R(this,e,t,r,Math.pow(2,8*r)-1,0);var s=r-1,n=1;for(this[t+s]=255&e;--s>=0&&(n*=256);)this[t+s]=e/n&255;return t+r},c.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):I(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t|=0,!i){var s=Math.pow(2,8*r-1);R(this,e,t,r,s-1,-s)}var n=0,a=1,o=0;for(this[t]=255&e;++n<r&&(a*=256);)e<0&&0===o&&0!==this[t+n-1]&&(o=1),this[t+n]=(e/a>>0)-o&255;return t+r},c.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t|=0,!i){var s=Math.pow(2,8*r-1);R(this,e,t,r,s-1,-s)}var n=r-1,a=1,o=0;for(this[t+n]=255&e;--n>=0&&(a*=256);)e<0&&0===o&&0!==this[t+n+1]&&(o=1),this[t+n]=(e/a>>0)-o&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):I(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,r){return T(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return T(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return B(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return B(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,i){if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var s,n=i-r;if(this===e&&r<t&&t<i)for(s=n-1;s>=0;--s)e[s+t]=this[s+r];else if(n<1e3||!c.TYPED_ARRAY_SUPPORT)for(s=0;s<n;++s)e[s+t]=this[s+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+n),t);return n},c.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===e.length){var s=e.charCodeAt(0);s<256&&(e=s)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var n;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(n=t;n<r;++n)this[n]=e;else{var a=c.isBuffer(e)?e:z(new c(e,i).toString()),o=a.length;for(n=0;n<r-t;++n)this[n+t]=a[n%o]}return this};var M=/[^+\/0-9A-Za-z-_]/g;function L(e){return e<16?"0"+e.toString(16):e.toString(16)}function z(e,t){var r;t=t||1/0;for(var i=e.length,s=null,n=[],a=0;a<i;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!s){if(r>56319){(t-=3)>-1&&n.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&n.push(239,191,189);continue}s=r;continue}if(r<56320){(t-=3)>-1&&n.push(239,191,189),s=r;continue}r=65536+(s-55296<<10|r-56320)}else s&&(t-=3)>-1&&n.push(239,191,189);if(s=null,r<128){if((t-=1)<0)break;n.push(r)}else if(r<2048){if((t-=2)<0)break;n.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;n.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;n.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return n}function D(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(M,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function F(e,t,r,i){for(var s=0;s<i&&!(s+r>=t.length||s>=e.length);++s)t[s+r]=e[s];return s}}).call(this,r(245))},function(e,t){function r(e){var t=new Error('Cannot find module "'+e+'".');throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=5},function(e,t){function r(e){var t=new Error('Cannot find module "'+e+'".');throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=6},function(e,t,r){const i=r(2),s=r(9);e.exports=class{constructor(e){if(this.uuid=e.uuid.toLowerCase(),this.parent=null,this.children=[],this.isRemote=!1,this.discoverdOnRemote=!1,this.data=e.data||null,!this.data&&e.text&&(this.data=i.string2dataArray(e.text)),!this.data&&e.value&&(this.data=[e.value]),e[this.childrenName])for(let t of e[this.childrenName])this.addChild(t);this.setFunctions(),this.emitter=new s}setFunctions(){let e=this.childrenName;if(e){let t=(e=e.charAt(0).toUpperCase()+e.slice(1)).slice(0,-1),r="add"+t;this[r]=this.addChild,this[r="get"+t]=this.getChild}let t=this.parentName;t&&Object.defineProperty(this,t,{get(){return this.parent},set(e){this.parent=e}})}get childrenClass(){return Object}get childrenName(){return null}get parentName(){return null}addChild(e){return e instanceof this.childrenClass||(e=new this.childrenClass(e)),e.parent=this,this.children.push(e),e}getChild(e){return this.children.filter(function(t){return t.uuid.toLowerCase()===e.toLowerCase()}).shift()}toJSON(){let e={uuid:this.uuid.toLowerCase()};return this.children.length>0&&(e[this.childrenName]=this.children),this.data&&(e.data=this.data),e}read(){}write(){}writeNumber(e){this.write([e])}writeText(e){this.write(i.string2dataArray(e))}readWait(){return new Promise(e=>{this.emitter.once("onread",t=>{"success"===t.result?e(t.data):e(void 0)}),this.read()})}writeWait(e){return new Promise(t=>{this.emitter.once("onwrite",e=>{t("success"===e.result)}),this.write(e)})}writeTextWait(e){return new Promise(t=>{this.emitter.once("onwrite",e=>{t("success"===e.result)}),this.writeText(e)})}writeNumberWait(e){return new Promise(t=>{this.emitter.once("onwrite",e=>{t("success"===e.result)}),this.writeNumber(e)})}readFromRemoteWait(){return new Promise(e=>{this.emitter.once("onreadfromremote",()=>{e()})})}writeFromRemoteWait(){return new Promise(e=>{this.emitter.once("onreadfromremote",t=>{e(t.data)})})}onwrite(){}onread(){}onwritefromremote(){}onreadfromremote(){}onerror(e){console.error(e.message)}notifyFromServer(e,t){switch(this.emitter.emit(e,t),e){case"onerror":this.onerror(t);break;case"onwrite":this.onwrite(t.result);break;case"onread":this.onread(t.data);break;case"onwritefromremote":this.onwritefromremote(t.address,t.data);break;case"onreadfromremote":this.onreadfromremote(t.address)}}}},function(e,t,r){const i=r(7);e.exports=class extends i{constructor(e){super(e),this.isRemote=!1,this.discoverdOnRemote=!1}get wsChildUuidName(){let e=this.childrenName;return e?e.slice(0,-1)+"_uuid":null}getChild(e){let t=super.getChild(e);return t||(t=this.addChild({uuid:e})),t}discoverChildren(){}discoverChildrenWait(){return new Promise(e=>{this.emitter.once("discoverfinished",()=>{let t=this.children.filter(e=>e.discoverdOnRemote);e(t)}),this.discoverChildren()})}ondiscover(){}ondiscoverfinished(){}notifyFromServer(e,t){switch(super.notifyFromServer(e,t),e){case"discover":{let e=this.getChild(t[this.wsChildUuidName]);e.discoverdOnRemote=!0,e.properties=t.properties||[],this.ondiscover(e);break}case"discoverfinished":{let e=this.children.filter(e=>e.discoverdOnRemote);this.ondiscoverfinished(e);break}}}}},function(e,t,r){"use strict";var i=Object.prototype.hasOwnProperty,s="~";function n(){}function a(e,t,r,i,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new function(e,t,r){this.fn=e,this.context=t,this.once=r||!1}(r,i||e,n),o=s?s+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],a]:e._events[o].push(a):(e._events[o]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function c(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(s=!1)),c.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)i.call(e,t)&&r.push(s?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},c.prototype.listeners=function(e){var t=s?s+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,n=r.length,a=new Array(n);i<n;i++)a[i]=r[i].fn;return a},c.prototype.listenerCount=function(e){var t=s?s+e:e,r=this._events[t];return r?r.fn?1:r.length:0},c.prototype.emit=function(e,t,r,i,n,a){var o=s?s+e:e;if(!this._events[o])return!1;var c,d,h=this._events[o],u=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),u){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,r),!0;case 4:return h.fn.call(h.context,t,r,i),!0;case 5:return h.fn.call(h.context,t,r,i,n),!0;case 6:return h.fn.call(h.context,t,r,i,n,a),!0}for(d=1,c=new Array(u-1);d<u;d++)c[d-1]=arguments[d];h.fn.apply(h.context,c)}else{var l,p=h.length;for(d=0;d<p;d++)switch(h[d].once&&this.removeListener(e,h[d].fn,void 0,!0),u){case 1:h[d].fn.call(h[d].context);break;case 2:h[d].fn.call(h[d].context,t);break;case 3:h[d].fn.call(h[d].context,t,r);break;case 4:h[d].fn.call(h[d].context,t,r,i);break;default:if(!c)for(l=1,c=new Array(u-1);l<u;l++)c[l-1]=arguments[l];h[d].fn.apply(h[d].context,c)}}return!0},c.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},c.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},c.prototype.removeListener=function(e,t,r,i){var n=s?s+e:e;if(!this._events[n])return this;if(!t)return o(this,n),this;var a=this._events[n];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||o(this,n);else{for(var c=0,d=[],h=a.length;c<h;c++)(a[c].fn!==t||i&&!a[c].once||r&&a[c].context!==r)&&d.push(a[c]);d.length?this._events[n]=1===d.length?d[0]:d:o(this,n)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=s?s+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=s,c.EventEmitter=c,e.exports=c},function(e,t){let r;r="undefined"!=typeof WebSocket?WebSocket:"undefined"!=typeof MozWebSocket?MozWebSocket:window.WebSocket||window.MozWebSocket,e.exports=r},function(e,t,r){const i=r(1);e.exports=class extends i{constructor(e){super(e),this.module=3,this.ModuleNum=6,this.resetInternalStatus(),this._CommandInit=0,this._CommandDeinit=1,this._CommandSetFreq=2,this._CommandSetDuty=3,this._CommandAMModulate=4}resetInternalStatus(){this.pwms=[];for(var e=0;e<this.ModuleNum;e++)this.pwms.push({})}init(e,t){var r=new Uint8Array(2);r[0]=t,r[1]=e.io,this.pwms[t].io=e.io,this.sendCommand(this._CommandInit,r)}deinit(e,t){var r=new Uint8Array(1);r[0]=t,this.pwms[t]={},this.sendCommand(this._CommandDeinit,r)}freq(e,t){var r=new Uint8Array(5);r[0]=t,r[1]=e.freq>>24,r[2]=e.freq>>16,r[3]=e.freq>>8,r[4]=e.freq,this.pwms[t].freq=e.freq,this.sendCommand(this._CommandSetFreq,r)}pulse(e,t){let r=new Uint8Array(5),i=1e3*e.pulse;r[0]=t,r[1]=i>>24,r[2]=i>>16,r[3]=i>>8,r[4]=i,this.pwms[t].pulseUSec=i,this.sendCommand(this._CommandSetDuty,r)}amModulate(e,t){const r=e.modulate.data.length,i=parseInt((r+7)/8);let s=new Uint8Array(5+i),n=1e3*e.modulate.symbol_length;s[0]=t,s[1]=n>>24,s[2]=n>>16,s[3]=n>>8,s[4]=n;let a=0;for(let t=0;t<i;t++){s[5+t]=0;for(let r=0;r<8;r++)e.modulate.data[a++]&&(s[5+t]|=128>>>r)}this.sendCommand(this._CommandAMModulate,s)}parseFromJson(e){for(var t=0;t<this.ModuleNum;t++){var r=e["pwm"+t];if(void 0===r)continue;let i=[{uri:"/request/pwm/init",onValid:this.init},{uri:"/request/pwm/freq",onValid:this.freq},{uri:"/request/pwm/pulse",onValid:this.pulse},{uri:"/request/pwm/modulate",onValid:this.amModulate},{uri:"/request/pwm/deinit",onValid:this.deinit}],s=this.validateCommandSchema(i,r,"pwm"+t,t);if(0===s.valid)throw s.invalidButLike.length>0?new Error(s.invalidButLike[0].message):new this.WSCommandNotFoundError(`[pwm${t}]unknown command`)}}}},function(e,t,r){const i=r(1),s=1,n=2,a=3,o=4,c=240,d={0:"unknown error",1:"heavy output. output voltage is too low when driving high",2:"heavy output. output voltage is too high when driving low",3:"output voltage is too low when driving high. io state has changed output to input",4:"output voltage is too high when driving low. io state has changed output to input"},h={1:"io.input",2:"io.output",3:"pwm",4:"uart",5:"i2c",6:"spi",7:"LogicAnalyzer",8:"Measure"};e.exports=class extends i{constructor(e){super(e),this.module=2,this._CommandOutput=0,this._CommandInputStream=1,this._CommandInputOnece=2,this._CommandOutputType=3,this._CommandPullResisterType=4,this._CommandEnd=5}output(e,t){var r=new Uint8Array([t,e]);this.sendCommand(this._CommandOutput,r)}outputDetail(e,t){var r=new Uint8Array([t,e.value]);this.sendCommand(this._CommandOutput,r)}input(e,t){var r=new Uint8Array([t]);this.sendCommand(this._CommandInputOnece,r)}inputDetail(e,t){var r=new Uint8Array([t]);this.sendCommand(e.stream?this._CommandInputStream:this._CommandInputOnece,r)}outputType(e,t){var r=new Uint8Array(2);if(r[0]=t,"push-pull5v"===e.output_type)r[1]=0;else if("push-pull3v"===e.output_type)r[1]=2;else{if("open-drain"!==e.output_type)return"io unknown outputtype: "+e.output_type;r[1]=3}this.sendCommand(this._CommandOutputType,r)}pullType(e,t){var r=new Uint8Array(2);if(r[0]=t,"float"===e.pull_type)r[1]=0;else if("pull-up3v"===e.pull_type)r[1]=1;else if("pull-down"===e.pull_type)r[1]=2;else{if("pull-up5v"!==e.pull_type)return"io unknown pull_type: "+e.pull_type;r[1]=3}this.sendCommand(this._CommandPullResisterType,r)}deinit(e,t){var r=new Uint8Array([t]);this.sendCommand(this._CommandEnd,r)}parseFromJson(e){for(var t=0;t<=11;t++){var r=e["io"+t];if(void 0===r)continue;let i=[{uri:"/request/io/input",onValid:this.input},{uri:"/request/io/input_detail",onValid:this.inputDetail},{uri:"/request/io/output",onValid:this.output},{uri:"/request/io/output_detail",onValid:this.outputDetail},{uri:"/request/io/output_type",onValid:this.outputType},{uri:"/request/io/pull_type",onValid:this.pullType},{uri:"/request/io/deinit",onValid:this.deinit}],s=this.validateCommandSchema(i,r,"io"+t,t);if(0===s.valid)throw s.invalidButLike.length>0?new Error(s.invalidButLike[0].message):new this.WSCommandNotFoundError(`[io${t}]unknown command`)}}notifyFromBinary(e,t,r){if(t===this._CommandInputStream||t===this._CommandInputOnece)for(var i=0;i<r.byteLength;i+=2)e["io"+r[i]]=r[i+1]>0;else if(t===this.COMMAND_FUNC_ID_ERROR&&r.byteLength>=4){r[0];const t=r[1],i=(r[2],r[3]);if(t===s||t===n)this.envelopWarning(e,`io${i}`,{message:d[t]});else if(t===a||t===o)this.envelopError(e,`io${i}`,{message:d[t]});else if(t===c&&r.byteLength>=6){const t=r[4],s=r[5];this.envelopWarning(e,"debug",{message:`io${i} binded "${h[t]}" was stopped. "${h[s]}" have started using this io.`})}}else super.notifyFromBinary(e,t,r)}}},function(e,t){e.exports={}},function(e,t,r){const i=r(7);e.exports=class extends i{constructor(e){super(e),this.permissions=e.permissions||[],Array.isArray(this.permissions)||(this.permissions=[this.permissions])}get parentName(){return"characteristic"}addPermission(e){this.permissions.includes(e)||this.permissions.push(e)}removePermission(e){this.permissions=this.permissions.filter(t=>t!==e)}toJSON(){let e=super.toJSON();return this.permissions.length>0&&(e.permissions=this.permissions),e}write(e){this.characteristic.service.peripheral.Obniz.send({ble:{peripheral:{write_descriptor:{service_uuid:this.characteristic.service.uuid.toLowerCase(),characteristic_uuid:this.characteristic.uuid.toLowerCase(),descriptor_uuid:this.uuid,data:e}}}})}read(){this.characteristic.service.peripheral.Obniz.send({ble:{peripheral:{read_descriptor:{service_uuid:this.characteristic.service.uuid.toLowerCase(),characteristic_uuid:this.characteristic.uuid.toLowerCase(),descriptor_uuid:this.uuid}}}})}}},function(e,t,r){const i=r(14),s=r(7);e.exports=class extends s{constructor(e){super(e),this.addDescriptor=this.addChild,this.getDescriptor=this.getChild,this.properties=e.properties||[],Array.isArray(this.properties)||(this.properties=[this.properties]),this.permissions=e.permissions||[],Array.isArray(this.permissions)||(this.permissions=[this.permissions])}get parentName(){return"service"}get childrenClass(){return i}get childrenName(){return"descriptors"}toJSON(){let e=super.toJSON();return this.properties.length>0&&(e.properties=this.properties),this.permissions.length>0&&(e.permissions=this.permissions),e}addProperty(e){this.properties.includes(e)||this.properties.push(e)}removeProperty(e){this.properties=this.properties.filter(t=>t!==e)}addPermission(e){this.permissions.includes(e)||this.permissions.push(e)}removePermission(e){this.permissions=this.permissions.filter(t=>t!==e)}write(e){this.service.peripheral.Obniz.send({ble:{peripheral:{write_characteristic:{service_uuid:this.service.uuid.toLowerCase(),characteristic_uuid:this.uuid.toLowerCase(),data:e}}}})}read(){this.service.peripheral.Obniz.send({ble:{peripheral:{read_characteristic:{service_uuid:this.service.uuid.toLowerCase(),characteristic_uuid:this.uuid.toLowerCase()}}}})}notify(){this.service.peripheral.Obniz.send({ble:{peripheral:{notify_characteristic:{service_uuid:this.service.uuid.toLowerCase(),characteristic_uuid:this.uuid.toLowerCase()}}}})}}},function(e,t){e.exports=void 0},function(e,t,r){const i=r(7),s=r(15);e.exports=class extends i{constructor(e){super(e),this.addCharacteristic=this.addChild,this.getCharacteristic=this.getChild}get parentName(){return"peripheral"}get childrenName(){return"characteristics"}get childrenClass(){return s}get advData(){return{flags:["general_discoverable_mode","br_edr_not_supported"],serviceUuids:[this.uuid]}}end(){this.peripheral.Obniz.send({ble:{peripheral:{stop_service:{service_uuid:this.uuid.toLowerCase()}}}}),this.peripheral.removeService(this.uuid)}notify(e,t){}}},function(e,t,r){var i=function(){this.keys=["vcc","gnd","frequency","din","dout","clk","spi"],this.requiredKeys=[]};i.prototype.wired=async function(e){this.obniz=e,e.setVccGnd(this.params.vcc,this.params.gnd,"5v"),this.params.mode=this.params.mode||"master",this.params.frequency=this.params.frequency||5e5,this.params.mosi=this.params.din,this.params.miso=this.params.dout,this.spi=this.obniz.getSpiWithConfig(this.params)},i.prototype.getTempWait=async function(){await this.spi.writeWait([84]),await this.obniz.wait(200);var e=await this.spi.writeWait([0,0]),t=e[0]<<8;return t|=e[1],4096&(t>>=3)&&(t-=8192),t/16},r(0).PartsRegistrate("ADT7310",i)},function(e,t,r){var i=function(){this.requiredKeys=["adr","addressmode"],this.keys=["vcc","sda","scl","gnd","adr","addressmode","i2c"],this.ioKeys=["vcc","sda","scl","gnd","adr"],this.commands={},this.commands.softReset=[48,162],this.commands.highRepeatStreach=[44,6],this.commands.middleRepeatStreach=[44,13],this.commands.lowRepeatStreach=[44,16],this.commands.highRepeat=[36,0],this.commands.mediumRepeat=[36,11],this.commands.lowRepeat=[36,22],this.waitTime={},this.waitTime.wakeup=1,this.waitTime.softReset=1,this.waitTime.lowRepeat=4,this.waitTime.mediumRepeat=6,this.waitTime.highRepeat=15,this.commands.readStatus=[243,45]};i.prototype.wired=function(e){this.obniz=e,this.obniz.setVccGnd(this.params.vcc,this.params.gnd,"5v"),this.io_adr=e.getIO(this.params.adr),4===this.params.addressmode?(this.io_adr.output(!1),this.address=68):5===this.params.addressmode&&(this.io_adr.pull(null),this.address=69),this.params.clock=this.params.clock||4e5,this.params.mode=this.params.mode||"master",this.params.pullType=this.params.pullType||"float",this.i2c=e.getI2CWithConfig(this.params),e.i2c0.write(this.address,this.commands.softReset)},i.prototype.getData=async function(){return this.i2c.write(this.address,this.commands.highRepeat),await obniz.wait(this.waitTime.highRepeat),await this.i2c.readWait(this.address,6)},i.prototype.getTempWait=async function(){return(await this.getAllWait()).temperature},i.prototype.getHumdWait=async function(){return(await this.getAllWait()).humidity},i.prototype.getAllWait=async function(){let e=await this.getData();return{temperature:(256*e[0]+e[1])/65535*175-45,humidity:(256*e[3]+e[4])/65535*100}},r(0).PartsRegistrate("SHT31",i)},function(e,t,r){var i=function(){this.requiredKeys=["vcc","gnd","adr0","adr1","adr_select"],this.keys=["sda","scl","adr0","adr1","adr_select","i2c"]};i.prototype.wired=function(e){switch(this.io_adr0=e.getIO(this.params.adr0),this.io_adr1=e.getIO(this.params.adr1),this.obniz.setVccGnd(this.params.vcc,this.params.gnd,"5v"),this.params.adr_select){case 8:this.io_adr0.output(!1),this.io_adr1.output(!1),this.address=72;break;case 9:this.io_adr0.pull(null),this.io_adr1.output(!1),this.address=73;break;case"A":this.io_adr0.output(!0),this.io_adr1.output(!1),this.address=74;break;case"B":this.io_adr0.output(!1),this.io_adr1.output(!0),this.address=75;break;case"C":this.io_adr0.pull(null),this.io_adr1.output(!0),this.address=76;break;case"D":this.io_adr0.output(!0),this.io_adr1.output(!0),this.address=77;break;case"E":this.io_adr0.output(!1),this.io_adr1.pull(null),this.address=78;break;case"F":this.io_adr0.output(!0),this.io_adr1.pull(null),this.address=79;break;default:this.io_adr0.output(!1),this.io_adr1.output(!1),this.address=72}console.log("i2c address="+this.address),this.params.clock=this.params.clock||4e5,this.params.mode=this.params.mode||"master",this.params.pull=this.params.pull||"5v",this.i2c=e.getI2CWithConfig(this.params)},i.prototype.getTempWait=async function(){var e=await this.i2c0.readWait(address,2),t=e[0].toString(2)+("00000000"+e[1].toString(2)).slice(-8);return parseInt(t,2)/65535*175-45},i.prototype.getHumdWait=async function(){this.i2c.write(address,[32,36]),this.i2c.write(address,[224,0]);var e=await this.i2c.readWait(address,4),t=e[2].toString(2)+("00000000"+e[3].toString(2)).slice(-8);return parseInt(t,2)/65535*100},r(0).PartsRegistrate("S5851A",i)},function(e,t,r){var i=function(){this.keys=["vcc","gnd","sda","scl","addressMode"],this.requiredKey=["addressMode"]};i.prototype.wired=function(e){this.obniz=e,e.setVccGnd(this.params.vcc,this.params.gnd,"5v"),8===this.params.addressMode?this.address=72:9===this.params.addressMode&&(this.address=73),this.params.clock=4e5,this.params.pull="5v",this.params.mode="master",this.i2c=e.getI2CWithConfig(this.params)},i.prototype.getTempWait=async function(){var e=await this.i2c.readWait(this.address,2),t=e[0]<<8;return t|=e[1],4096&(t>>=3)&&(t-=8192),t/16},r(0).PartsRegistrate("ADT7410",i)},function(e,t,r){const i=r(3);r(0).PartsRegistrate("S8120C",class extends i{calc(e){return(e-1.474)/-.0082+30}})},function(e,t,r){const i=r(3);r(0).PartsRegistrate("S8100B",class extends i{calc(e){return 30+(1.508-e)/-.08}})},function(e,t,r){const i=r(3);r(0).PartsRegistrate("MCP9701",class extends i{calc(e){return(e-.4)/.0195}})},function(e,t,r){const i=r(3);r(0).PartsRegistrate("MCP9700",class extends i{calc(e){return(e-.5)/.01}})},function(e,t,r){const i=r(3);r(0).PartsRegistrate("LM61",class extends i{calc(e){return Math.round((e-.6)/.01)}})},function(e,t,r){var i=function(){this.keys=["vcc","gnd","output"],this.requiredKeys=["output"]};i.prototype.wired=function(e){this.obniz=e,this.ad=e.getAD(this.params.output),this.obniz.setVccGnd(this.params.vcc,this.params.gnd,"5v");var t=this;this.ad.start(function(e){t.temp=Math.round((e-.424)/.00625*10)/10,t.onchange&&t.onchange(t.temp)})},r(0).PartsRegistrate("LM60",i)},function(e,t,r){const i=r(3);r(0).PartsRegistrate("LM35DZ",class extends i{calc(e){return 100*e}})},function(e,t,r){r(0).PartsRegistrate("Speaker",class{constructor(e){this.keys=["signal","gnd"],this.requiredKeys=["gnd"]}wired(e){this.obniz=e,this.obniz.setVccGnd(null,this.params.gnd,"5v"),this.pwm=e.getFreePwm(),this.pwm.start({io:this.params.signal})}play(e){e>0?(this.pwm.freq(e),this.pwm.pulse(1/e/2*1e3)):this.pwm.pulse(0)}stop(){this.play(0)}})},function(e,t,r){var i=function(){this.keys=["vcc","output","gnd"],this.requiredKeys=["output"]};i.prototype.wired=function(e){this.obniz.setVccGnd(this.params.vcc,this.params.gnd,"5v"),this.ad=e.getAD(this.params.output);var t=this;this.ad.start(function(e){t.temp=e,t.onchange&&t.onchange(t.temp)})},i.prototype.getHumidityWait=async function(){return await this.ad.getWait},r(0).PartsRegistrate("SEN0114",i)},function(e,t,r){var i=function(){this.keys=["pin0","pin1"],this.requiredKeys=["pin0","pin1"]};i.prototype.wired=function(e){this.obniz=e,this.io_pwr=e.getIO(this.params.pin0),this.ad=e.getAD(this.params.pin1),this.io_pwr.drive("5v"),this.io_pwr.output(!0);var t=this;this.ad.start(function(e){pressure=100*e,pressure>=49&&(pressure=49),t.press=pressure,t.onchange&&t.onchange(t.press)})},r(0).PartsRegistrate("FSR40X",i)},function(e,t,r){var i=function(){this.keys=["gnd","vcc","signal"],this.requiredKeys=["signal"]};i.prototype.wired=function(e){this.obniz=e,this.obniz.setVccGnd(this.params.vcc,this.params.gnd,"5v"),this.pwm=e.getFreePwm(),this.pwm_io_num=this.params.signal,this.pwm.start({io:this.pwm_io_num}),this.pwm.freq(50)},i.prototype.angle=function(e){var t=1.9*e/180+.5;this.pwm.pulse(t)},i.prototype.on=function(){this.io_power&&this.io_power.output(!0)},i.prototype.off=function(){this.io_power&&this.io_power.output(!1)},r(0).PartsRegistrate("ServoMotor",i)},function(e,t,r){var i=function(){this.keys=["forward","back"],this.requiredKeys=["forward","back"]};i.prototype.wired=function(e){this.status={direction:null,power:null},this.pwm1_io_num=this.params.forward,this.pwm2_io_num=this.params.back,this.pwm1=e.getFreePwm(),this.pwm1.start({io:this.pwm1_io_num}),this.pwm1.freq(1e5),this.pwm2=e.getFreePwm(),this.pwm2.start({io:this.pwm2_io_num}),this.pwm2.freq(1e5),this.power(30)},i.prototype.forward=function(){this.move(!0)},i.prototype.reverse=function(){this.move(!1)},i.prototype.stop=function(){null!==this.status.direction&&(this.status.direction=null,this.pwm1.duty(0),this.pwm2.duty(0))},i.prototype.move=function(e){if(e){if(!0===this.status.direction)return;this.status.direction=!0}else{if(!1===this.status.direction)return;this.status.direction=!1}var t=this.power();this.power(0),this.power(t)},i.prototype.power=function(e){return void 0===e?this.status.power:(this.status.power=e,null===this.status.direction?(this.pwm1.duty(0),void this.pwm2.duty(0)):void(this.status.direction?(this.pwm1.duty(e),this.pwm2.duty(0)):(this.pwm1.duty(0),this.pwm2.duty(e))))},r(0).PartsRegistrate("DCMotor",i)},function(e,t,r){var i=function(){this.keys=["pin0","pin1","pin2"],this.reuiredKeys=["pin0","pin1","pin2"],this.vcc_voltage=5};i.prototype.wired=function(e){this.obniz.setVccGnd(this.params.pin0,this.params.pin2,"5v"),this.ad=e.getAD(this.params.pin1);var t=this;e.getAD(this.params.pin0).start(function(e){t.vcc_voltage=e}),this.ad.start(function(e){t.position=e/t.vcc_voltage,t.onchange&&t.onchange(t.position)})},r(0).PartsRegistrate("Potentiometer",i)},function(e,t,r){var i=function(){this.keys=["x","y","z","vcc","gnd"],this.requiredKeys=["x","y","z"]};i.prototype.wired=async function(e){this.obniz=e,e.setVccGnd(this.params.vcc,this.params.gnd,"3v"),this.ad_x=e.getAD(this.params.x),this.ad_y=e.getAD(this.params.y),this.ad_z=e.getAD(this.params.z),await e.wait(500);var t=e.getAD(this.params.vcc),r=await t.getWait()/5,i=await this.ad_z.getWait()-r,s=this;this.ad_x.start(function(e){s.gravity=(e-i)/r,s.onchangex&&s.onchangex(s.gravity)}),this.ad_y.start(function(e){s.gravity=(e-i)/r,s.onchangey&&s.onchangey(s.gravity)}),this.ad_z.start(function(e){s.gravity=(e-i)/r,s.onchangez&&s.onchangez(s.gravity)})},r(0).PartsRegistrate("KXSC7_2050",i)},function(e,t,r){var i=function(){this.keys=["sw","y","x","vcc","gnd","i2c"],this.requiredKeys=["sw","y","x"],this.pins=this.keys||["sw","y","x","vcc","gnd"],this.pinname={sw:"sw12"},this.shortName="joyS"};i.prototype.wired=function(e){this.obniz=e,e.setVccGnd(this.params.vcc,this.params.gnd,"5v"),this.io_sig_sw=e.getIO(this.params.sw),this.ad_x=e.getAD(this.params.x),this.ad_y=e.getAD(this.params.y),this.io_sig_sw.pull("5v");var t=this;this.ad_x.start(function(e){t.positionX=e/5,t.onchangex&&t.onchangex(2*t.positionX-1)}),this.ad_y.start(function(e){t.positionY=e/5,t.onchangey&&t.onchangey(2*t.positionY-1)}),this.io_sig_sw.input(function(e){t.isPressed=!1===e,t.onchangesw&&t.onchangesw(!1===e)})},i.prototype.isPressedWait=async function(){return!1===await this.io_sig_sw.inputWait()},r(0).PartsRegistrate("JoyStick",i)},function(e,t,r){var i=function(){this.keys=["signal","gnd"],this.required=["signal"]};i.prototype.wired=function(e){this.io_signal=e.getIO(this.params.signal),e.isValidIO(this.params.gnd)&&(this.io_supply=e.getIO(this.params.gnd),this.io_supply.output(!1)),this.io_signal.pull("5v");var t=this;this.io_signal.input(function(e){t.isPressed=!1===e,t.onchange&&t.onchange(!1===e)})},i.prototype.isPressedWait=async function(){return!1===await this.io_signal.inputWait()},r(0).PartsRegistrate("Button",i)},function(e,t,r){var i=function(){this.requiredKeys=["address"],this.keys=["sda","scl","clock","pullType","i2c","address"]};i.prototype.wired=function(e){this.params.mode=this.params.mode||"master",this.params.clock=this.params.clock||4e5,this.i2c=e.getI2CWithConfig(this.params)},i.prototype.set=function(e,t){var r=[];r.push(e>>8&255),r.push(255&e),r.push.apply(r,t),this.i2c.write(80,r),this.obniz.wait(5)},i.prototype.getWait=async function(e,t){var r=[];return r.push(e>>8&255),r.push(255&e),this.i2c.write(80,r),await this.i2c.readWait(80,t)},r(0).PartsRegistrate("_24LC256",i)},function(e,t,r){class i{constructor(){this.key=["din","vcc","gnd"],this.requiredKey=["din"]}wired(e){this.obniz=e,this.params.mode="master",this.params.frequency=2e6,this.params.mosi=this.params.din,this.params.drive="3v",this.spi=this.obniz.getSpiWithConfig(this.params)}static _generateFromByte(e){e=parseInt(e);let t=[];for(var r=0;r<8;r+=2){let i=0;i=e&128>>r?224:128,i|=e&128>>r+1?14:8,t.push(i)}return t}static _generateColor(e,t,r){let s=i._generateFromByte(e);return s=(s=s.concat(i._generateFromByte(t))).concat(i._generateFromByte(r))}static _generateHsvColor(e,t,r){var s,n,a,o=r*t,c=e/60,d=o*(1-Math.abs(c%2-1));0<=c&&c<1&&([s,n,a]=[o,d,0]),1<=c&&c<2&&([s,n,a]=[d,o,0]),2<=c&&c<3&&([s,n,a]=[0,o,d]),3<=c&&c<4&&([s,n,a]=[0,d,o]),4<=c&&c<5&&([s,n,a]=[d,0,o]),5<=c&&c<6&&([s,n,a]=[o,0,d]);var h=r-o;[s,n,a]=[s+h,n+h,a+h],s=Math.floor(255*s),n=Math.floor(255*n),a=Math.floor(255*a);let u=i._generateFromByte(s);return u=(u=u.concat(i._generateFromByte(n))).concat(i._generateFromByte(a))}rgb(e,t,r){this.spi.write(i._generateColor(e,t,r))}hsv(e,t,r){this.spi.write(i._generateHsvColor(e,t,r))}rgbs(e){let t=[];for(var r=0;r<e.length;r++){const s=e[r];t=t.concat(i._generateColor(s[0],s[1],s[2]))}this.spi.write(t)}hsvs(e){let t=[];for(var r=0;r<e.length;r++){const s=e[r];t=t.concat(i._generateHsvColor(s[0],s[1],s[2]))}this.spi.write(t)}}r(0).PartsRegistrate("WS2811",i)},function(e,t,r){var i=function(){this.keys=["anode","cathode"],this.requiredKeys=["anode"],this.animationName="Led-"+Math.round(1e3*Math.random())};i.prototype.wired=function(e){this.obniz=e,this.io_anode=e.getIO(this.params.anode),this.params.cathode&&(this.io_cathode=e.getIO(this.params.cathode),this.io_cathode.output(!1))},i.prototype.on=function(){this.endBlink(),this.io_anode.output(!0)},i.prototype.off=function(){this.endBlink(),this.io_anode.output(!1)},i.prototype.endBlink=function(){this.obniz.io.animation(this.animationName,"pause")},i.prototype.blink=function(e){e||(e=100);var t=[{duration:e,state:function(e){this.io_anode.output(!0)}.bind(this)},{duration:e,state:function(e){this.io_anode.output(!1)}.bind(this)}];this.obniz.io.animation(this.animationName,"loop",t)},r(0).PartsRegistrate("LED",i)},function(e,t,r){r(0).PartsRegistrate("InfraredLED",class{constructor(){this.keys=["anode","cathode"],this.requiredKeys=["anode"],this.dataSymbolLength=.07}wired(e){if(this.obniz=e,!this.obniz.isValidIO(this.params.anode))throw new Error("anode is not valid io");if(this.params.cathode){if(!this.obniz.isValidIO(this.params.cathode))throw new Error("cathode is not valid io");this.io_cathode=e.getIO(this.params.cathode),this.io_cathode.output(!1)}this.pwm=this.obniz.getFreePwm(),this.pwm.start({io:this.params.anode}),this.pwm.freq(38e3)}send(e){this.pwm.modulate("am",this.dataSymbolLength,e)}})},function(e,t,r){r(0).PartsRegistrate("FullColorLed",class{constructor(){this.COMMON_TYPE_ANODE=1,this.COMMON_TYPE_CATHODE=0,this.anode_keys=["anode","anode_common","anodeCommon","vcc"],this.cathode_keys=["cathode","cathode_common","cathodeCommon","gnd"],this.animationName="FullColorLed-"+Math.round(1e3*Math.random()),this.keys=["r","g","b","common","commonType"],this.requiredKeys=["r","g","b","common","commonType"]}wired(e){var t=this.params.r,r=this.params.g,i=this.params.b,s=this.params.common,n=this.params.commonType;this.obniz=e,this.anode_keys.includes(n)?this.commontype=this.COMMON_TYPE_ANODE:this.cathode_keys.includes(n)?this.commontype=this.COMMON_TYPE_CATHODE:this.obniz.error("FullColorLed param need common type [  anode_common or cathode_common ] "),this.common=this.obniz.getIO(s),this.common.drive("3v"),this.common.output(this.commontype),this.obniz.getIO(t).drive("3v"),this.obniz.getIO(t).output(this.commontype),this.obniz.getIO(r).drive("3v"),this.obniz.getIO(r).output(this.commontype),this.obniz.getIO(i).drive("3v"),this.obniz.getIO(i).output(this.commontype),this.pwmR=this.obniz.getFreePwm(),this.pwmR.start({io:t}),this.pwmR.freq(1e3),this.pwmG=this.obniz.getFreePwm(),this.pwmG.start({io:r}),this.pwmG.freq(1e3),this.pwmB=this.obniz.getFreePwm(),this.pwmB.start({io:i}),this.pwmB.freq(1e3),this.rgb(0,0,0)}rgb(e,t,r){e=Math.min(Math.max(parseInt(e),0),255),t=Math.min(Math.max(parseInt(t),0),255),r=Math.min(Math.max(parseInt(r),0),255),this.commontype===this.COMMON_TYPE_ANODE&&(e=255-e,t=255-t,r=255-r),this.pwmR.duty(e/255*100),this.pwmG.duty(t/255*100),this.pwmB.duty(r/255*100)}hsv(e,t,r){var i,s,n,a=r*t,o=e/60,c=a*(1-Math.abs(o%2-1));0<=o&&o<1&&([i,s,n]=[a,c,0]),1<=o&&o<2&&([i,s,n]=[c,a,0]),2<=o&&o<3&&([i,s,n]=[0,a,c]),3<=o&&o<4&&([i,s,n]=[0,c,a]),4<=o&&o<5&&([i,s,n]=[c,0,a]),5<=o&&o<6&&([i,s,n]=[a,0,c]);var d=r-a;[i,s,n]=[i+d,s+d,n+d],i=Math.floor(255*i),s=Math.floor(255*s),n=Math.floor(255*n),this.rgb(i,s,n)}gradation(e){for(var t=[],r=Math.round(e/18),i=0;i<18;i++){var s={duration:r,state:function(e){this.hsv(10*e*2,1,1)}.bind(this)};t.push(s)}this.obniz.io.animation(this.animationName,"loop",t)}stopgradation(){this.obniz.io.animation(this.animationName,"pause")}})},function(e,t,r){r(0).PartsRegistrate("IRSensor",class{constructor(){this.keys=["output","vcc","gnd"],this.requiredKeys=["output"],this.dataSymbolLength=.07,this.duration=200,this.dataInverted=!0,this.trigerSampleCount=16,this.cutTail=!0,this.output_pullup=!0}wired(e){if(this.obniz=e,e.setVccGnd(this.params.vcc,this.params.gnd,"5v"),!e.isValidIO(this.params.output))throw new Errro("output is not valid io")}start(e){this.ondetect=e,this.output_pullup&&obniz.getIO(this.params.output).pull("5v"),obniz.logicAnalyzer.start({io:this.params.output,interval:this.dataSymbolLength,duration:this.duration,trigerValue:!this.dataInverted,trigerValueSamples:this.trigerSampleCount}),obniz.logicAnalyzer.onmeasured=(e=>{if("function"==typeof this.ondetect){if(this.dataInverted){let t=new Uint8Array(e);for(let e=0;e<t.length;e++)t[e]=t[e]?0:1;e=Array.from(t)}if(this.cutTail)for(let t=e.length-1;t>1&&0===e[t]&&0===e[t-1];t--)e.splice(t,1);this.ondetect(e)}})}})},function(e,t,r){var i=function(){this.keys=["vcc","gnd","signal"],this.requiredKeys=["signal"]};i.prototype.wired=function(e){this.obniz=e,this.io_signal=e.getIO(this.params.signal),this.io_signal.pull("0v"),e.setVccGnd(this.params.vcc,this.params.gnd,"5v");var t=this;this.io_signal.input(function(e){t.isPressed=!1===e,t.onchange&&t.onchange(!1===e)})},i.prototype.isPressedWait=async function(){return 0==await this.io_signal.inputWait()},r(0).PartsRegistrate("PIR_ekmc",i)},function(e,t,r){var i=function(){this.keys=["vcc","out1","out2","gnd"],this.required=["out1","out2"],this.Sens=67e-5};i.prototype.wired=function(e){this.obniz=e,e.setVccGnd(this.params.vcc,this.params.gnd,"5v"),this.ad0=e.getAD(this.params.out1),this.ad1=e.getAD(this.params.out2),this.io_pwr.output(!0);var t=this;this.ad0.start(function(e){t.sens1=(e-1.45)/this.Sens,t.onchange1&&t.onchange1(t.sens1)}),this.ad1.start(function(e){t.sens2=(e-1.35)/this.Sens,t.onchange2&&t.onchange2(t.sens2)})},i.prototype.onChangeSens1=function(e){this.onchange1=e},i.prototype.onChangeSens2=function(e){this.onchange2=e},i.prototype.getValueSens1=async function(){return(this.ad0.value-1.47)/Sens},i.prototype.getValueSens2=async function(){return(this.ad1.value-1.35)/Sens},r(0).PartsRegistrate("ENC03R_Module",i)},function(e,t,r){var i=function(){this.keys=["vcc","triger","echo","gnd"],this.requiredKeys=["vcc","triger","echo"],this._unit="mm"};i.prototype.wired=function(e){this.obniz=e,e.setVccGnd(null,this.params.gnd,"5v"),this.vccIO=e.getIO(this.params.vcc),this.triger=this.params.triger,this.echo=this.params.echo},i.prototype.measure=async function(e){this.vccIO.drive("5v"),this.vccIO.output(!0),await this.obniz.wait(10);var t=this;this.obniz.measure.echo({io_pulse:this.triger,io_echo:this.echo,pulse:"positive",pulse_width:.011,measure_edges:3,timeout:10/340*1e3,callback:function(r){t.vccIO.output(!1);for(var i=null,s=0;s<r.length-1;s++)!0===r[s].edge&&(i=1e3*(r[s+1].timing-r[s].timing),"mm"===t._unit?i/=5.8:"inch"===t._unit&&(i/=148));"function"==typeof e&&e(i)}})},i.prototype.unit=function(e){if("mm"===e)this._unit="mm";else{if("inch"!==e)throw new Error("HCSR04: unknown unit "+e);this._unit="inch"}},r(0).PartsRegistrate("HC-SR04",i)},function(e,t,r){r(0).PartsRegistrate("MatrixLED_MAX7219",class{constructor(){this.keys=["vcc","gnd","din","cs","clk"],this.requiredKeys=["din","cs","clk"]}wired(e){this.cs=e.getIO(this.params.cs),e.isValidIO(this.params.vcc)&&e.getIO(this.params.vcc).output(!0),e.isValidIO(this.params.gnd)&&e.getIO(this.params.gnd).output(!1),this.params.frequency=this.params.frequency||1e7,this.params.mode="master",this.params.mosi=this.params.din,this.params.drive="3v",this.spi=this.obniz.getSpiWithConfig(this.params),this.cs.output(!0),this.cs.output(!1),this.cs.output(!0)}init(e,t){this.width=e,this.height=t,this.preparevram(e,t),this.initModule()}initModule(){this.write([9,0]),this.write([10,5]),this.write([11,7]),this.write([12,1]),this.write([15,0]),this.passingCommands(),obniz.wait(10)}test(){this.write([15,0]),this.passingCommands()}passingCommands(){for(let e=8;e<this.width;e+=8)this.write([0,0])}brightness(e){this.write([10,e]),this.passingCommands()}preparevram(e,t){this.vram=[];for(let r=0;r<t;r++){let t=new Array(e/8);for(let e=0;e<t.length;e++)t[e]=0;this.vram.push(t)}}write(e){this.cs.output(!1),this.spi.write(e),this.cs.output(!0)}writeVram(){for(let e=0;e<this.height;e++){let t=e+1,r=this.vram[e],i=[];for(let e=0;e<r.length;e++)i.push(t),i.push(r[e]);this.write(i)}}clear(){for(let e=0;e<this.height;e++){let t=this.vram[e];for(let r=0;r<t.length;r++)this.vram[e][r]=0;this.writeVram()}}draw(e){if("undefined"==typeof window)throw new Error("node js mode is under working.");{const t=e.getImageData(0,0,this.width,this.height).data;for(let e=0;e<t.length;e+=4){let r=.34*t[e]+.5*t[e+1]+.16*t[e+2],i=parseInt(e/4),s=parseInt(i/this.width),n=parseInt((i-s*this.width)/8),a=parseInt(i-s*this.width)%8;0===a&&(this.vram[s][n]=0),r>127&&(this.vram[s][n]|=128>>a)}}this.writeVram()}})},function(e,t,r){var i=function(){this.identifier=""+(new Date).getTime(),this.keys=["seg0","seg1","seg2","seg3"],this.requiredKeys=["seg0"]};i.prototype.wired=function(e){this.obniz=e,this.segments=[],this.params.seg0&&this.segments.unshift(this.params.seg0),this.params.seg1&&this.segments.unshift(this.params.seg1),this.params.seg2&&this.segments.unshift(this.params.seg2),this.params.seg3&&this.segments.unshift(this.params.seg3)},i.prototype.print=function(e){if("number"==typeof e){e=parseInt(e);var t=this.segments,r=function(r){let i=e;for(let e=0;e<t.length;e++)console.log(i),r===e?t[e].print(i%10):t[e].off(),i/=10},i=[];for(let e=0;e<t.length;e++)i.push({duration:3,state:r});t=this.segments;this.obniz.io.animation(this.identifier,"loop",i)}},i.prototype.on=function(){this.obniz.io.animation(this.identifier,"resume")},i.prototype.off=function(){this.obniz.io.animation(this.identifier,"pause");for(let e=0;e<this.segments.length;e++)this.segments[e].off()},r(0).PartsRegistrate("7SegmentLEDArray",i)},function(e,t,r){var i=function(){this.requiredKeys=["a","b","c","d","e","f","g","dp","common","commonType"],this.keys=["a","b","c","d","e","f","g","dp","common","commonType"],this.digits=[63,6,91,79,102,109,125,7,127,111,111]};i.prototype.wired=function(e){this.obniz=e,this.ios=[],this.ios.push(e.getIO(this.params.a)),this.ios.push(e.getIO(this.params.b)),this.ios.push(e.getIO(this.params.c)),this.ios.push(e.getIO(this.params.d)),this.ios.push(e.getIO(this.params.e)),this.ios.push(e.getIO(this.params.f)),this.ios.push(e.getIO(this.params.g)),this.dp=e.getIO(this.params.dp),this.common=e.getIO(this.params.common),this.isCathodeCommon="anode"!==this.params.commonType},i.prototype.print=function(e){if("number"==typeof e){e=parseInt(e),e%=10;for(let r=0;r<7;r++)if(this.ios[r]){var t=!!(this.digits[e]&1<<r);this.isCathodeCommon||(t=~t),this.ios[r].output(t)}this.on()}},i.prototype.printRaw=function(e){if("number"==typeof e){for(let r=0;r<7;r++)if(this.ios[r]){var t=!!(e&1<<r);this.isCathodeCommon||(t=!t),this.ios[r].output(t)}this.on()}},i.prototype.dpShow=function(e){this.dp&&this.dp.output(this.isCathodeCommon?e:!e)},i.prototype.on=function(){this.common.output(!this.isCathodeCommon)},i.prototype.off=function(){this.common.output(!!this.isCathodeCommon)},r(0).PartsRegistrate("7SegmentLED",i)},function(e,t,r){r(0).PartsRegistrate("JpegSerialCam",class{constructor(){this.keys=["vcc","cam_tx","cam_rx","gnd"],this.requiredKeys=["cam_tx","cam_rx"],this.ioKeys=this.keys,this.displayName="Jcam",this.displayIoNames={cam_tx:"camTx",cam_rx:"camRx"}}wired(){this.obniz.setVccGnd(this.params.vcc,this.params.gnd,"5v"),this.my_tx=this.params.cam_rx,this.my_rx=this.params.cam_tx,this.obniz.getIO(this.my_tx).drive("3v"),this.uart=this.obniz.getFreeUart()}async _drainUntil(e,t,r){for(r||(r=[]);;){var i=e.readBytes();r=r.concat(i);var s=this._seekTail(t,r);if(s>=0)return r.splice(0,s),r;await this.obniz.wait(10)}}_seekTail(e,t){for(var r=0,i=0;i<t.length;i++)if(t[i]===e[r]){if(++r===e.length)return i+1}else r=0;return-1}arrayToBase64(e){if("function"==typeof btoa){var t=Array.prototype.map.call(e,function(e){return String.fromCharCode(e)}).join("");return btoa(t)}}async startwait(e){e||(e={}),this.uart.start({tx:this.my_tx,rx:this.my_rx,baud:e.baud||38400}),this.obniz.display.setPinName(this.my_tx,"JpegSerialCam","camRx"),this.obniz.display.setPinName(this.my_rx,"JpegSerialCam","camTx"),await this.obniz.wait(2500)}async resetwait(){this.uart.send([86,0,38,0]),await this._drainUntil(this.uart,[118,0,38,0]),await this.obniz.wait(2500)}async setResolusionWait(e){let t;if("640*480"===e)t=0;else if("320*240"===e)t=17;else{if("160*120"!==e)throw new Error("invalid resolution");t=34}this.uart.send([86,0,49,5,4,1,0,25,t]),await this._drainUntil(this.uart,[118,0,49,0]),await this.resetwait()}async setCompressibilityWait(e){let t=Math.floor(e/100*255);this.uart.send([86,0,49,5,1,1,18,4,t]),await this._drainUntil(this.uart,[118,0,49,0]),await this.resetwait()}async setBaudWait(e){let t;switch(e){case 9600:t=[174,200];break;case 19200:t=[86,228];break;case 38400:t=[42,242];break;case 57600:t=[28,76];break;case 115200:t=[13,166];break;default:throw new Error("invalid baud rate")}this.uart.send([86,0,49,6,4,2,0,8,t[0],t[1]]),await this._drainUntil(this.uart,[118,0,49,0]),await this.startwait({baud:e})}async takewait(){const e=this.uart;e.send([86,0,54,1,2]),await this._drainUntil(e,[118,0,54,0,0]),e.send([86,0,54,1,0]),await this._drainUntil(e,[118,0,54,0,0]),e.send([86,0,52,1,0]);for(var t,r,i=await this._drainUntil(e,[118,0,52,0,4,0,0]);;){var s=e.readBytes();if((i=i.concat(s)).length>=2){t=i[0],r=i[1];break}await this.obniz.wait(1e3)}let n=256*t+r;for(e.send([86,0,50,12,0,10,0,0,0,0,0,0,t,r,0,255]),i=await this._drainUntil(e,[118,0,50,0,0]);s=e.readBytes(),!((i=i.concat(s)).length>=n);)await this.obniz.wait(10);return i=(i=i.splice(0,n)).concat([255,217])}})},function(e,t,r){r(0).PartsRegistrate("XBee",class{constructor(){this.keys=["tx","rx","gnd"],this.requiredKeys=["tx","rx"],this.displayIoNames={tx:"<tx",rx:">rx"}}wired(e){this.uart=e.getFreeUart(),this.currentCommand=null,this.commands=[],this.isAtMode=!1,this.onFinishAtModeCallback=null,"number"==typeof this.params.gnd&&e.getIO(this.params.gnd).output(!1),this.uart.start({tx:this.params.tx,rx:this.params.rx,baud:9600,drive:"3v"}),this.uart.onreceive=function(e,t){this.isAtMode?this.onAtResultsRecieve(e,t):"function"==typeof this.onreceive&&this.onreceive(e,t)}.bind(this)}send(e){!1===this.isAtMode?this.uart.send(e):this.obniz.error("XBee is AT Command mode now. Wait for finish config.")}onAtResultsRecieve(e,t){if(this.isAtMode){var r=function(){this.currentCommand=null,this.sendCommand()}.bind(this);if("OK\r"===t){if("ATCN"===this.currentCommand)return this.isAtMode=!1,this.currentCommand=null,void("function"==typeof this.onFinishAtModeCallback&&(this.onFinishAtModeCallback(),this.onFinishAtModeCallback=null));r()}else"ERROR\r"===t?this.obniz.error("XBee config error : "+this.currentCommand):(console.log("XBEE : no catch message",e),r())}}addCommand(e,t){var r=e+(t?" "+t:"");this.commands.push(r),!0===this.isAtMode&&null===this.currentCommand&&this.sendCommand()}sendCommand(){!0===this.isAtMode&&null===this.currentCommand&&this.commands.length>0&&(this.currentCommand="AT"+this.commands.shift(),this.uart.send(this.currentCommand+"\r"))}enterAtMode(){null===this.currentCommand&&(this.isAtMode=!0,this.obniz.wait(1e3),this.currentCommand="+++",this.uart.send(this.currentCommand),this.obniz.wait(1e3))}exitAtMode(){this.addCommand("CN")}async configWait(e){if(this.isAtMode)throw new Error("Xbee : duplicate config setting");return new Promise(function(t,r){var i={destination_address_high:"DH",destination_address_low:"DL",source_address:"MY"},s=["destination_address"];for(var n in this.enterAtMode(),e)if(2===n.length)this.addCommand(n,e[n]);else if(i[n])this.addCommand(i[n],e[n]);else if(s.includes(n)){var a=e[n].slice(0,-8);a||(a="0");var o=e[n].slice(-8);this.addCommand(i[n+"_high"],a),this.addCommand(i[n+"_low"],o)}this.exitAtMode(),this.onFinishAtModeCallback=function(){t()}}.bind(this))}})},function(e,t,r){var i=function(){this.keys=["tx","rx","gnd"],this.requiredKeys=["tx","rx"]};i.prototype.wired=function(e){e.isValidIO(this.params.gnd)&&e.getIO(this.params.gnd).output(!1),this.uart=e.getFreeUart(),this.uart.start({tx:this.params.tx,rx:this.params.rx,baud:115200,drive:"3v"});var t=this;this.uart.onreceive=function(e,r){r.indexOf("CONNECT")>=0?console.log("connected"):r.indexOf("DISCONNECT")>=0&&console.log("disconnected"),"function"==typeof t.onreceive&&t.onreceive(e,r)}},i.prototype.send=function(e){this.uart.send(e)},i.prototype.sendCommand=function(e){this.uart.send(e+"\n"),this.obniz.wait(100)},i.prototype.enterCommandMode=function(){this.send("$$$"),this.obniz.wait(100)},i.prototype.config=function(e){this.enterCommandMode(),"object"==typeof e&&(this.sendCommand(""),e.master_slave&&this.config_masterslave(e.master_slave),e.auth&&this.config_auth(e.auth),e.hid_flag&&this.config_HIDflag(e.hid_flag),e.profile&&this.config_profile(e.profile),e.power&&this.config_power(e.power),e.display_name&&this.config_displayName(e.display_name),this.config_reboot())},i.prototype.config_reboot=function(){this.sendCommand("R,1")},i.prototype.config_masterslave=function(e){var t=-1;if("number"==typeof e)t=e;else if("string"==typeof e)for(var r=["slave","master","trigger","auto-connect-master","auto-connect-dtr","auto-connect-any","pairing"],i=0;i<r.length;i++)if(r[i]===e){t=i;break}-1!==t&&this.sendCommand("SM,"+t)},i.prototype.config_displayName=function(e){this.sendCommand("SN,"+e)},i.prototype.config_HIDflag=function(e){this.sendCommand("SH,"+e)},i.prototype.config_profile=function(e){var t=-1;if("number"==typeof e)t=e;else if("string"==typeof e)for(var r=["SPP","DUN-DCE","DUN-DTE","MDM-SPP","SPP-DUN-DCE","APL","HID"],i=0;i<r.length;i++)if(r[i]===e){t=i;break}-1!==t&&this.sendCommand("S~,"+t)},i.prototype.config_revert_localecho=function(){this.sendCommand("+")},i.prototype.config_auth=function(e){var t=-1;if("number"==typeof e)t=e;else if("string"==typeof e)for(var r=["open","ssp-keyboard","just-work","pincode"],i=0;i<r.length;i++)if(r[i]===e){t=i;break}-1!==t&&this.sendCommand("SA,"+t)},i.prototype.config_power=function(e){var t="0010";16>e&&e>=12?t="000C":12>e&&e>=8?t="0008":8>e&&e>=4?t="0004":4>e&&e>=0?t="0000":0>e&&e>=-4?t="FFFC":-4>e&&e>=-8?t="FFF8":-8>e&&(t="FFF4"),this.sendCommand("SY,"+t)},i.prototype.config_get_setting=function(){this.sendCommand("D")},i.prototype.config_get_extendSetting=function(){this.sendCommand("E")},r(0).PartsRegistrate("RN42",i)},function(e,t,r){var i=function(){this.keys=["vcc","gnd","out"],this.requiredKeys=["out"]};i.prototype.wired=async function(e){this.obniz=e,this.ad=e.getAD(this.params.out),e.setVccGnd(this.params.vcc,this.params.gnd,"5v");var t=this;this.ad.start(function(e){t.voltage=e,t.onchange&&t.onchange(t.voltage)})},r(0).PartsRegistrate("AE_MICAMP",i)},function(e,t,r){var i=function(){this.keys=["vcc","gnd"],this.requiredKeys=["vcc","gnd"]};i.prototype.wired=function(e){this.obniz=e,this.io_vdd=e.getIO(this.params.vcc),this.io_gnd=e.getIO(this.params.gnd),this.io_gnd.output(!1)},i.prototype.on=function(){this.io_vdd.output(!0)},i.prototype.off=function(){this.io_vdd.output(!1)},r(0).PartsRegistrate("USB",i)},function(e,t,r){r(0).PartsRegistrate("hx711",class{constructor(){this.keys=["vcc","gnd","sck","dout"],this.requiredKeys=["sck","dout"],this.offset=0,this.scale=1}wired(e){this.obniz=e,this.spi=e.getFreeSpi(),e.setVccGnd(this.params.vcc,this.params.gnd,"5v");let t=["clk","dout"];for(let e of t)if(this.params[e]&&!this.obniz.isValidIO(this.params[e]))throw new Error("spi start param '"+e+"' are to be valid io no");this.sck=e.getIO(this.params.sck),this.dout=e.getIO(this.params.dout),this.sck.output(!0)}async readWait(){this.sck.output(!1),this.spi.start({mode:"master",clk:this.params.sck,miso:this.params.dout,frequency:66e3});let e=await this.spi.writeWait([0,0,0]);return this.spi.end(!0),this.sck.output(!1),(0==(128&e[0])?1:-1)*(((127&e[0])<<16)+(e[1]<<8)+(e[2]<<0))}async readAverageWait(e){let t=[];for(let r=0;r<e;r++)t.push(await this.readWait());return t.reduce((e,t,r)=>e+t,0)/t.length}powerDown(){this.sck.output(!0)}powerUp(){this.sck.output(!1)}async zeroAdjust(e){e=parseInt(e)||1,this.offset=await this.readAverageWait(e)}async getValueWait(e){return e=parseInt(e)||1,(await this.readAverageWait(e)-this.offset)/this.scale}})},function(e,t,r){var i={"./ADConverter/hx711/index.js":55,"./Accessory/USB/index.js":54,"./AudioSensor/AE-MICAMP/index.js":53,"./Bluetooth/RN42/index.js":52,"./Bluetooth/XBee/index.js":51,"./Camera/JpegSerialCam/index.js":50,"./Display/7SegmentLED/index.js":49,"./Display/7SegmentLEDArray/index.js":48,"./Display/MatrixLED_MAX7219/index.js":47,"./DistanceSensor/HC-SR04/index.js":46,"./GyroSensor/ENC-03R_Module/index.js":45,"./InfraredSensor/EKMC160XXXX/index.js":44,"./InfraredSensor/IRSensor/index.js":43,"./Light/FullColorLED/index.js":42,"./Light/InfraredLED/index.js":41,"./Light/LED/index.js":40,"./Light/WS2811/index.js":39,"./Memory/24LC256/index.js":38,"./MovementSensor/Button/index.js":37,"./MovementSensor/JoyStick/index.js":36,"./MovementSensor/KXSC7-2050/index.js":35,"./MovementSensor/Potentiometer/index.js":34,"./Moving/DCMotor/index.js":33,"./Moving/ServoMotor/index.js":32,"./PressureSensor/FSR-40X/index.js":31,"./SoilSensor/SEN0114/index.js":30,"./Sound/Speaker/index.js":29,"./TemperatureSensor/analog/AnalogTempratureSensor.js":3,"./TemperatureSensor/analog/LM35DZ/index.js":28,"./TemperatureSensor/analog/LM60/index.js":27,"./TemperatureSensor/analog/LM61/index.js":26,"./TemperatureSensor/analog/MCP9700/index.js":25,"./TemperatureSensor/analog/MCP9701/index.js":24,"./TemperatureSensor/analog/S8100B/index.js":23,"./TemperatureSensor/analog/S8120C/index.js":22,"./TemperatureSensor/i2c/ADT7410/index.js":21,"./TemperatureSensor/i2c/S-5851A/index.js":20,"./TemperatureSensor/i2c/SHT31/index.js":19,"./TemperatureSensor/spi/ADT7310/index.js":18};function s(e){var t=n(e);return r(t)}function n(e){var t=i[e];if(!(t+1)){var r=new Error('Cannot find module "'+e+'".');throw r.code="MODULE_NOT_FOUND",r}return t}s.keys=function(){return Object.keys(i)},s.resolve=n,e.exports=s,s.id=56},function(e,t){e.exports=t=window.fetch,t.default=window.fetch.bind(window),t.Headers=window.Headers,t.Request=window.Request,t.Response=window.Response},function(e,t,r){const i=r(57);e.exports=class{constructor(e,t){this.id=e,t=t||{},this.options={access_token:t.access_token||null,obniz_server:t.obniz_server||"https://obniz.io"},this.urlBase=this.options.obniz_server+"/obniz/"+this.id}post(e,t,r){let s=this.urlBase+e,n={"Content-Type":"application/json"};this.options.access_token&&(n.authorization="Bearer "+this.options.access_token);let a={method:"POST",headers:n};return t&&(a.body=JSON.stringify(t)),i(s,a).then(e=>e.json()).then(e=>("function"==typeof r&&r(e),new Promise(t=>{t(e)})))}getState(e){return this.post("/state",null,e)}postJson(e,t){return this.post("/api/1",e,t)}}},function(e){e.exports={name:"obniz",version:"0.1.77",description:"Obniz Basic Library",main:"index.js",scripts:{test:"./node_modules/.bin/nyc --reporter=text --reporter=html ./node_modules/.bin/mocha $NODE_DEBUG_OPTION -b ./test/index.js",buildAndtest:"npm run build && npm test",realtest:"./node_modules/.bin/mocha $NODE_DEBUG_OPTION -b ./realtest/index.js",local:"./node_modules/.bin/gulp $NODE_DEBUG_OPTION --gulpfile ./_tools/server.js --cwd .",build:"./node_modules/.bin/gulp $NODE_DEBUG_OPTION --gulpfile ./_tools/server.js --cwd . build",version:"npm run build && git add obniz.js && git add obniz.node6_10.js"},keywords:["obniz"],repository:"obniz/obniz",author:"yukisato <yuki@yuki-sato.com>",homepage:"https://obniz.io/",license:"SEE LICENSE IN LICENSE.txt",devDependencies:{"babel-cli":"^6.26.0","babel-core":"^6.26.0","babel-loader":"^7.1.4","babel-polyfill":"^6.26.0","babel-preset-env":"^1.6.1","babel-preset-es2015":"^6.24.1","babel-preset-stage-3":"^6.24.1",chai:"^4.1.2","chai-like":"^1.1.1",child_process:"^1.0.2",chokidar:"^1.7.0","concat-with-sourcemaps":"^1.0.5",ejs:"^2.5.8",express:"^4.16.2","get-port":"^3.2.0",glob:"^7.1.2",gulp:"^3.9.1","gulp-babel":"^7.0.1","gulp-concat":"^2.6.1","gulp-ejs":"^3.1.2","gulp-filter":"^5.1.0","gulp-notify":"^3.2.0","gulp-plumber":"^1.2.0","gulp-sort":"^2.0.0","gulp-util":"^3.0.8","gulp-yaml":"^1.0.1","json-loader":"^0.5.7",mocha:"^5.0.5","mocha-chrome":"^1.0.3","mocha-directory":"^2.3.0","mocha-sinon":"^2.0.0",ncp:"^2.0.0","node-notifier":"^5.2.1",nyc:"^11.6.0",path:"^0.12.7",semver:"^5.5.0",sinon:"^4.5.0","svg-to-png":"^3.1.2",through2:"^2.0.3","uglifyjs-webpack-plugin":"^1.2.4",vinyl:"^2.1.0",webpack:"^4.5.0","webpack-cli":"^2.0.14","webpack-node-externals":"^1.7.2","webpack-stream":"^4.0.3","yaml-loader":"^0.5.0"},dependencies:{eventemitter3:"^3.0.1","js-yaml":"^3.11.0","node-dir":"^0.1.17","node-fetch":"^2.1.2",tv4:"^1.3.0",ws:"^5.1.1"},bugs:{url:"https://github.com/obniz/obniz/issues"},private:!1,browser:{ws:"./obniz/libs/webpackReplace/ws.js",canvas:"./obniz/libs/webpackReplace/canvas.js","./obniz/libs/webpackReplace/require-context.js":"./obniz/libs/webpackReplace/require-context-browser.js"}}},function(e,t,r){const i=r(1);e.exports=class extends i{constructor(e){super(e),this.module=12,this._CommandMeasurementEcho=0}echo(e){let t=e.echo.io_pulse,r="negative"!==e.echo.pulse,i=parseInt(1e3*e.echo.pulse_width),s=e.echo.io_echo,n=e.echo.measure_edges,a=1e3*e.echo.timeout;a=parseInt(a);var o=new Uint8Array(13);o[0]=0,o[1]=t,o[2]=r?1:0,o[3]=i>>24,o[4]=i>>16,o[5]=i>>8,o[6]=i,o[7]=s,o[8]=n,o[9]=a>>24,o[10]=a>>16,o[11]=a>>8,o[12]=a,this.sendCommand(this._CommandMeasurementEcho,o)}parseFromJson(e){var t=e.measure;if(void 0===t)return;let r=[{uri:"/request/measure/echo",onValid:this.echo}],i=this.validateCommandSchema(r,t,"measure");if(0===i.valid)throw i.invalidButLike.length>0?new Error(i.invalidButLike[0].message):new this.WSCommandNotFoundError("[measure]unknown command")}notifyFromBinary(e,t,r){if(t===this._CommandMeasurementEcho){for(var i=0,s=parseInt(r[i++]),n=[],a=0;a<s;a++){var o,c=r[i++]>0;o=r[i++]<<24,o+=r[i++]<<16,o+=r[i++]<<8,o+=r[i++],o/=1e3,n.push({edge:c,timing:o})}e.measure={echo:n}}else super.notifyFromBinary(e,t,r)}}},function(e,t,r){(function(t){e.exports=class{static convertFromBinaryToJson(e,t){for(var r={hex:this.hexFromBinary.bind(this),uuid:this.uuidFromBinary.bind(this),number:this.numberFromBinary.bind(this),"signed number":this.signedNumberFromBinary.bind(this),int:this.numberFromBinary.bind(this),char:this.numberFromBinary.bind(this),enum:this.enumFromBinary.bind(this),dataArray:this.dataArrayFromBinary.bind(this)},i={},s=0,n=0;n<e.length;n++){var a=t.slice(s,e[n].length?s+e[n].length:void 0);if(i[e[n].name]=r[e[n].type](a,e[n]),!e[n].length)break;s+=e[n].length}return i}static hexFromBinary(e,t){for(var r="",i=0;i<e.length;i++)t.endianness&&"little"===t.endianness?r=("00"+e[i].toString(16)).slice(-2)+r:r+=("00"+e[i].toString(16)).slice(-2);return r}static uuidFromBinary(e){var t=16*e[0]+e[1];if(0===t)return null;for(var r=e.slice(2),i="",s=0;s<t;s++)i=("00"+r[s].toString(16)).slice(-2)+i;return i}static signedNumberFromBinary(e,t){for(var r=127&e[0],i=1;i<e.length;i++)r=256*r+e[i];return 0!=(128&e[0])&&(r-=Math.pow(2,8*e.length-1)),r}static numberFromBinary(e){for(var t=0,r=0;r<e.length;r++)t=256*t+e[r];return t}static keyForVal(e,t){return Object.keys(e).filter(function(r){return e[r]===t})[0]}static enumFromBinary(e,t){let r=t.enum,i=this.numberFromBinary(e);if(!0===t.flags){let e=[];for(let t of Object.keys(r))r[t]&i&&e.push(t);i=e}else{let e=this.keyForVal(r,i);e&&(i=e)}return i}static dataArrayFromBinary(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e[r];return t}static createSendBuffer(e,t){for(var r=[],i=0;i<e.length;i++){var s=e[i],n=void 0;if(Array.isArray(s))for(var a in s){var o=Object.assign({},s[a],{required:!0});if(n=this.analyzeSchema(t,o))break}else n=this.analyzeSchema(t,s);Array.prototype.push.apply(r,n)}return new Uint8Array(r)}static analyzeSchema(e,t){var r={hex:this.hexToBinary.bind(this),uuid:this.uuidToBinary.bind(this),int:this.intToBinary.bind(this),char:this.charToBinary.bind(this),dataArray:this.dataArrayToBinary.bind(this),enum:this.enumToBinary.bind(this),string:this.stringToBinary.bind(this),text:this.stringToBinary.bind(this),flag:this.flagToBinary.bind(this)},i=void 0;if(t.path&&(i=this.getProperty(e,t.path)),void 0===i&&t.required)return null;void 0===i&&t.default&&(i=t.default);var s=r[t.type](i,t);return t.length&&s.length!==t.length&&console.log("JSON->BINARY SCHEMA ERROR: (",i,")",t),s}static getProperty(e,t){if(""===t||void 0===t)return e;"string"==typeof t&&(t=t.split(".")),Array.isArray(t)||(t=[t]);for(var r=0,i=t.length;r<i;)if(void 0===(e=e[t[r++]]))return;return r&&r===i?e:void 0}static hexToBinary(e,t){for(var r=[],i=e.toLowerCase().replace(/[^0-9abcdef]/g,""),s=0;s<i.length/2;s++)r[s]=parseInt(i[2*s]+i[2*s+1],16);return t&&t.endianness&&"little"===t.endianness&&r.reverse(),r}static intToBinary(e){var t=[];return t[0]=e>>24&255,t[1]=e>>16&255,t[2]=e>>8&255,t[3]=e>>0&255,t}static charToBinary(e){var t=[];return t[0]=255&e,t}static dataArrayToBinary(e){return Array.isArray(e)||(e=[e]),e}static uuidToBinary(e){var t=this.hexToBinary(e);t.reverse();var r=t.length,i=[];i[0]=r>>8&255,i[1]=r>>0&255,Array.prototype.push.apply(i,t);for(var s=i.length;s<18;s++)i[s]=0;return i}static enumToBinary(e,t){var r=[];return r.push(t.enum[e]),r}static flagToBinary(e,t){Array.isArray(e)||(e=[e]);var r=t.flags,i=0;for(var s in r)e.includes(r[s])&&(i+=parseInt(s));var n=[];for(let e=(t.length||1)-1;e>=0;e--)n.push(i>>e&255);return n}static stringToBinary(e){return isNode?new Uint8Array(t(e,"utf8")):TextEncoder?new Uint8Array(new TextEncoder("utf-8").encode(e)):void 0}}}).call(this,r(4).Buffer)},function(e,t,r){const i=r(61),s=r(1);e.exports=class extends s{constructor(e){super(e),this.module=11,this.uuidLength=18,this._CommandSetAdvData=0,this._CommandSetScanRespData=1,this._CommandStartAdv=2,this._CommandStopAdv=3,this._CommandScan=4,this._CommandStartScan=4,this._CommandStopScan=5,this._CommandScanResults=6,this._CommandConnect=7,this._CommandServices=8,this._CommandCharacteristics=9,this._CommandWriteCharacteristics=10,this._CommandReadCharacteristics=11,this._CommandRegisterNotifyCharacteristic=12,this._CommandUnregisterNotifyCharacteristic=13,this._CommandDescriptors=14,this._CommandWriteDescriptor=15,this._CommandReadDescriptor=16,this._CommandNotifyCharacteristic=17,this._CommandServerStartPeripheral=20,this._CommandServerNotifyConnect=21,this._CommandServerAddService=22,this._CommandServerAddCharacteristic=23,this._CommandServerAddDescriptor=24,this._CommandServerWriteCharavteristicValue=25,this._CommandServerReadCharavteristicValue=26,this._CommandServerNotifyWriteCharavteristicValue=27,this._CommandServerNotifyReadCharavteristicValue=28,this._CommandServerWriteDescriptorValue=29,this._CommandServerReadDescriptorValue=30,this._CommandServerNotifyWriteDescriptorValue=31,this._CommandServerNotifyReadDescriptorValue=32,this._CommandServerNofityCharavteristic=33,this._CommandServerStartStopService=34,this._CommandScanResultsDevice={breder:1,ble:2,dumo:3},this._CommandScanResultsDeviceAddress={public:0,random:1,rpa_public:2,rpa_random:3},this._CommandScanResultsEvet={inquiry_result:0,/*!< Inquiry result for a peer device. */
inquiry_complete:1,/*!< Inquiry complete. */
discovery_result:2,/*!< Discovery result for a peer device. */
discovery_ble_result:3,/*!< Discovery result for BLE GATT based service on a peer device. */
discovery_cmoplete:4,/*!< Discovery complete. */
discovery_di_cmoplete:5,/*!< Discovery complete. */
cancelled:6/*!< Search cancelled */},this._CommandScanResultsBleEvent={connectable_advertisemnt:0,/*!< Connectable undirected advertising (ADV_IND) */
connectable_directed_advertisemnt:1,/*!< Connectable directed advertising (ADV_DIRECT_IND) */
scannable_advertising:2,/*!< Scannable undirected advertising (ADV_SCAN_IND) */
non_connectable_advertising:3,/*!< Non connectable undirected advertising (ADV_NONCONN_IND) */
scan_response:4/*!< Scan Response (SCAN_RSP) */},this._CommandCharacteristicsProperties={broadcast:1,read:2,write_without_response:4,write:8,notify:16,indicate:32,auth:64,extended_properties:128},this._commandResults={success:0,failed:1}}centralScanStart(e){let t=i.createSendBuffer([{path:"scan.duration",length:4,type:"int",default:30}],e);this.sendCommand(this._CommandStartScan,t)}centralScanStop(e){this.sendCommand(this._CommandStopScan,null)}centralConnect(e){let t=i.createSendBuffer([{path:"connect.address",length:6,type:"hex",required:!0,endianness:"little"},{path:null,length:1,type:"char",default:!1}],e);this.sendCommand(this._CommandConnect,t)}centralDisconnect(e){let t=i.createSendBuffer([{path:"disconnect.address",length:6,type:"hex",required:!0,endianness:"little"},{path:null,length:1,type:"char",default:!0}],e);this.sendCommand(this._CommandConnect,t)}centralServiceGet(e){let t=i.createSendBuffer([{path:"get_services.address",length:6,type:"hex",required:!0,endianness:"little"}],e);this.sendCommand(this._CommandServices,t)}centralCharacteristicGet(e){var t=i.createSendBuffer([{path:"get_characteristics.address",length:6,type:"hex",required:!0,endianness:"little"},{path:"get_characteristics.service_uuid",length:18,type:"uuid",required:!0}],e);this.sendCommand(this._CommandCharacteristics,t)}centralCharacteristicRead(e){var t=i.createSendBuffer([{path:"read_characteristic.address",length:6,type:"hex",required:!0,endianness:"little"},{path:"read_characteristic.service_uuid",length:18,type:"uuid",required:!0},{path:"read_characteristic.characteristic_uuid",length:18,type:"uuid",required:!0}],e);this.sendCommand(this._CommandReadCharacteristics,t)}centralCharacteristicWrite(e){var t=i.createSendBuffer([{path:"write_characteristic.address",length:6,type:"hex",required:!0,endianness:"little"},{path:"write_characteristic.service_uuid",length:18,type:"uuid",required:!0},{path:"write_characteristic.characteristic_uuid",length:18,type:"uuid",required:!0},{path:"write_characteristic.needResponse",length:1,type:"char",default:1},{path:"write_characteristic.data",length:null,type:"dataArray"}],e);this.sendCommand(this._CommandWriteCharacteristics,t)}centralCharacteristicRegisterNotify(e){var t=i.createSendBuffer([{path:"register_notify_characteristic.address",length:6,type:"hex",required:!0,endianness:"little"},{path:"register_notify_characteristic.service_uuid",length:18,type:"uuid",required:!0},{path:"register_notify_characteristic.characteristic_uuid",length:18,type:"uuid",required:!0}],e);this.sendCommand(this._CommandRegisterNotifyCharacteristic,t)}centralCharacteristicUnregisterNotify(e){var t=i.createSendBuffer([{path:"unregister_notify_characteristic.address",length:6,type:"hex",required:!0,endianness:"little"},{path:"unregister_notify_characteristic.service_uuid",length:18,type:"uuid",required:!0},{path:"unregister_notify_characteristic.characteristic_uuid",length:18,type:"uuid",required:!0}],e);this.sendCommand(this._CommandUnregisterNotifyCharacteristic,t)}centralDescriptorGet(e){var t=i.createSendBuffer([{path:"get_descriptors.address",length:6,type:"hex",required:!0,endianness:"little"},{path:"get_descriptors.service_uuid",length:18,type:"uuid",required:!0},{path:"get_descriptors.characteristic_uuid",length:18,type:"uuid",required:!0}],e);this.sendCommand(this._CommandDescriptors,t)}centralDescriptorRead(e){var t=i.createSendBuffer([{path:"read_descriptor.address",length:6,type:"hex",required:!0,endianness:"little"},{path:"read_descriptor.service_uuid",length:18,type:"uuid",required:!0},{path:"read_descriptor.characteristic_uuid",length:18,type:"uuid",required:!0},{path:"read_descriptor.descriptor_uuid",length:18,type:"uuid",required:!0}],e);this.sendCommand(this._CommandReadDescriptor,t)}centralDescriptorWrite(e){var t=i.createSendBuffer([{path:"write_descriptor.address",length:6,type:"hex",required:!0,endianness:"little"},{path:"write_descriptor.service_uuid",length:18,type:"uuid",required:!0},{path:"write_descriptor.characteristic_uuid",length:18,type:"uuid",required:!0},{path:"write_descriptor.descriptor_uuid",length:18,type:"uuid",required:!0},{path:"write_descriptor.needResponse",length:1,type:"char",default:1},{path:"write_descriptor.data",length:null,type:"dataArray"}],e);this.sendCommand(this._CommandWriteDescriptor,t)}peripheralAdvertisementStart(e){this.sendCommand(this._CommandSetAdvData,new Uint8Array(e.advertisement.adv_data)),e.advertisement.scan_resp&&this.sendCommand(this._CommandSetScanRespData,new Uint8Array(e.advertisement.scan_resp)),this.sendCommand(this._CommandStartAdv,null)}peripheralAdvertisementStop(e){this.sendCommand(this._CommandStopAdv,null)}peripheralServiceStart(e){let t=e.peripheral;var r,s={1:"read",2:"read_encrypted",4:"read_enc_mitm",16:"write",32:"write_encrypted",64:"write_enc_mitm",128:"write_signed",256:"write_signed_mitm"},n={service:{command:this._CommandServerAddService,schema:[{path:"uuid",length:18,type:"uuid",required:!0}]},characteristic:{command:this._CommandServerAddCharacteristic,schema:[{path:"service_uuid",length:18,type:"uuid",required:!0},{path:"uuid",length:18,type:"uuid",required:!0},{path:"permissions",length:2,type:"flag",default:["write","read"],flags:s},{path:"properties",length:1,type:"flag",default:["write","read"],flags:{1:"broadcast",2:"read",4:"write_without_response",8:"write",16:"notify",32:"indiate",64:"auth",128:"ext_prop"}},{path:"data",type:"dataArray"}]},descriptor:{command:this._CommandServerAddDescriptor,schema:[{path:"service_uuid",length:18,type:"uuid",required:!0},{path:"characteristic_uuid",length:18,type:"uuid",required:!0},{path:"uuid",length:18,type:"uuid",required:!0},{path:"permissions",length:2,type:"flag",default:["write","read"],flags:s},{path:"data",type:"dataArray"}]},startService:{command:this._CommandServerStartStopService,schema:[{path:"uuid",length:18,type:"uuid",required:!0},{path:null,length:1,type:"char",default:0}]}},a=[],o=[];for(var c in t.services){var d=t.services[c];if(0===(r=i.createSendBuffer(n.service.schema,d)).length)return;for(var h in a.push({command:n.service.command,buffer:r}),r=i.createSendBuffer(n.startService.schema,d),o.push({command:n.startService.command,buffer:r}),d.characteristics){var u=d.characteristics[h];if(u.service_uuid=d.uuid,0===(r=i.createSendBuffer(n.characteristic.schema,u)).length)return;for(var l in a.push({command:n.characteristic.command,buffer:r}),u.descriptors){var p=u.descriptors[l];if(p.service_uuid=d.uuid,p.characteristic_uuid=u.uuid,0===(r=i.createSendBuffer(n.descriptor.schema,p)).length)return;a.push({command:n.descriptor.command,buffer:r})}}}for(var m in a)this.sendCommand(a[m].command,a[m].buffer);for(var m in o)this.sendCommand(o[m].command,o[m].buffer)}peripheralServiceStop(e){var t=i.createSendBuffer([{path:"peripheral.stop_service.service_uuid",length:18,type:"uuid",required:!0},{path:null,length:1,type:"char",default:1}],e);this.sendCommand(this._CommandServerStartStopService,t)}peripheralServiceStopAll(e){this.sendCommand(this._CommandServerStartPeripheral,new Uint8Array([1]))}peripheralCharacteristicRead(e){var t=i.createSendBuffer([{path:"peripheral.read_characteristic.service_uuid",length:18,type:"uuid",required:!0},{path:"peripheral.read_characteristic.characteristic_uuid",length:18,type:"uuid",required:!0}],e);this.sendCommand(this._CommandServerReadCharavteristicValue,t)}peripheralCharacteristicWrite(e){var t=i.createSendBuffer([{path:"peripheral.write_characteristic.service_uuid",length:18,type:"uuid",required:!0},{path:"peripheral.write_characteristic.characteristic_uuid",length:18,type:"uuid",required:!0},{path:"peripheral.write_characteristic.data",type:"dataArray"}],e);this.sendCommand(this._CommandServerWriteCharavteristicValue,t)}peripheralCharacteristicNotify(e){var t=i.createSendBuffer([{path:"peripheral.notify_characteristic.service_uuid",length:18,type:"uuid",required:!0},{path:"peripheral.notify_characteristic.characteristic_uuid",length:18,type:"uuid",required:!0}],e);this.sendCommand(this._CommandServerNofityCharavteristic,t)}peripheralDescriptorRead(e){var t=i.createSendBuffer([{path:"peripheral.read_descriptor.service_uuid",length:18,type:"uuid",required:!0},{path:"peripheral.read_descriptor.characteristic_uuid",length:18,type:"uuid",required:!0},{path:"peripheral.read_descriptor.descriptor_uuid",length:18,type:"uuid",required:!0}],e);this.sendCommand(this._CommandServerReadDescriptorValue,t)}peripheralDescriptorWrite(e){var t=i.createSendBuffer([{path:"peripheral.write_descriptor.service_uuid",length:18,type:"uuid",required:!0},{path:"peripheral.write_descriptor.characteristic_uuid",length:18,type:"uuid",required:!0},{path:"peripheral.write_descriptor.descriptor_uuid",length:18,type:"uuid",required:!0},{path:"peripheral.write_descriptor.data",type:"dataArray"}],e);this.sendCommand(this._CommandServerWriteDescriptorValue,t)}parseFromJson(e){var t=e.ble;if(void 0===t)return;let r=[{uri:"/request/ble/central/scan_start",onValid:this.centralScanStart},{uri:"/request/ble/central/scan_stop",onValid:this.centralScanStop},{uri:"/request/ble/central/connect",onValid:this.centralConnect},{uri:"/request/ble/central/disconnect",onValid:this.centralDisconnect},{uri:"/request/ble/central/service_get",onValid:this.centralServiceGet},{uri:"/request/ble/central/characteristic_get",onValid:this.centralCharacteristicGet},{uri:"/request/ble/central/characteristic_read",onValid:this.centralCharacteristicRead},{uri:"/request/ble/central/characteristic_write",onValid:this.centralCharacteristicWrite},{uri:"/request/ble/central/characteristic_register_notify",onValid:this.centralCharacteristicRegisterNotify},{uri:"/request/ble/central/characteristic_unregister_notify",onValid:this.centralCharacteristicUnregisterNotify},{uri:"/request/ble/central/descriptor_get",onValid:this.centralDescriptorGet},{uri:"/request/ble/central/descriptor_read",onValid:this.centralDescriptorRead},{uri:"/request/ble/central/descriptor_write",onValid:this.centralDescriptorWrite},{uri:"/request/ble/peripheral/advertisement_start",onValid:this.peripheralAdvertisementStart},{uri:"/request/ble/peripheral/advertisement_stop",onValid:this.peripheralAdvertisementStop},{uri:"/request/ble/peripheral/service_start",onValid:this.peripheralServiceStart},{uri:"/request/ble/peripheral/service_stop",onValid:this.peripheralServiceStop},{uri:"/request/ble/peripheral/service_stop_all",onValid:this.peripheralServiceStopAll},{uri:"/request/ble/peripheral/characteristic_read",onValid:this.peripheralCharacteristicRead},{uri:"/request/ble/peripheral/characteristic_write",onValid:this.peripheralCharacteristicWrite},{uri:"/request/ble/peripheral/characteristic_notify",onValid:this.peripheralCharacteristicNotify},{uri:"/request/ble/peripheral/descriptor_read",onValid:this.peripheralDescriptorRead},{uri:"/request/ble/peripheral/descriptor_write",onValid:this.peripheralDescriptorWrite}],i=this.validateCommandSchema(r,t,"ble");if(0===i.valid)throw i.invalidButLike.length>0?new Error(i.invalidButLike[0].message):new this.WSCommandNotFoundError("[ble]unknown command")}notifyFromBinary(e,t,r){let i={};i[this._CommandScanResults]=this.notifyFromBinaryScanResponse.bind(this),i[this._CommandConnect]=this.notifyFromBinaryConnect.bind(this),i[this._CommandServices]=this.notifyFromBinaryServices.bind(this),i[this._CommandCharacteristics]=this.notifyFromBinaryChacateristics.bind(this),i[this._CommandWriteCharacteristics]=this.notifyFromBinaryWriteChacateristics.bind(this),i[this._CommandReadCharacteristics]=this.notifyFromBinaryReadChacateristics.bind(this),i[this._CommandRegisterNotifyCharacteristic]=this.notifyFromBinaryRegisterNotifyChacateristic.bind(this),i[this._CommandUnregisterNotifyCharacteristic]=this.notifyFromBinaryUnregisterNotifyChacateristic.bind(this),i[this._CommandNotifyCharacteristic]=this.notifyFromBinaryNotifyChacateristic.bind(this),i[this._CommandDescriptors]=this.notifyFromBinaryDescriptors.bind(this),i[this._CommandWriteDescriptor]=this.notifyFromBinaryWriteDescriptor.bind(this),i[this._CommandReadDescriptor]=this.notifyFromBinaryReadDescriptor.bind(this),i[this._CommandServerNotifyConnect]=this.notifyFromBinaryServerConnectionState.bind(this),i[this._CommandServerReadCharavteristicValue]=this.notifyFromBinaryServerReadCharavteristicValue.bind(this),i[this._CommandServerWriteCharavteristicValue]=this.notifyFromBinaryServerWriteCharavteristicValue.bind(this),i[this._CommandServerNotifyReadCharavteristicValue]=this.notifyFromBinaryServerNotifyReadCharavteristicValue.bind(this),i[this._CommandServerNotifyWriteCharavteristicValue]=this.notifyFromBinaryServerNotifyWriteCharavteristicValue.bind(this),i[this._CommandServerReadDescriptorValue]=this.notifyFromBinaryServerReadDescriptorValue.bind(this),i[this._CommandServerWriteDescriptorValue]=this.notifyFromBinaryServerWriteDescriptorValue.bind(this),i[this._CommandServerNotifyReadDescriptorValue]=this.notifyFromBinaryServerNotifyReadDescriptorValue.bind(this),i[this._CommandServerNotifyWriteDescriptorValue]=this.notifyFromBinaryServerNotifyWriteDescriptorValue.bind(this),i[this.COMMAND_FUNC_ID_ERROR]=this.notifyFromBinaryError.bind(this),i[t]&&i[t](e,r)}notifyFromBinaryScanResponse(e,t){if(t.byteLength>1){var r=[{name:"event_type",type:"enum",length:1,enum:this._CommandScanResultsEvet},{name:"address",type:"hex",length:6,endianness:"little"},{name:"device_type",type:"enum",length:1,enum:this._CommandScanResultsDevice},{name:"address_type",type:"enum",length:1,enum:this._CommandScanResultsDeviceAddress},{name:"ble_event_type",type:"enum",length:1,enum:this._CommandScanResultsBleEvent},{name:"rssi",type:"signed number",length:4},{name:"adv_data",type:"dataArray",length:62},{name:"flag",type:"number",length:4},{name:"num_response",type:"number",length:4},{name:"advertise_length",type:"number",length:1},{name:"scan_response_length",type:"number",length:1}],s=i.convertFromBinaryToJson(r,t);s.scan_resp=s.adv_data.slice(s.advertise_length,s.advertise_length+s.scan_response_length),s.adv_data=s.adv_data.slice(0,s.advertise_length),delete s.num_response,delete s.advertise_length,delete s.scan_response_length,delete s.advertise_data,"inquiry_result"===s.event_type?(delete s.event_type,this._addRowForPath(e,"ble.scan_result",s)):"inquiry_complete"===s.event_type&&this._addRowForPath(e,"ble.scan_result_finish",!0)}}notifyFromBinaryConnect(e,t){if(7===t.length){var r=i.convertFromBinaryToJson([{name:"address",type:"hex",length:6,endianness:"little"},{name:"status",type:"enum",length:1,enum:{connected:0,disconnected:1}}],t);this._addRowForPath(e,"ble.status_update",r)}}notifyFromBinaryServices(e,t){var r=[{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength}],s=i.convertFromBinaryToJson(r,t);null!==s.service_uuid?this._addRowForPath(e,"ble.get_service_result",s):(delete s.service_uuid,this._addRowForPath(e,"ble.get_service_result_finish",s))}notifyFromBinaryChacateristics(e,t){var r=[{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"properties",type:"enum",length:1,enum:this._CommandCharacteristicsProperties,flags:!0}],s=i.convertFromBinaryToJson(r,t);null!==s.characteristic_uuid?this._addRowForPath(e,"ble.get_characteristic_result",s):(delete s.characteristic_uuid,delete s.properties,this._addRowForPath(e,"ble.get_characteristic_result_finish",s))}notifyFromBinaryReadChacateristics(e,t){var r=[{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"result",type:"int",length:1},{name:"data",type:"dataArray",length:null}],s=i.convertFromBinaryToJson(r,t);s.result=s.result===this._commandResults.success?"success":"failed",this._addRowForPath(e,"ble.read_characteristic_result",s)}notifyFromBinaryWriteChacateristics(e,t){var r=[{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"result",type:"int",length:1}],s=i.convertFromBinaryToJson(r,t);s.result=s.result===this._commandResults.success?"success":"failed",this._addRowForPath(e,"ble.write_characteristic_result",s)}notifyFromBinaryRegisterNotifyChacateristic(e,t){var r=[{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"result",type:"int",length:1}],s=i.convertFromBinaryToJson(r,t);s.result=s.result===this._commandResults.success?"success":"failed",this._addRowForPath(e,"ble.register_nofity_characteristic_result",s)}notifyFromBinaryUnregisterNotifyChacateristic(e,t){var r=[{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"result",type:"int",length:1}],s=i.convertFromBinaryToJson(r,t);s.result=s.result===this._commandResults.success?"success":"failed",this._addRowForPath(e,"ble.unregister_nofity_characteristic_result",s)}notifyFromBinaryNotifyChacateristic(e,t){var r=[{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"is_notify",type:"int",length:1},{name:"data",type:"dataArray",length:null}],s=i.convertFromBinaryToJson(r,t);s.is_notify=1===s.is_notify,this._addRowForPath(e,"ble.nofity_characteristic",s)}notifyFromBinaryDescriptors(e,t){var r=[{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"descriptor_uuid",type:"uuid",length:this.uuidLength}],s=i.convertFromBinaryToJson(r,t);null!==s.descriptor_uuid?this._addRowForPath(e,"ble.get_descriptor_result",s):(delete s.descriptor_uuid,this._addRowForPath(e,"ble.get_descriptor_result_finish",s))}notifyFromBinaryReadDescriptor(e,t){var r=[{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"descriptor_uuid",type:"uuid",length:this.uuidLength},{name:"result",type:"int",length:1},{name:"data",type:"dataArray",length:null}],s=i.convertFromBinaryToJson(r,t);s.result=s.result===this._commandResults.success?"success":"failed",this._addRowForPath(e,"ble.read_descriptor_result",s)}notifyFromBinaryWriteDescriptor(e,t){var r=[{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"descriptor_uuid",type:"uuid",length:this.uuidLength},{name:"result",type:"int",length:1}],s=i.convertFromBinaryToJson(r,t);s.result=s.result===this._commandResults.success?"success":"failed",this._addRowForPath(e,"ble.write_descriptor_result",s)}notifyFromBinaryServerConnectionState(e,t){var r=i.convertFromBinaryToJson([{name:"address",type:"hex",length:6,endianness:"little"},{name:"status",type:"enum",length:1,enum:{connected:1,disconnected:0}}],t);this._addRowForPath(e,"ble.peripheral.connection_status",r)}notifyFromBinaryServerWriteCharavteristicValue(e,t){var r=[{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"result",type:"int",length:1}],s=i.convertFromBinaryToJson(r,t);s.result=s.result===this._commandResults.success?"success":"failed",this._addRowForPath(e,"ble.peripheral.write_characteristic_result",s)}notifyFromBinaryServerReadCharavteristicValue(e,t){var r=[{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"data",type:"dataArray",length:null}],s=i.convertFromBinaryToJson(r,t);this._addRowForPath(e,"ble.peripheral.read_characteristic_result",s)}notifyFromBinaryServerNotifyReadCharavteristicValue(e,t){var r=[{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength}],s=i.convertFromBinaryToJson(r,t);this._addRowForPath(e,"ble.peripheral.notify_read_characteristic",s)}notifyFromBinaryServerNotifyWriteCharavteristicValue(e,t){var r=[{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"data",type:"dataArray",length:null}],s=i.convertFromBinaryToJson(r,t);this._addRowForPath(e,"ble.peripheral.notify_write_characteristic",s)}notifyFromBinaryServerReadDescriptorValue(e,t){var r=[{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"descriptor_uuid",type:"uuid",length:this.uuidLength},{name:"data",type:"dataArray",length:null}],s=i.convertFromBinaryToJson(r,t);this._addRowForPath(e,"ble.peripheral.read_descriptor_result",s)}notifyFromBinaryServerWriteDescriptorValue(e,t){var r=[{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"descriptor_uuid",type:"uuid",length:this.uuidLength},{name:"result",type:"int",length:1}],s=i.convertFromBinaryToJson(r,t);s.result=s.result===this._commandResults.success?"success":"failed",this._addRowForPath(e,"ble.peripheral.write_descriptor_result",s)}notifyFromBinaryServerNotifyReadDescriptorValue(e,t){var r=[{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"descriptor_uuid",type:"uuid",length:this.uuidLength}],s=i.convertFromBinaryToJson(r,t);this._addRowForPath(e,"ble.peripheral.notify_read_descriptor",s)}notifyFromBinaryServerNotifyWriteDescriptorValue(e,t){var r=[{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"descriptor_uuid",type:"uuid",length:this.uuidLength},{name:"data",type:"dataArray",length:null}],s=i.convertFromBinaryToJson(r,t);this._addRowForPath(e,"ble.peripheral.notify_write_descriptor",s)}notifyFromBinaryError(e,t){var r=[{name:"esp_error_code",type:"char",length:1},{name:"error_code",type:"char",length:1},{name:"function_code",type:"char",length:1},{name:"address",type:"hex",length:6,endianness:"little"},{name:"service_uuid",type:"uuid",length:this.uuidLength},{name:"characteristic_uuid",type:"uuid",length:this.uuidLength},{name:"descriptor_uuid",type:"uuid",length:this.uuidLength}],s=i.convertFromBinaryToJson(r,t);s.message={0:"no error",1:"device not connected",2:"service not found",3:"charavteristic not found",4:"descriptor not found",5:"no permission",6:"device not found",7:"ble is busy",8:"service already running",255:"error"}[s.error_code]+" "+{0:"on setting advertisement data",1:"on setting scan response data",2:"on starting advertisement",3:"on stopping advertisement",4:"on starting scan",5:"on stoping scan",6:"",7:"on connecting device",8:"on getting services",9:"on getting characteristic",10:"on writing characteristic",11:"on reading characteristic",14:"on getting descriptor",15:"on writing descriptor",16:"on reading descriptor",20:"on start pheripheral",21:"on notify connect",22:"on adding service",23:"on adding characteristic",24:"on adding descriptor",25:"on writing characteristic",26:"on reading characteristic",27:"on writing characteristic from remote",28:"on reading characteristic from remote",29:"on writing descriptor",30:"on reading descriptor",31:"on writing descriptor from remote",32:"on reading descriptor from remote"}[s.function_code],delete s.esp_error_code,delete s.function_code,this.envelopError(e,"ble",s)}_addRowForPath(e,t,r){for(var i=t.split("."),s=e,n=0;n<i.length-1;n++)s[i[n]]=s[i[n]]||{},s=s[i[n]];s[i[i.length-1]]=r}}},function(e,t,r){const i=r(1);e.exports=class extends i{constructor(e){super(e),this.module=9,this._CommandNotifyValue=0,this._CommandOnece=1}get(e){var t=new Uint8Array(0);this.sendCommand(this._CommandOnece,t)}parseFromJson(e){var t=e.switch;if(void 0===t)return;let r=[{uri:"/request/switch/get",onValid:this.get}],i=this.validateCommandSchema(r,t,"switch");if(0===i.valid)throw i.invalidButLike.length>0?new Error(i.invalidButLike[0].message):new this.WSCommandNotFoundError("[switch]unknown command")}notifyFromBinary(e,t,r){if(t!==this._CommandOnece&&t!==this._CommandNotifyValue||1!=r.byteLength)super.notifyFromBinary(e,t,r);else{var i=parseInt(r[0]);e.switch={state:["none","push","left","right"][i]},t===this._CommandOnece&&(e.switch.action="get")}}}},function(e,t){var r=function(){var e=function(e,t){var r=e,i=c[t],s=null,n=0,a=null,o=[],d={},h=function(e,t){s=function(e){for(var t=new Array(e),r=0;r<e;r+=1){t[r]=new Array(e);for(var i=0;i<e;i+=1)t[r][i]=null}return t}(n=4*r+17),u(0,0),u(n-7,0),u(0,n-7),p(),l(),f(e,t),r>=7&&m(e),null==a&&(a=v(r,i,o)),g(a,t)},u=function(e,t){for(var r=-1;r<=7;r+=1)if(!(e+r<=-1||n<=e+r))for(var i=-1;i<=7;i+=1)t+i<=-1||n<=t+i||(s[e+r][t+i]=0<=r&&r<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=i&&i<=4)},l=function(){for(var e=8;e<n-8;e+=1)null==s[e][6]&&(s[e][6]=e%2==0);for(var t=8;t<n-8;t+=1)null==s[6][t]&&(s[6][t]=t%2==0)},p=function(){for(var e=y.getPatternPosition(r),t=0;t<e.length;t+=1)for(var i=0;i<e.length;i+=1){var n=e[t],a=e[i];if(null==s[n][a])for(var o=-2;o<=2;o+=1)for(var c=-2;c<=2;c+=1)s[n+o][a+c]=-2==o||2==o||-2==c||2==c||0==o&&0==c}},m=function(e){for(var t=y.getBCHTypeNumber(r),i=0;i<18;i+=1){var a=!e&&1==(t>>i&1);s[Math.floor(i/3)][i%3+n-8-3]=a}for(i=0;i<18;i+=1){a=!e&&1==(t>>i&1);s[i%3+n-8-3][Math.floor(i/3)]=a}},f=function(e,t){for(var r=i<<3|t,a=y.getBCHTypeInfo(r),o=0;o<15;o+=1){var c=!e&&1==(a>>o&1);o<6?s[o][8]=c:o<8?s[o+1][8]=c:s[n-15+o][8]=c}for(o=0;o<15;o+=1){c=!e&&1==(a>>o&1);o<8?s[8][n-o-1]=c:o<9?s[8][15-o-1+1]=c:s[8][15-o-1]=c}s[n-8][8]=!e},g=function(e,t){for(var r=-1,i=n-1,a=7,o=0,c=y.getMaskFunction(t),d=n-1;d>0;d-=2)for(6==d&&(d-=1);;){for(var h=0;h<2;h+=1)if(null==s[i][d-h]){var u=!1;o<e.length&&(u=1==(e[o]>>>a&1)),c(i,d-h)&&(u=!u),s[i][d-h]=u,-1==(a-=1)&&(o+=1,a=7)}if((i+=r)<0||n<=i){i-=r,r=-r;break}}},v=function(e,t,r){for(var i=b.getRSBlocks(e,t),s=w(),n=0;n<r.length;n+=1){var a=r[n];s.put(a.getMode(),4),s.put(a.getLength(),y.getLengthInBits(a.getMode(),e)),a.write(s)}var o=0;for(n=0;n<i.length;n+=1)o+=i[n].dataCount;if(s.getLengthInBits()>8*o)throw"code length overflow. ("+s.getLengthInBits()+">"+8*o+")";for(s.getLengthInBits()+4<=8*o&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;!(s.getLengthInBits()>=8*o||(s.put(236,8),s.getLengthInBits()>=8*o));)s.put(17,8);return function(e,t){for(var r=0,i=0,s=0,n=new Array(t.length),a=new Array(t.length),o=0;o<t.length;o+=1){var c=t[o].dataCount,d=t[o].totalCount-c;i=Math.max(i,c),s=Math.max(s,d),n[o]=new Array(c);for(var h=0;h<n[o].length;h+=1)n[o][h]=255&e.getBuffer()[h+r];r+=c;var u=y.getErrorCorrectPolynomial(d),l=_(n[o],u.getLength()-1).mod(u);for(a[o]=new Array(u.getLength()-1),h=0;h<a[o].length;h+=1){var p=h+l.getLength()-a[o].length;a[o][h]=p>=0?l.getAt(p):0}}var m=0;for(h=0;h<t.length;h+=1)m+=t[h].totalCount;var f=new Array(m),g=0;for(h=0;h<i;h+=1)for(o=0;o<t.length;o+=1)h<n[o].length&&(f[g]=n[o][h],g+=1);for(h=0;h<s;h+=1)for(o=0;o<t.length;o+=1)h<a[o].length&&(f[g]=a[o][h],g+=1);return f}(s,i)};return d.addData=function(e,t){var r=null;switch(t=t||"Byte"){case"Numeric":r=C(e);break;case"Alphanumeric":r=x(e);break;case"Byte":r=S(e);break;case"Kanji":r=A(e);break;default:throw"mode:"+t}o.push(r),a=null},d.getModules=function(){return s},d.isDark=function(e,t){if(e<0||n<=e||t<0||n<=t)throw e+","+t;return s[e][t]},d.getModuleCount=function(){return n},d.make=function(){if(r<1){for(var e=1;e<40;e++){for(var t=b.getRSBlocks(e,i),s=w(),n=0;n<o.length;n++){var a=o[n];s.put(a.getMode(),4),s.put(a.getLength(),y.getLengthInBits(a.getMode(),e)),a.write(s)}var c=0;for(n=0;n<t.length;n++)c+=t[n].dataCount;if(s.getLengthInBits()<=8*c)break}r=e}h(!1,function(){for(var e=0,t=0,r=0;r<8;r+=1){h(!0,r);var i=y.getLostPoint(d);(0==r||e>i)&&(e=i,t=r)}return t}())},d.createTableTag=function(e,t){e=e||2;var r="";r+='<table style="',r+=" border-width: 0px; border-style: none;",r+=" border-collapse: collapse;",r+=" padding: 0px; margin: "+(t=void 0===t?4*e:t)+"px;",r+='">',r+="<tbody>";for(var i=0;i<d.getModuleCount();i+=1){r+="<tr>";for(var s=0;s<d.getModuleCount();s+=1)r+='<td style="',r+=" border-width: 0px; border-style: none;",r+=" border-collapse: collapse;",r+=" padding: 0px; margin: 0px;",r+=" width: "+e+"px;",r+=" height: "+e+"px;",r+=" background-color: ",r+=d.isDark(i,s)?"#000000":"#ffffff",r+=";",r+='"/>';r+="</tr>"}return r+="</tbody>",r+="</table>"},d.renderTo2dContext=function(e,t){t=t||2;for(var r=d.getModuleCount(),i=0;i<r;i++)for(var s=0;s<r;s++)e.fillStyle=d.isDark(i,s)?"black":"white",e.fillRect(i*t,s*t,t,t)},d};e.stringToBytes=(e.stringToBytesFuncs={default:function(e){for(var t=[],r=0;r<e.length;r+=1){var i=e.charCodeAt(r);t.push(255&i)}return t}}).default,e.createStringToBytes=function(e,t){var r=function(){for(var r=q(e),i=function(){var e=r.read();if(-1==e)throw"eof";return e},s=0,n={};;){var a=r.read();if(-1==a)break;var o=i(),c=i()<<8|i();n[String.fromCharCode(a<<8|o)]=c,s+=1}if(s!=t)throw s+" != "+t;return n}(),i="?".charCodeAt(0);return function(e){for(var t=[],s=0;s<e.length;s+=1){var n=e.charCodeAt(s);if(n<128)t.push(n);else{var a=r[e.charAt(s)];"number"==typeof a?(255&a)==a?t.push(a):(t.push(a>>>8),t.push(255&a)):t.push(i)}}return t}};var t,r,i,s=1,n=2,a=4,o=8,c={L:1,M:0,Q:3,H:2},d=0,h=1,u=2,l=3,p=4,m=5,f=6,g=7,y=(t=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],i=function(e){for(var t=0;0!=e;)t+=1,e>>>=1;return t},(r={}).getBCHTypeInfo=function(e){for(var t=e<<10;i(t)-i(1335)>=0;)t^=1335<<i(t)-i(1335);return 21522^(e<<10|t)},r.getBCHTypeNumber=function(e){for(var t=e<<12;i(t)-i(7973)>=0;)t^=7973<<i(t)-i(7973);return e<<12|t},r.getPatternPosition=function(e){return t[e-1]},r.getMaskFunction=function(e){switch(e){case d:return function(e,t){return(e+t)%2==0};case h:return function(e,t){return e%2==0};case u:return function(e,t){return t%3==0};case l:return function(e,t){return(e+t)%3==0};case p:return function(e,t){return(Math.floor(e/2)+Math.floor(t/3))%2==0};case m:return function(e,t){return e*t%2+e*t%3==0};case f:return function(e,t){return(e*t%2+e*t%3)%2==0};case g:return function(e,t){return(e*t%3+(e+t)%2)%2==0};default:throw"bad maskPattern:"+e}},r.getErrorCorrectPolynomial=function(e){for(var t=_([1],0),r=0;r<e;r+=1)t=t.multiply(_([1,v.gexp(r)],0));return t},r.getLengthInBits=function(e,t){if(1<=t&&t<10)switch(e){case s:return 10;case n:return 9;case a:case o:return 8;default:throw"mode:"+e}else if(t<27)switch(e){case s:return 12;case n:return 11;case a:return 16;case o:return 10;default:throw"mode:"+e}else{if(!(t<41))throw"type:"+t;switch(e){case s:return 14;case n:return 13;case a:return 16;case o:return 12;default:throw"mode:"+e}}},r.getLostPoint=function(e){for(var t=e.getModuleCount(),r=0,i=0;i<t;i+=1)for(var s=0;s<t;s+=1){for(var n=0,a=e.isDark(i,s),o=-1;o<=1;o+=1)if(!(i+o<0||t<=i+o))for(var c=-1;c<=1;c+=1)s+c<0||t<=s+c||0==o&&0==c||a==e.isDark(i+o,s+c)&&(n+=1);n>5&&(r+=3+n-5)}for(i=0;i<t-1;i+=1)for(s=0;s<t-1;s+=1){var d=0;e.isDark(i,s)&&(d+=1),e.isDark(i+1,s)&&(d+=1),e.isDark(i,s+1)&&(d+=1),e.isDark(i+1,s+1)&&(d+=1),0!=d&&4!=d||(r+=3)}for(i=0;i<t;i+=1)for(s=0;s<t-6;s+=1)e.isDark(i,s)&&!e.isDark(i,s+1)&&e.isDark(i,s+2)&&e.isDark(i,s+3)&&e.isDark(i,s+4)&&!e.isDark(i,s+5)&&e.isDark(i,s+6)&&(r+=40);for(s=0;s<t;s+=1)for(i=0;i<t-6;i+=1)e.isDark(i,s)&&!e.isDark(i+1,s)&&e.isDark(i+2,s)&&e.isDark(i+3,s)&&e.isDark(i+4,s)&&!e.isDark(i+5,s)&&e.isDark(i+6,s)&&(r+=40);var h=0;for(s=0;s<t;s+=1)for(i=0;i<t;i+=1)e.isDark(i,s)&&(h+=1);return r+=Math.abs(100*h/t/t-50)/5*10},r),v=function(){for(var e=new Array(256),t=new Array(256),r=0;r<8;r+=1)e[r]=1<<r;for(r=8;r<256;r+=1)e[r]=e[r-4]^e[r-5]^e[r-6]^e[r-8];for(r=0;r<255;r+=1)t[e[r]]=r;var i={glog:function(e){if(e<1)throw"glog("+e+")";return t[e]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return e[t]}};return i}();function _(e,t){if(void 0===e.length)throw e.length+"/"+t;var r=function(){for(var r=0;r<e.length&&0==e[r];)r+=1;for(var i=new Array(e.length-r+t),s=0;s<e.length-r;s+=1)i[s]=e[s+r];return i}(),i={getAt:function(e){return r[e]},getLength:function(){return r.length},multiply:function(e){for(var t=new Array(i.getLength()+e.getLength()-1),r=0;r<i.getLength();r+=1)for(var s=0;s<e.getLength();s+=1)t[r+s]^=v.gexp(v.glog(i.getAt(r))+v.glog(e.getAt(s)));return _(t,0)},mod:function(e){if(i.getLength()-e.getLength()<0)return i;for(var t=v.glog(i.getAt(0))-v.glog(e.getAt(0)),r=new Array(i.getLength()),s=0;s<i.getLength();s+=1)r[s]=i.getAt(s);for(s=0;s<e.getLength();s+=1)r[s]^=v.gexp(v.glog(e.getAt(s))+t);return _(r,0).mod(e)}};return i}var b=function(){var e=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],t=function(e,t){var r={};return r.totalCount=e,r.dataCount=t,r},r={};return r.getRSBlocks=function(r,i){var s=function(t,r){switch(r){case c.L:return e[4*(t-1)+0];case c.M:return e[4*(t-1)+1];case c.Q:return e[4*(t-1)+2];case c.H:return e[4*(t-1)+3];default:return}}(r,i);if(void 0===s)throw"bad rs block @ typeNumber:"+r+"/errorCorrectionLevel:"+i;for(var n=s.length/3,a=[],o=0;o<n;o+=1)for(var d=s[3*o+0],h=s[3*o+1],u=s[3*o+2],l=0;l<d;l+=1)a.push(t(h,u));return a},r}(),w=function(){var e=[],t=0,r={getBuffer:function(){return e},getAt:function(t){var r=Math.floor(t/8);return 1==(e[r]>>>7-t%8&1)},put:function(e,t){for(var i=0;i<t;i+=1)r.putBit(1==(e>>>t-i-1&1))},getLengthInBits:function(){return t},putBit:function(r){var i=Math.floor(t/8);e.length<=i&&e.push(0),r&&(e[i]|=128>>>t%8),t+=1}};return r},C=function(e){var t=s,r=e,i={getMode:function(){return t},getLength:function(e){return r.length},write:function(e){for(var t=r,i=0;i+2<t.length;)e.put(n(t.substring(i,i+3)),10),i+=3;i<t.length&&(t.length-i==1?e.put(n(t.substring(i,i+1)),4):t.length-i==2&&e.put(n(t.substring(i,i+2)),7))}},n=function(e){for(var t=0,r=0;r<e.length;r+=1)t=10*t+a(e.charAt(r));return t},a=function(e){if("0"<=e&&e<="9")return e.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+e};return i},x=function(e){var t=n,r=e,i={getMode:function(){return t},getLength:function(e){return r.length},write:function(e){for(var t=r,i=0;i+1<t.length;)e.put(45*s(t.charAt(i))+s(t.charAt(i+1)),11),i+=2;i<t.length&&e.put(s(t.charAt(i)),6)}},s=function(e){if("0"<=e&&e<="9")return e.charCodeAt(0)-"0".charCodeAt(0);if("A"<=e&&e<="Z")return e.charCodeAt(0)-"A".charCodeAt(0)+10;switch(e){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+e}};return i},S=function(t){var r=a,i=e.stringToBytes(t),s={getMode:function(){return r},getLength:function(e){return i.length},write:function(e){for(var t=0;t<i.length;t+=1)e.put(i[t],8)}};return s},A=function(t){var r=o,i=e.stringToBytesFuncs.SJIS;if(!i)throw"sjis not supported.";!function(e,t){var r=i("");if(2!=r.length||38726!=(r[0]<<8|r[1]))throw"sjis not supported."}();var s=i(t),n={getMode:function(){return r},getLength:function(e){return~~(s.length/2)},write:function(e){for(var t=s,r=0;r+1<t.length;){var i=(255&t[r])<<8|255&t[r+1];if(33088<=i&&i<=40956)i-=33088;else{if(!(57408<=i&&i<=60351))throw"illegal char at "+(r+1)+"/"+i;i-=49472}i=192*(i>>>8&255)+(255&i),e.put(i,13),r+=2}if(r<t.length)throw"illegal char at "+(r+1)}};return n},q=function(e){var t=e,r=0,i=0,s=0,n={read:function(){for(;s<8;){if(r>=t.length){if(0==s)return-1;throw"unexpected end of file./"+s}var e=t.charAt(r);if(r+=1,"="==e)return s=0,-1;e.match(/^\s$/)||(i=i<<6|a(e.charCodeAt(0)),s+=6)}var n=i>>>s-8&255;return s-=8,n}},a=function(e){if(65<=e&&e<=90)return e-65;if(97<=e&&e<=122)return e-97+26;if(48<=e&&e<=57)return e-48+52;if(43==e)return 62;if(47==e)return 63;throw"c:"+e};return n};return e}();r.stringToBytesFuncs["UTF-8"]=function(e){return function(e){for(var t=[],r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(r++,i=65536+((1023&i)<<10|1023&e.charCodeAt(r)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t}(e)},e.exports=r},function(e,t,r){(function(t){const i=r(1),s=r(64);let n="undefined"==typeof window;e.exports=class extends i{constructor(e){super(e),this.module=8,this._CommandClear=0,this._CommandPrint=1,this._CommandDrawCampusVerticalBytes=2,this._CommandDrawCampusHorizonalBytes=3,this._CommandDrawIOState=4,this._CommandSetPinName=5}clear(e){this.sendCommand(this._CommandClear,null)}print(e){this.sendCommand(this._CommandPrint,e)}printText(e){var r;if(n){const i=t(e,"utf8");r=new Uint8Array(i)}else TextEncoder&&(r=new Uint8Array(new TextEncoder("utf-8").encode(e)));this.print(r)}text(e){this.printText(e.text)}raw(e){this.drawHorizonally(new Uint8Array(e.raw))}qr(e){const t=e.qr.text,r=e.qr.correction||"M",i=s(0,r);i.addData(t),i.make();let n=i.getModuleCount();if(n){n*=2;const e=i.getModules();let t=new Uint8Array(1024);t.fill(0);for(let e=0;e<2;e++)for(let r=0;r<n+4;r++)t[parseInt(16*e+r/8)]|=128>>r%8,t[parseInt(16*(e+n+2)+r/8)]|=128>>r%8;for(let e=2;e<n+2;e++){for(let r=0;r<2;r++)t[parseInt(16*e+r/8)]|=128>>r%8;for(let r=n+2;r<n+4;r++)t[parseInt(16*e+r/8)]|=128>>r%8}for(let r=0;r<n;r++)for(let i=0;i<n;i++)e[parseInt(r/2)][parseInt(i/2)]||(t[parseInt(16*(r+2)+(i+2)/8)]|=128>>(i+2)%8);this.drawHorizonally(t)}}pinName(e){for(var t=0;t<12;t++)"object"==typeof e.pin_assign[t]&&this.setPinName(t,e.pin_assign[t].module_name||"?",e.pin_assign[t].pin_name||"?")}drawVertically(e){this.sendCommand(this._CommandDrawCampusVerticalBytes,e)}drawHorizonally(e){this.sendCommand(this._CommandDrawCampusHorizonalBytes,e)}drawIOState(e){var t=new Uint8Array([!e]);this.sendCommand(this._CommandDrawIOState,t)}setPinName(e,r,i){var s=r.slice(0,4)+" "+i;s=s.slice(0,9);var a,o=new Uint8Array(1);if(o[0]=e,n){const e=t(s,"utf8");a=new Uint8Array(e)}else TextEncoder&&(a=new Uint8Array(new TextEncoder("utf-8").encode(s)));var c=new Uint8Array(o.length+a.length);c.set(o,0),c.set(a,1),this.sendCommand(this._CommandSetPinName,c)}parseFromJson(e){var t=e.display;if(void 0===t)return;let r=[{uri:"/request/display/clear",onValid:this.clear},{uri:"/request/display/text",onValid:this.text},{uri:"/request/display/raw",onValid:this.raw},{uri:"/request/display/pin_assign",onValid:this.pinName},{uri:"/request/display/qr",onValid:this.qr}],i=this.validateCommandSchema(r,t,"display");if(0===i.valid)throw i.invalidButLike.length>0?new Error(i.invalidButLike[0].message):new this.WSCommandNotFoundError("[display]unknown command")}}}).call(this,r(4).Buffer)},function(e,t,r){const i=r(1);e.exports=class extends i{constructor(e){super(e),this.module=10,this._CommandInit=0,this._CommandDeinit=1,this._CommandRecv=2}init(e){let t=e.io[0],r=1e3*e.interval,i=1e3*e.duration,s=parseInt(e.triger.value),n=e.triger.samples;var a=new Uint8Array(12);a[0]=1,a[1]=t,a[2]=r>>24,a[3]=r>>16,a[4]=r>>8,a[5]=r,a[6]=i>>24,a[7]=i>>16,a[8]=i>>8,a[9]=i,a[10]=s,a[11]=n,this.sendCommand(this._CommandInit,a)}deinit(e){var t=new Uint8Array(0);this.sendCommand(this._CommandDeinit,t)}parseFromJson(e){var t=e.logic_analyzer;if(void 0===t)return;let r=[{uri:"/request/logicAnalyzer/init",onValid:this.init},{uri:"/request/logicAnalyzer/deinit",onValid:this.deinit}],i=this.validateCommandSchema(r,t,"logic_analyzer");if(0===i.valid)throw i.invalidButLike.length>0?new Error(i.invalidButLike[0].message):new this.WSCommandNotFoundError("[logic_analyzer]unknown command")}notifyFromBinary(e,t,r){if(t===this._CommandRecv){let t=new Array(8*r.byteLength),i=0;for(let e=0;e<r.byteLength;e++){const s=r[e];for(let e=0;e<8;e++)t[i]=s&128>>>e?1:0,i++}e.logic_analyzer={data:t}}else super.notifyFromBinary(e,t,r)}}},function(e,t,r){const i=r(1);e.exports=class extends i{constructor(e){super(e),this.module=6,this._CommandInit=0,this._CommandDeinit=1,this._CommandWrite=2,this._CommandRead=3,this._CommandSlvWritten=4}initMaster(e,t){var r=parseInt(e.sda),i=parseInt(e.scl),s=parseInt(e.clock),n=new Uint8Array(8);n[0]=t,n[1]=0,n[2]=r,n[3]=i,n[4]=s>>24,n[5]=s>>16,n[6]=s>>8,n[7]=s,this.sendCommand(this._CommandInit,n)}initSlave(e,t){var r=parseInt(e.sda),i=parseInt(e.scl),s=e.slave_address_length,n=e.slave_address;n>127&&(s=10);var a=new Uint8Array(11);a[0]=t,a[1]=1,a[2]=r,a[3]=i,a[4]=0,a[5]=0,a[6]=0,a[7]=0,a[8]=s,a[9]=n>>8,a[10]=n,this.sendCommand(this._CommandInit,a)}deinit(e,t){var r=new Uint8Array([t]);this.sendCommand(this._CommandDeinit,r)}write(e,t){let r=parseInt(e.address);(10===e.address_bits||r>127)&&(r|=32768);var i=new Uint8Array(3+e.data.length);i[0]=t,i[1]=r>>8,i[2]=r,i.set(e.data,3),this.sendCommand(this._CommandWrite,i)}read(e,t){let r=parseInt(e.address);(10===e.address_bits||r>127)&&(r|=32768);let i=e.read;var s=new Uint8Array(7);s[0]=t,s[1]=r>>8,s[2]=r,s[3]=i>>24,s[4]=i>>16,s[5]=i>>8,s[6]=i,this.sendCommand(this._CommandRead,s)}parseFromJson(e){for(var t=0;t<1;t++){var r=e["i2c"+t];if(void 0===r)continue;let i=[{uri:"/request/i2c/init_master",onValid:this.initMaster},{uri:"/request/i2c/init_slave",onValid:this.initSlave},{uri:"/request/i2c/write",onValid:this.write},{uri:"/request/i2c/read",onValid:this.read},{uri:"/request/i2c/deinit",onValid:this.deinit}],s=this.validateCommandSchema(i,r,"i2c"+t,t);if(0===s.valid)throw s.invalidButLike.length>0?new Error(s.invalidButLike[0].message):new this.WSCommandNotFoundError(`[i2c${t}]unknown command`)}}notifyFromBinary(e,t,r){if(t===this._CommandRead&&r.byteLength>3){for(var i=r[0],s=(r[1]<<8)+r[2],n=new Array(r.byteLength-3),a=0;a<n.length;a++)n[a]=r[a+3];e["i2c"+i]={mode:"master",address:s,data:n}}else if(t===this._CommandSlvWritten&&r.byteLength>4){for(i=r[0],r[1],s=(r[2]<<8)+r[3],n=new Array(r.byteLength-4),a=0;a<n.length;a++)n[a]=r[a+4];e["i2c"+i]={mode:"slave",is_fragmented:!0,address:s,data:n}}else if(t===this.COMMAND_FUNC_ID_ERROR&&r.byteLength>2){r[0];const i=r[1],s=r[2];if(s===this._CommandWrite||s===this._CommandRead){let t=(s===this._CommandWrite?"writing":"reading")+" error. ";7===i?t+="Communication Timeout. Maybe, target is not connected.":255===i&&(t+="Communication Failed. Maybe, target is not connected."),this.envelopError(e,"i2c0",{message:t})}else super.notifyFromBinary(e,t,r)}else super.notifyFromBinary(e,t,r)}}},function(e,t,r){const i=r(1);e.exports=class extends i{constructor(e){super(e),this.module=5,this._CommandInit=0,this._CommandDeinit=1,this._CommandWriteRead=2,this._CommandWrite=3}initMaster(e,t){let r=e.clk,i=e.mosi,s=e.miso,n=e.cs;var a=e.clock;if(null===r&&null===i&&null===s)throw new Error("spi: master mode require one of clk/mosi/miso");null===r&&(r=this.ioNotUsed),null===i&&(i=this.ioNotUsed),null===s&&(s=this.ioNotUsed),null===n&&(n=this.ioNotUsed);var o=new Uint8Array(11);o[0]=t,o[1]=0,o[2]=r,o[3]=i,o[4]=s,o[5]=this.ioNotUsed,o[6]=this.ioNotUsed,o[7]=a>>24,o[8]=a>>16,o[9]=a>>8,o[10]=a,o[11]=n,this.sendCommand(this._CommandInit,o)}deinit(e,t){var r=new Uint8Array([t]);this.sendCommand(this._CommandDeinit,r)}write(e,t){var r=new Uint8Array(1+e.data.length);r[0]=t,r.set(e.data,1),e.read?this.sendCommand(this._CommandWriteRead,r):this.sendCommand(this._CommandWrite,r)}parseFromJson(e){for(var t=0;t<2;t++){var r=e["spi"+t];if(void 0===r)continue;let i=[{uri:"/request/spi/init_master",onValid:this.initMaster},{uri:"/request/spi/write",onValid:this.write},{uri:"/request/spi/deinit",onValid:this.deinit}],s=this.validateCommandSchema(i,r,"spi"+t,t);if(0===s.valid)throw s.invalidButLike.length>0?new Error(s.invalidButLike[0].message):new this.WSCommandNotFoundError(`[spi${t}]unknown command`)}}notifyFromBinary(e,t,r){if(t===this._CommandWriteRead&&r.byteLength>1){for(var i=r[0],s=(r.slice(1),new Array(r.byteLength-1)),n=0;n<s.length;n++)s[n]=r[n+1];e["spi"+i]={data:s}}else super.notifyFromBinary(e,t,r)}}},function(e,t,r){const i=r(1);e.exports=class extends i{constructor(e){super(e),this.module=7,this._CommandInitNormalInterval=0,this._CommandDeinit=1,this._CommandNotifyValue=2,this._CommandDoOnece=3}get(e,t){var r=new Uint8Array([t]);this.sendCommand(e.stream?this._CommandInitNormalInterval:this._CommandDoOnece,r)}deinit(e,t){var r=new Uint8Array([t]);this.sendCommand(this._CommandDeinit,r)}parseFromJson(e){for(var t=0;t<12;t++){var r=e["ad"+t];if(void 0===r)continue;let i=[{uri:"/request/ad/deinit",onValid:this.deinit},{uri:"/request/ad/get",onValid:this.get}],s=this.validateCommandSchema(i,r,"ad"+t,t);if(0===s.valid)throw s.invalidButLike.length>0?new Error(s.invalidButLike[0].message):new this.WSCommandNotFoundError(`[ad${t}]unknown command`)}}notifyFromBinary(e,t,r){if(t===this._CommandNotifyValue)for(var i=0;i<r.byteLength;i+=3){var s=(r[i+1]<<8)+r[i+2];s/=100,e["ad"+r[i]]=s}else super.notifyFromBinary(e,t,r)}}},function(e,t,r){const i=r(1);e.exports=class extends i{constructor(e){super(e),this.module=4,this._CommandInit=0,this._CommandDeinit=1,this._CommandSend=2,this._CommandRecv=3}init(e,t){var r=new Uint8Array(13);if(r[0]=t,r[1]=parseInt(e.tx),r[2]=parseInt(e.rx),r[3]=e.baud>>24,r[4]=e.baud>>16,r[5]=e.baud>>8,r[6]=e.baud,1===e.stop)r[7]=1;else if(1.5===e.stop)r[7]=2;else if(2===e.stop)r[7]=3;else{if(0!==e.stop)throw new Error("uart: invalid stop bits");r[7]=0}r[8]=e.bits,"even"===e.parity?r[9]=2:"odd"===e.parity&&(r[9]=3),"rts"===e.flowcontrol?r[10]=2:"cts"===e.flowcontrol?r[10]=3:"rts-cts"===e.flowcontrol&&(r[10]=4),null!==e.rts&&(r[11]=e.rts),null!==e.cts&&(r[12]=e.cts),this.sendCommand(this._CommandInit,r)}deinit(e,t){var r=new Uint8Array(1);r[0]=t,this.sendCommand(this._CommandDeinit,r)}send(e,t){var r=new Uint8Array(1+e.data.length);r[0]=t,r.set(e.data,1),this.sendCommand(this._CommandSend,r)}parseFromJson(e){for(var t=0;t<3;t++){var r=e["uart"+t];if(void 0===r)continue;let i=[{uri:"/request/uart/init",onValid:this.init},{uri:"/request/uart/send",onValid:this.send},{uri:"/request/uart/deinit",onValid:this.deinit}],s=this.validateCommandSchema(i,r,"uart"+t,t);if(0===s.valid)throw s.invalidButLike.length>0?new Error(s.invalidButLike[0].message):new this.WSCommandNotFoundError(`[uart${t}]unknown command`)}}notifyFromBinary(e,t,r){if(t===this._CommandRecv&&r.byteLength>1){for(var i=r[0],s=new Array(r.byteLength-1),n=0;n<s.length;n++)s[n]=r[n+1];e["uart"+i]={data:s}}else super.notifyFromBinary(e,t,r)}}},function(e,t,r){const i=r(1),s=r(2);e.exports=class extends i{constructor(e){super(e),this.module=1,this._CommandRegistrate=0,this._CommandPause=1,this._CommandResume=2;const t=r(12),i=r(11);this.availableCommands=[new t,new i]}init(e,t){const r=s.string2dataArray(e.animation.name);let n=new Uint8Array(r.length+2);n[0]=r.length+1,n.set(r,1),n[n.byteLength-1]=0;const a=e.animation.states;for(let e=0;e<a.length;e++){const t=a[e],r=parseInt(1e3*t.duration),s=t.state,c=i.compress(this.availableCommands,JSON.parse(JSON.stringify(s)));if(!c)throw new Error("[io.animation.states.state]only io or pwm commands. Pleave provide state at least one of them.");const d=c.byteLength;var o=new Uint8Array(8);o[0]=d>>24,o[1]=d>>16,o[2]=d>>8,o[3]=d,o[4]=r>>24,o[5]=r>>16,o[6]=r>>8,o[7]=r;const h=new Uint8Array(n.byteLength+o.byteLength+c.byteLength);h.set(n,0),h.set(o,n.byteLength),h.set(c,n.byteLength+o.byteLength),n=h}if(n.byteLength>1e3)throw new Error("[io.animation]Too big animation datas");this.sendCommand(this._CommandRegistrate,n)}changeState(e){if("resume"===e.animation.status){const t=s.string2dataArray(e.animation.name);let r=new Uint8Array(t.length+2);r[0]=t.length+1,r.set(t,1),r[r.byteLength-1]=0,this.sendCommand(this._CommandResume,r)}else if("pause"===e.animation.status){const t=s.string2dataArray(e.animation.name);let r=new Uint8Array(t.length+2);r[0]=t.length+1,r.set(t,1),r[r.byteLength-1]=0,this.sendCommand(this._CommandPause,r)}}parseFromJson(e){let t=!1;try{super.parseFromJson(e)}catch(e){if(!(e instanceof this.WSCommandNotFoundError))throw e;t=!0}const r=e.io;if(void 0===r)return;const i=[{uri:"/request/ioAnimation/init",onValid:this.init},{uri:"/request/ioAnimation/changeState",onValid:this.changeState}],s=this.validateCommandSchema(i,r,"io",r);if(0===s.valid&&t){if(s.invalidButLike.length>0)throw new Error(s.invalidButLike[0].message);throw new(0,this.WSCommandNotFoundError)("[io.animation]unknown command")}}}},function(e,t,r){(function(t){const i=r(1);e.exports=class extends i{constructor(e){super(e),this.module=0,this._CommandReboot=0,this._CommandReset=2,this._CommandSelfCheck=3,this._CommandWait=4,this._CommandResetOnDisconnect=5,this._CommandPingPong=8,this._CommandVCC=9}reboot(e){this.sendCommand(this._CommandReboot,null)}reset(e){this.sendCommand(this._CommandReset,null)}selfCheck(e){this.sendCommand(this._CommandSelfCheck,null)}wait(e){let t=e.wait;var r=new Uint8Array([t>>8,t]);this.sendCommand(this._CommandWait,r)}keepWorkingAtOffline(e){this.resetOnDisconnect(!e.keep_working_at_offline)}ping(e){let t=(new Date).getTime(),r=new Uint8Array(e.ping.key.length+8),i=Math.floor(t/Math.pow(2,32)),s=t-i*Math.pow(2,32);r[0]=i>>24,r[1]=i>>16,r[2]=i>>8,r[3]=i>>0,r[4]=s>>24,r[5]=s>>16,r[6]=s>>8,r[7]=s>>0;for(let t=0;t<e.ping.key.length;t++)r[8+t]=e.ping.key[t];this.sendCommand(this._CommandPingPong,r)}resetOnDisconnect(e){var t=new Uint8Array([e?1:0]);this.sendCommand(this._CommandResetOnDisconnect,t)}parseFromJson(e){var t=e.system;if(void 0===t)return;let r=[{uri:"/request/system/reboot",onValid:this.reboot},{uri:"/request/system/reset",onValid:this.reset},{uri:"/request/system/wait",onValid:this.wait},{uri:"/request/system/selfCheck",onValid:this.selfCheck},{uri:"/request/system/keepWorkingAtOffline",onValid:this.keepWorkingAtOffline},{uri:"/request/system/ping",onValid:this.ping}],i=this.validateCommandSchema(r,t,"system");if(0===i.valid)throw i.invalidButLike.length>0?new Error(i.invalidButLike[0].message):new this.WSCommandNotFoundError("[system]unknown command")}pong(e,r){e.system=e.system||{};const i=(new Date).getTime();if(r.length>=16){let s=(r=t(r)).readUIntBE(0,4)*Math.pow(2,32)+r.readUIntBE(4,4),n=r.readUIntBE(8,4)*Math.pow(2,32)+r.readUIntBE(12,4),a=[];for(let e=16;e<r.length;e++)a.push(r[e]);e.system.pong={key:a,obnizTime:s,pingServerTime:n,pongServerTime:i}}else e.system.pong={pongServerTime:i}}notifyFromBinary(e,t,r){switch(t){case this._CommandVCC:if(3===r.byteLength){let t=(r[1]<<8)+r[2];t/=100,this.envelopWarning(e,"debug",{message:`Low Voltage ${t}v. connect obniz to more powerful USB.`})}break;case this._CommandPingPong:this.pong(e,r);break;default:super.notifyFromBinary(e,t,r)}}}}).call(this,r(4).Buffer)},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ws/redirect",description:"If the server required you to connect other endpoint to communicate with your obniz. This json will be sent.",type:"object",required:["redirect"],properties:{redirect:{type:"string",example:"wss://ws1.obniz.io",description:"The url you should redirect to."}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ws/ready",description:"all things ready",type:"object",required:["ready"],properties:{ready:{type:"boolean",enum:[!0]}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ws",basePath:"ws",anyOf:[{$ref:"/response/ws/ready"},{$ref:"/response/ws/redirect"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/uart/receive",type:"object",properties:{data:{$ref:"/dataArray"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/uart",basePath:"uart0",anyOf:[{$ref:"/response/uart/receive"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/system/pong",desccription:"pong response with same key of ping request",type:"object",required:["pong"],properties:{pong:{type:"object",required:["key"],properties:{key:{$ref:"/dataArray"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/system",basePath:"system",anyOf:[{$ref:"/response/system/pong"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/switch",basePath:"switch",anyOf:[{$ref:"/response/switch/change"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/switch/change",desccription:"value cahnges are always notified.",type:"object",required:["state"],properties:{state:{type:"string",enum:["none","push","left","right"]},action:{type:"string",enum:["get"],description:"this is optional and added when user request"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/spi/read",type:"object",required:["data"],properties:{data:{$ref:"/dataArray"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/spi",basePath:"spi0",anyOf:[{$ref:"/response/spi/read"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/message/receive",related:"/request/message/send",type:"object",required:["data","from"],properties:{data:{example:"button pressed",description:"All type of data is pass."},from:{type:["string","null"],example:"1234-5678",description:"From obniz id. Null is used when webhook message."}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/message",basePath:"message",anyOf:[{$ref:"/response/message/receive"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/measure",basePath:"measure",anyOf:[{$ref:"/response/measure/echo"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/measure/echo",type:"object",required:["echo"],properties:{echo:{type:"array",minItesm:1,items:{type:"object",required:["edge","timing"],properties:{edge:{type:"boolean",description:"rising = true"},timing:{type:"number",description:"msec from end of pulse"}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/logicAnalyzer",basePath:"logic_analyzer",anyOf:[{$ref:"/response/logicAnalyzer/data"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/logicAnalyzer/data",type:"object",required:["data"],properties:{data:{$ref:"/zerooneArray"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/io",basePath:"io0",anyOf:[{$ref:"/response/io/get"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/io/get",type:"boolean"}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response",type:"array",minItems:1,items:{type:"object",additionalProperties:!1,patternProperties:{"^io[0-9]$":{$ref:"/response/io"},"^io1[0-1]$":{$ref:"/response/io"},"^ad[0-9]$":{$ref:"/response/ad"},"^ad1[0-1]$":{$ref:"/response/ad"},"^uart[0-1]$":{$ref:"/response/uart"},"^spi[0-1]$":{$ref:"/response/spi"},"^i2c0$":{$ref:"/response/i2c"}},properties:{switch:{$ref:"/response/switch"},ble:{$ref:"/response/ble"},measure:{$ref:"/response/measure"},message:{$ref:"/response/message"},logic_analyzer:{$ref:"/response/logicAnalyzer"},system:{$ref:"/response/system"},debug:{$ref:"/response/debug"},ws:{$ref:"/response/ws"}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/i2c/slave",type:"object",required:["mode","address","is_fragmented","data"],properties:{mode:{type:"string",enum:["slave"]},address:{type:"integer",minimum:0,maximum:1023},is_fragmented:{type:"boolean"},data:{$ref:"/dataArray"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/i2c/master",type:"object",required:["mode","address","data"],properties:{mode:{type:"string",enum:["master"]},address:{type:"integer",minimum:0,maximum:1023},data:{$ref:"/dataArray"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/i2c",basePath:"i2c0",anyOf:[{$ref:"/response/i2c/master"},{$ref:"/response/i2c/slave"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/debug/warning",desccription:"global warnings",type:"object",required:["warning"],properties:{warning:{type:"object",additionalProperties:!0,properties:{message:{description:"readable message",type:"string",example:"unknown command"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/debug",basePath:"debug",anyOf:[{$ref:"/response/debug/warning"},{$ref:"/response/debug/error"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/debug/error",desccription:"global error",type:"object",required:["error"],properties:{error:{type:"object",additionalProperties:!0,properties:{message:{description:"readable message",type:"string",example:"voltage down"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/peripheral/status",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",additionalProperties:!1,required:["connection_status"],properties:{connection_status:{type:"object",required:["address","status"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},status:{type:"string",enum:["connected","disconnected"]}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/peripheral",basePath:"ble",anyOf:[{$ref:"/response/ble/peripheral/status"},{$ref:"/response/ble/peripheral/characteristic_read"},{$ref:"/response/ble/peripheral/characteristic_write"},{$ref:"/response/ble/peripheral/characteristic_notify_read"},{$ref:"/response/ble/peripheral/characteristic_notify_write"},{$ref:"/response/ble/peripheral/descriptor_read"},{$ref:"/response/ble/peripheral/descriptor_write"},{$ref:"/response/ble/peripheral/descriptor_notify_read"},{$ref:"/response/ble/peripheral/descriptor_notify_write"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/peripheral/descriptor_write",description:"callback of write descriptor",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",additionalProperties:!1,required:["write_descriptor_result"],properties:{write_descriptor_result:{type:"object",required:["service_uuid","characteristic_uuid","descriptor_uuid","result"],additionalProperties:!1,properties:{service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},descriptor_uuid:{$ref:"/uuid"},result:{type:"string",enum:["success","failed"]}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/peripheral/descriptor_read",description:"callback of read descriptor",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",additionalProperties:!1,required:["read_descriptor_result"],properties:{read_descriptor_result:{type:"object",required:["service_uuid","characteristic_uuid","descriptor_uuid","data"],additionalProperties:!1,properties:{service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},descriptor_uuid:{$ref:"/uuid"},data:{$ref:"/dataArray"}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/peripheral/descriptor_notify_write",description:"callback of external device write descriptor",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",additionalProperties:!1,required:["notify_write_descriptor"],properties:{notify_write_descriptor:{type:"object",required:["address","service_uuid","characteristic_uuid","descriptor_uuid","data"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},descriptor_uuid:{$ref:"/uuid"},data:{$ref:"/dataArray"}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/peripheral/descriptor_notify_read",description:"callback of external device read descriptor",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",additionalProperties:!1,required:["notify_read_descriptor"],properties:{notify_read_descriptor:{type:"object",required:["address","service_uuid","characteristic_uuid","descriptor_uuid"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},descriptor_uuid:{$ref:"/uuid"}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/peripheral/characteristic_write",description:"callback of write characteristic",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",additionalProperties:!1,required:["write_characteristic_result"],properties:{write_characteristic_result:{type:"object",required:["service_uuid","characteristic_uuid","result"],additionalProperties:!1,properties:{service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},result:{type:"string",enum:["success","failed"]}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/peripheral/characteristic_read",description:"callback of read characteristic",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",additionalProperties:!1,required:["read_characteristic_result"],properties:{read_characteristic_result:{type:"object",required:["service_uuid","characteristic_uuid","data"],additionalProperties:!1,properties:{service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},data:{$ref:"/dataArray"}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/peripheral/characteristic_notify_write",description:"callback of external device write characteristic",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",additionalProperties:!1,required:["notify_write_characteristic"],properties:{notify_write_characteristic:{type:"object",required:["address","service_uuid","characteristic_uuid","data"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},data:{$ref:"/dataArray"}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/peripheral/characteristic_notify_read",description:"callback of external device read characteristic",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",additionalProperties:!1,required:["notify_read_characteristic"],properties:{notify_read_characteristic:{type:"object",required:["address","service_uuid","characteristic_uuid"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble",basePath:"ble",anyOf:[{$ref:"/response/ble/central"},{$ref:"/response/ble/peripheral"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/status_update",type:"object",required:["status_update"],properties:{status_update:{type:"object",required:["address","status"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},status:{type:"string",enum:["connected","disconnected"]}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/service_get_finish",type:"object",required:["get_service_result_finish"],properties:{get_service_result_finish:{type:"object",required:["address"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/service_get",type:"object",required:["get_service_result"],properties:{get_service_result:{type:"object",required:["address","service_uuid"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/scan_finish",type:"object",required:["scan_result_finish"],properties:{scan_result_finish:{type:"boolean",enum:[!0]}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/scan",type:"object",required:["scan_result"],properties:{scan_result:{type:"object",required:["address","ble_event_type","device_type","address_type","flag","rssi"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},ble_event_type:{type:"string",enum:["connectable_advertisemnt","connectable_directed_advertisemnt","scannable_advertising","non_connectable_advertising","scan_response"]},device_type:{type:"string",enum:["ble","dumo","breder"]},address_type:{type:"string",enum:["public","random","rpa_public","rpa_random"]},flag:{type:"integer",minimum:0},rssi:{type:"integer",maximum:0},adv_data:{$ref:"/bleAdvertiseData"},scan_resp:{$ref:"/bleAdvertiseData"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central",basePath:"ble",anyOf:[{$ref:"/response/ble/central/scan"},{$ref:"/response/ble/central/scan_finish"},{$ref:"/response/ble/central/status_update"},{$ref:"/response/ble/central/service_get"},{$ref:"/response/ble/central/service_get_finish"},{$ref:"/response/ble/central/characteristic_get"},{$ref:"/response/ble/central/characteristic_get_finish"},{$ref:"/response/ble/central/characteristic_write"},{$ref:"/response/ble/central/characteristic_read"},{$ref:"/response/ble/central/characteristic_register_notify"},{$ref:"/response/ble/central/characteristic_notify"},{$ref:"/response/ble/central/characteristic_notify"},{$ref:"/response/ble/central/descriptor_get"},{$ref:"/response/ble/central/descriptor_get_finish"},{$ref:"/response/ble/central/descriptor_write"},{$ref:"/response/ble/central/descriptor_read"},{$ref:"/response/ble/central/error"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/error",type:"object",required:["error"],properties:{error:{type:"object",required:["error_code","message"],additionalProperties:!1,properties:{error_code:{type:"integer",example:0},message:{type:"string",example:"ERROR MESSAGE"},address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuidOrNull"},characteristic_uuid:{$ref:"/uuidOrNull"},descriptor_uuid:{$ref:"/uuidOrNull"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/descriptor_write",type:"object",required:["write_descriptor_result"],properties:{write_descriptor_results:{type:"object",required:["address","service_uuid","characteristic_uuid","descriptor_uuid","result"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},descriptor_uuid:{$ref:"/uuid"},result:{type:"string",enum:["success","failed"]}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/descriptor_read",type:"object",required:["read_descriptor_result"],properties:{read_descriptor_results:{type:"object",required:["address","service_uuid","characteristic_uuid","descriptor_uuid","result","data"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},descriptor_uuid:{$ref:"/uuid"},result:{type:"string",enum:["success","failed"]},data:{$ref:"/dataArray"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/descriptor_get_finish",type:"object",required:["get_descriptor_result_finish"],properties:{get_descriptor_result_finish:{type:"object",required:["address","service_uuid","characteristic_uuid"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/descriptor_get",type:"object",required:["get_descriptor_result"],properties:{get_descriptor_result:{type:"object",required:["address","service_uuid","characteristic_uuid","descriptor_uuid"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},descriptor_uuid:{$ref:"/uuid"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/characteristic_write",type:"object",required:["write_characteristic_result"],properties:{write_characteristic_result:{type:"object",required:["address","service_uuid","characteristic_uuid","result"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},result:{type:"string",enum:["success","failed"]}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/characteristic_unregister_notify",related:"/request/ble/central/characteristic_unregister_notify",type:"object",required:["unregister_notify_characteristic_result"],properties:{unregister_notify_characteristic_result:{type:"object",required:["address","service_uuid","characteristic_uuid","result"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},result:{type:"boolean"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/characteristic_register_notify",related:"/request/ble/central/characteristic_register_notify",type:"object",required:["characteristic_register_notify_result"],properties:{characteristic_register_notify_result:{type:"object",required:["address","service_uuid","characteristic_uuid","result"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},result:{type:"boolean"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/characteristic_read",type:"object",required:["read_characteristic_result"],properties:{read_characteristic_result:{type:"object",required:["address","service_uuid","characteristic_uuid","result","data"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},result:{type:"string",enum:["success","failed"]},data:{$ref:"/dataArray"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/characteristic_notify",type:"object",required:["nofity_characteristic"],properties:{nofity_characteristic:{type:"object",required:["address","service_uuid","characteristic_uuid","data"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},data:{$ref:"/dataArray"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/characteristic_get_finish",type:"object",required:["get_characteristic_result_finish"],properties:{get_characteristic_result_finish:{type:"object",required:["address","service_uuid"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ble/central/characteristic_get",type:"object",required:["get_characteristic_result"],properties:{get_characteristic_result:{type:"object",required:["address","service_uuid","characteristic_uuid","properties"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},properties:{type:"array",items:{type:"string",enum:["broadcast","read","write_without_response","write","notify","indicate","auth","extended_properties"]}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ad",basePath:"ad0",anyOf:[{$ref:"/response/ad/get"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/response/ad/get",type:"number",example:3.3,minimum:0,maximum:5,description:"current value (volt)"}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ws/reset_obniz_on_ws_disconnection",type:"object",required:["reset_obniz_on_ws_disconnection"],properties:{reset_obniz_on_ws_disconnection:{type:"boolean",default:!1}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ws",basePath:"ws",anyOf:[{$ref:"/request/ws/reset_obniz_on_ws_disconnection"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/uart/send",type:"object",required:["data"],properties:{data:{$ref:"/dataArray"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/uart/init",description:"available 0 to 1",type:"object",required:["rx","tx"],uniqueKeys:["rx","tx","rts","cts"],properties:{rx:{$ref:"/pinSetting"},tx:{$ref:"/pinSetting"},baud:{type:"integer",default:115200,minimum:1,maximum:5e6,description:"baud rate (bps)"},stop:{type:"number",enum:[1,1.5,2],default:1,description:"stop bit width"},bits:{type:"integer",enum:[5,6,7,8],default:8},parity:{type:"string",enum:["off","odd","even"],default:"off"},flowcontrol:{type:"string",enum:["off","rts","cts","rts-cts"],default:"off"},rts:{$ref:"/pinSetting"},cts:{$ref:"/pinSetting"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/uart",basePath:"uart0",anyOf:[{$ref:"/request/uart/init"},{$ref:"/request/uart/send"},{$ref:"/request/uart/deinit"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/uart/deinit",type:"null"}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/system/wait",type:"object",required:["wait"],properties:{wait:{type:"integer",description:"wait time (ms)"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/system/selfCheck",description:"circuit IO check",type:"object",required:["self_check"],properties:{self_check:{type:"boolean",enum:[!0]}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/system/reset",type:"object",required:["reset"],properties:{reset:{type:"boolean",enum:[!0]}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/system/reboot",type:"object",required:["reboot"],properties:{reboot:{type:"boolean",enum:[!0]}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/system/ping",response:"/response/system/pong",type:"object",required:["ping"],properties:{ping:{type:"object",required:["key"],properties:{key:{$ref:"/dataArray"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/system/keepWorkingAtOffline",description:"reset obniz when obniz gone to offline.",type:"object",required:["keep_working_at_offline"],properties:{keep_working_at_offline:{type:"boolean"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/system",basePath:"system",anyOf:[{$ref:"/request/system/wait"},{$ref:"/request/system/reset"},{$ref:"/request/system/reboot"},{$ref:"/request/system/selfCheck"},{$ref:"/request/system/keepWorkingAtOffline"},{$ref:"/request/system/ping"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/switch",basePath:"switch",description:"the switch embed on obniz itself. If it's state is changed, notification will be fired.",anyOf:[{$ref:"/request/switch/get"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/switch/get",related:"/response/switch/change",type:"string",enum:["get"]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/spi/write",related:"/response/spi/read",type:"object",required:["data","read"],properties:{data:{$ref:"/dataArray32"},read:{type:"boolean",default:!0,description:"If false, write without receive"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/spi/init_master",description:"clk, miso, mosi are optional, but at least one are required",type:"object",required:["mode","clock"],uniqueKeys:["mosi","miso","clk"],properties:{mode:{type:"string",enum:["master"]},clk:{$ref:"/pinSetting"},mosi:{$ref:"/pinSetting"},miso:{$ref:"/pinSetting"},clock:{type:"integer",default:115200,minimum:1,maximum:26e6,desription:"frequency (Hz)"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/spi",basePath:"spi0",description:"available spi0, spi1",anyOf:[{$ref:"/request/spi/init_master"},{$ref:"/request/spi/deinit"},{$ref:"/request/spi/write"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/spi/deinit",type:"null"}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/pwm/pulse",type:"object",required:["pulse"],properties:{pulse:{type:"number",minimum:0,description:"pulse width (ms)"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/pwm/modulate",type:"object",required:["modulate"],properties:{modulate:{type:"object",required:["type","symbol_length","data"],additionalProperties:!1,properties:{type:{type:"string",enum:["am"]},symbol_length:{type:"number",minimum:.05,maximum:1e3,description:"symbol width (ms)"},data:{$ref:"/zerooneArray"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/pwm/init",type:"object",required:["io"],properties:{io:{$ref:"/pinSetting"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/pwm",basePath:"pwm0",description:"available 0 to 5",anyOf:[{$ref:"/request/pwm/init"},{$ref:"/request/pwm/freq"},{$ref:"/request/pwm/pulse"},{$ref:"/request/pwm/modulate"},{$ref:"/request/pwm/deinit"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/pwm/freq",type:"object",required:["freq"],properties:{freq:{type:"integer",description:"frequency (Hz)",minimum:1,maximum:8e7}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/pwm/deinit",type:"null"}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/message/send",related:"/response/message/receive",type:"object",additionalProperties:!1,required:["data","to"],properties:{data:{example:"button pressed",description:"All type of data is pass."},to:{type:"array",minItems:1,items:{$ref:"/obnizId"}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/message",basePath:"message",description:"send/receive with other obniz or webhook",anyOf:[{$ref:"/request/message/send"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/measure",basePath:"measure",anyOf:[{$ref:"/request/measure/echo"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/measure/echo",description:"It measures pulse response.",related:"/response/measure/echo",type:"object",required:["echo"],properties:{echo:{type:"object",required:["io_pulse","io_echo","pulse_width"],properties:{io_pulse:{$ref:"/pinSetting"},io_echo:{$ref:"/pinSetting"},pulse:{type:"string",default:"positive",enum:["positive","negative"]},pulse_width:{type:"number",minimum:.001,maximum:1e3},measure_edges:{type:"integer",minimum:1,maximum:4},timeout:{type:"number",default:1e3,minimum:.001,maximum:1e3}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/logicAnalyzer/init",exampleDescription:"With below sample code, you will receive only datas which start with 'false, false, false' 3bit.",type:"object",required:["io","interval","duration"],properties:{io:{type:"array",minItems:1,maxItems:1,items:{$ref:"/pinSetting"}},interval:{type:"number",minimum:0,exclusiveMinimum:!0},duration:{type:"integer",minimum:0,exclusiveMinimum:!0},triger:{type:"object",description:"Without this, logicanalyzer will start with any io level changes. trigger specify start position. ",additionalProperties:!1,required:["value","samples"],default:{value:!1,samples:0},properties:{value:{description:"start value",type:"boolean",default:!1},samples:{type:"integer",description:"how that values consists",minimum:0,default:0,example:3}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/logicAnalyzer",basePath:"logic_analyzer",description:"Monitor io logic level changes by sampling io.",anyOf:[{$ref:"/request/logicAnalyzer/init"},{$ref:"/request/logicAnalyzer/deinit"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/logicAnalyzer/deinit",type:"null"}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ioAnimation/init",commandExample:{io:{animation:{animation:{name:"anim-1",status:"loop",states:[{duration:500,state:{io0:!0}},{duration:500,state:{io0:!1}}]}}}},type:"object",required:["animation"],properties:{animation:{type:"object",required:["name","status","states"],additionalProperties:!1,properties:{name:{type:"string",description:"Animation name to use pause/resume",example:"anim-1",minLength:1,maxLength:254},status:{type:"string",default:"loop",enum:["loop"]},states:{type:"array",default:[],items:{type:"object",required:["duration","state"],additionalProperties:!1,properties:{duration:{type:"integer",description:"State duration time(ms)",minimum:0,maximum:6e4,example:500},state:{type:"object",description:"io/pwm commands.",filter:"pass_all",example:[{io0:!0},{io0:!1}]}}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ioAnimation",basePath:"io.animation",description:"io animation is hardware acceleration for serial sequence change of io. now 'loop' animation is avaiable. it loop io changes regarding json array.",anyOf:[{$ref:"/request/ioAnimation/init"},{$ref:"/request/ioAnimation/changeState"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ioAnimation/changeState",type:"object",required:["animation"],properties:{animation:{type:"object",required:["name","status"],additionalProperties:!1,properties:{name:{type:"string",example:"anim-1",minLength:1,maxLength:254},status:{type:"string",enum:["pause","resume"]}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/io/pull_type",type:"object",required:["pull_type"],properties:{pull_type:{type:"string",enum:["pull-up5v","pull-up3v","pull-down","float"]}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/io/output_type",type:"object",required:["output_type"],properties:{output_type:{type:"string",enum:["push-pull5v","push-pull3v","open-drain"],description:"drive type"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/io/output_detail",type:"object",required:["direction","value"],properties:{direction:{type:"string",enum:["output"]},value:{type:"boolean"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/io/output",type:"boolean"}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/io/input_detail",related:"/response/io/get",type:"object",required:["direction"],properties:{direction:{type:"string",enum:["input"]},stream:{type:"boolean",default:!1,description:"enable stream callback when value change"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/io/input",related:"/response/io/get",type:"string",enum:["get"]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/io",basePath:"io0",description:"General purpose IO available on each io (io0 to io11).",anyOf:[{$ref:"/request/io/input"},{$ref:"/request/io/input_detail"},{$ref:"/request/io/output"},{$ref:"/request/io/output_detail"},{$ref:"/request/io/output_type"},{$ref:"/request/io/pull_type"},{$ref:"/request/io/deinit"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/io/deinit",type:"null"}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request",type:"array",minItems:1,items:{type:"object",additionalProperties:!1,patternProperties:{"^io[0-9]$":{$ref:"/request/io"},"^io1[0-1]$":{$ref:"/request/io"},"^ad[0-9]$":{$ref:"/request/ad"},"^ad1[0-1]$":{$ref:"/request/ad"},"^pwm[0-5]$":{$ref:"/request/pwm"},"^uart[0-1]$":{$ref:"/request/uart"},"^spi[0-1]$":{$ref:"/request/spi"},"^i2c0$":{$ref:"/request/i2c"}},properties:{io:{$ref:"/request/ioAnimation"},ble:{$ref:"/request/ble"},switch:{$ref:"/request/switch"},display:{$ref:"/request/display"},measure:{$ref:"/request/measure"},message:{$ref:"/request/message"},logic_analyzer:{$ref:"/request/logicAnalyzer"},system:{$ref:"/request/system"},ws:{$ref:"/request/ws"}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/i2c/write",description:"if address over 0b01111111; then address treated as 10bit address automatically. or specify address_bits: 10 to force 10bit address mode.",type:"object",required:["address","data"],properties:{address:{type:"integer",minimum:0,maximum:1023},address_bits:{type:"integer",enum:[7],default:7},data:{$ref:"/dataArray1024"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/i2c/read",description:"if address over 0b01111111; then address treated as 10bit address automatically. or specify address_bits: 10 to force 10bit address mode.",related:"/response/i2c/master",type:"object",required:["address","read"],properties:{address:{type:"integer",minimum:0,maximum:1023},address_bits:{type:"integer",enum:[7],default:7},read:{type:"integer",minimum:0,maximum:1024}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/i2c/init_slave",related:"/response/i2c/slave",type:"object",required:["mode","sda","scl","slave_address"],uniqueKeys:["sda","scl"],properties:{mode:{type:"string",enum:["master","slave"]},sda:{$ref:"/pinSetting"},scl:{$ref:"/pinSetting"},slave_address:{type:"integer",minimum:0,maximum:1023},slave_address_length:{type:"integer",enum:[7],default:7},address:{type:"integer",minimum:0,maximum:1023},address_bits:{type:"integer",enum:[7],default:7},data:{$ref:"/dataArray"},read:{type:"integer",minimum:0}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/i2c/init_master",description:"internal pullup is available. But, We recommend use external pull-up resistor.",type:"object",required:["mode","sda","scl","clock"],uniqueKeys:["sda","scl"],properties:{mode:{type:"string",enum:["master"]},sda:{$ref:"/pinSetting"},scl:{$ref:"/pinSetting"},clock:{type:"integer",description:"frequency (Hz)",minimum:1,maximum:1e6}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/i2c",basePath:"i2c0",description:"available only i2c0",anyOf:[{$ref:"/request/i2c/init_master"},{$ref:"/request/i2c/init_slave"},{$ref:"/request/i2c/write"},{$ref:"/request/i2c/read"},{$ref:"/request/i2c/deinit"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/i2c/deinit",type:"null"}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/display/text",type:"object",required:["text"],properties:{text:{type:"string",example:"Hello, obniz!"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/display/raw",description:"1 bit represents 1 dot. 1=white, 0=black. 1 byte is part of one line. Order is same like.<br/> {1byte} {2byte} {3byte}...{16byte}<br/> {17byte} {18byte} {19byte}...<br/> .....<br/> .....................{1024byte}",type:"object",required:["raw"],properties:{raw:{$ref:"/imageData128x64"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/display/qr",type:"object",required:["qr"],properties:{qr:{type:"object",required:["text"],additionalProperties:!1,properties:{text:{type:"string",example:"Hello, obniz!"},correction:{type:"string",enum:["L","M","Q","H"],default:"M"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/display/pin_assign",type:"object",required:["pin_assign"],properties:{pin_assign:{type:"object",minProperties:1,patternExample:[0,1,2,3],patternProperties:{"^[0-9]$":{type:"object",properties:{module_name:{type:"string",example:"io"},pin_name:{type:"string",example:"output"}}},"^1[0-1]$":{type:"object",properties:{module_name:{type:"string",example:"io"},pin_name:{type:"string",example:"output"}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/display",basePath:"display",anyOf:[{$ref:"/request/display/text"},{$ref:"/request/display/clear"},{$ref:"/request/display/qr"},{$ref:"/request/display/raw"},{$ref:"/request/display/pin_assign"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/display/clear",type:"object",required:["clear"],properties:{clear:{type:"boolean",enum:[!0]}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/peripheral/service_stop_all",type:"object",required:["peripheral"],properties:{peripheral:{type:"null"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/peripheral/service_stop",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",required:["stop_service"],properties:{stop_service:{type:"object",required:["service_uuid"],additionalProperties:!1,properties:{service_uuid:{$ref:"/uuid"}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/peripheral/service_start",related:["/response/ble/peripheral/status","/response/ble/peripheral/characteristic_notify_read","/response/ble/peripheral/characteristic_notify_write","/response/ble/peripheral/descriptor_notify_read","/response/ble/peripheral/descriptor_notify_write"],description:"callback of external device connected",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",required:["services"],properties:{services:{type:"array",minItems:1,items:{type:"object",required:["uuid"],additionalProperties:!1,properties:{uuid:{$ref:"/uuid"},characteristics:{type:"array",minItems:0,items:{type:"object",required:["uuid"],additionalProperties:!1,properties:{uuid:{$ref:"/uuid"},data:{$ref:"/dataArray"},properties:{type:"array",default:["read","write"],items:{type:"string",enum:["broadcast","read","write_without_response","write","notify","indicate","auth","extended_properties"]}},permissions:{type:"array",default:["read","write"],items:{default:["read","write"],type:"string",enum:["read","write"]}},descriptors:{type:"array",minItems:0,items:{type:"object",required:["uuid"],additionalProperties:!1,properties:{uuid:{$ref:"/uuid"},data:{$ref:"/dataArray"},permissions:{type:"array",default:["read","write"],items:{default:["read","write"],type:"string",enum:["read","write"]}}}}}}}}}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/peripheral",basePath:"ble",description:"use obniz as peripheral",anyOf:[{$ref:"/request/ble/peripheral/advertisement_start"},{$ref:"/request/ble/peripheral/advertisement_stop"},{$ref:"/request/ble/peripheral/service_start"},{$ref:"/request/ble/peripheral/service_stop"},{$ref:"/request/ble/peripheral/service_stop_all"},{$ref:"/request/ble/peripheral/characteristic_read"},{$ref:"/request/ble/peripheral/characteristic_write"},{$ref:"/request/ble/peripheral/descriptor_read"},{$ref:"/request/ble/peripheral/descriptor_write"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/peripheral/descriptor_write",related:"/response/ble/peripheral/descriptor_write",description:"write descriptor on own service",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",required:["write_descriptor"],properties:{write_descriptor:{type:"object",required:["service_uuid","characteristic_uuid","descriptor_uuid","data"],additionalProperties:!1,properties:{service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},descriptor_uuid:{$ref:"/uuid"},data:{$ref:"/dataArray"}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/peripheral/descriptor_read",related:"/response/ble/peripheral/descriptor_read",description:"read descriptor on own service",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",required:["read_descriptor"],properties:{read_descriptor:{type:"object",required:["service_uuid","characteristic_uuid"],additionalProperties:!1,properties:{service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},descriptor_uuid:{$ref:"/uuid"}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/peripheral/characteristic_write",description:"write characteristic on own service",related:"/response/ble/peripheral/characteristic_write",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",required:["write_characteristic"],properties:{write_characteristic:{type:"object",required:["service_uuid","characteristic_uuid","data"],additionalProperties:!1,properties:{service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},data:{$ref:"/dataArray"}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/peripheral/characteristic_read",description:"read characteristic on own service",related:"/response/ble/peripheral/characteristic_read",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",required:["read_characteristic"],properties:{read_characteristic:{type:"object",required:["service_uuid","characteristic_uuid"],additionalProperties:!1,properties:{service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/peripheral/characteristic_notify",description:"notify characteristic for connected device",type:"object",required:["peripheral"],properties:{peripheral:{type:"object",required:["notify_characteristic"],properties:{notify_characteristic:{type:"object",required:["service_uuid","characteristic_uuid"],additionalProperties:!1,properties:{service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/peripheral/advertisement_stop",type:"object",required:["advertisement"],properties:{advertisement:{type:"null"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/peripheral/advertisement_start",related:"/response/ble/peripheral/status",type:"object",required:["advertisement"],properties:{advertisement:{type:"object",required:["adv_data"],additionalProperties:!1,properties:{adv_data:{$ref:"/bleAdvertiseData"},scan_resp:{$ref:"/bleAdvertiseData"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble",basePath:"ble",anyOf:[{$ref:"/request/ble/peripheral"},{$ref:"/request/ble/central"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/central/service_get",related:"/response/ble/central/service_get",type:"object",required:["get_services"],properties:{get_services:{type:"object",required:["address"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/central/scan_stop",type:"object",required:["scan"],properties:{scan:{type:"null"}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/central/scan_start",related:["/response/ble/central/scan","/response/ble/central/scan_finish"],type:"object",required:["scan"],properties:{scan:{type:"object",additionalProperties:!1,properties:{duration:{type:"integer",default:30}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/central",basePath:"ble",description:"use obniz as central",anyOf:[{$ref:"/request/ble/central/scan_start"},{$ref:"/request/ble/central/scan_stop"},{$ref:"/request/ble/central/connect"},{$ref:"/request/ble/central/disconnect"},{$ref:"/request/ble/central/service_get"},{$ref:"/request/ble/central/characteristic_get"},{$ref:"/request/ble/central/characteristic_read"},{$ref:"/request/ble/central/characteristic_write"},{$ref:"/request/ble/central/characteristic_register_notify"},{$ref:"/request/ble/central/characteristic_unregister_notify"},{$ref:"/request/ble/central/descriptor_get"},{$ref:"/request/ble/central/descriptor_read"},{$ref:"/request/ble/central/descriptor_write"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/central/disconnect",type:"object",required:["disconnect"],properties:{disconnect:{type:"object",required:["address"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/central/descriptor_write",related:"/response/ble/central/descriptor_write",type:"object",required:["write_descriptor"],properties:{write_descriptor:{type:"object",required:["address","service_uuid","characteristic_uuid","descriptor_uuid","data"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},descriptor_uuid:{$ref:"/uuid"},data:{$ref:"/dataArray"},needResponse:{type:"boolean",default:!0}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/central/descriptor_read",related:"/response/ble/central/descriptor_read",type:"object",required:["read_descriptor"],properties:{read_descriptor:{type:"object",required:["address","service_uuid","characteristic_uuid","descriptor_uuid"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},descriptor_uuid:{$ref:"/uuid"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/central/descriptor_get",related:"/response/ble/central/descriptor_get",type:"object",required:["get_descriptors"],properties:{get_descriptors:{type:"object",required:["address","service_uuid","characteristic_uuid"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/central/connect",related:"/response/ble/central/status_update",type:"object",required:["connect"],properties:{connect:{type:"object",required:["address"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/central/characteristic_write",related:"/response/ble/central/characteristic_write",type:"object",required:["write_characteristic"],properties:{write_characteristic:{type:"object",required:["address","service_uuid","characteristic_uuid","data"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"},data:{$ref:"/dataArray"},needResponse:{type:"boolean",default:!0}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/central/characteristic_unregister_notify",related:"/response/ble/central/characteristic_unregister_notify",type:"object",required:["unregister_notify_characteristic"],properties:{unregister_notify_characteristic:{type:"object",required:["address","service_uuid","characteristic_uuid"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/central/characteristic_register_notify",related:"/response/ble/central/characteristic_register_notify",type:"object",required:["register_notify_characteristic"],properties:{register_notify_characteristic:{type:"object",required:["address","service_uuid","characteristic_uuid"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/central/characteristic_read",related:"/response/ble/central/characteristic_read",type:"object",required:["read_characteristic"],properties:{read_characteristic:{type:"object",required:["address","service_uuid","characteristic_uuid"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"},characteristic_uuid:{$ref:"/uuid"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ble/central/characteristic_get",related:"/response/ble/central/characteristic_get",type:"object",required:["get_characteristics"],properties:{get_characteristics:{type:"object",required:["address","service_uuid"],additionalProperties:!1,properties:{address:{$ref:"/deviceAddress"},service_uuid:{$ref:"/uuid"}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ad/get",related:"/response/ad/get",desription:"enable & start ad module at io.",type:"object",required:["stream"],properties:{stream:{type:"boolean",default:!1,description:"true to continuous notifying on voltage change."}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ad",basePath:"ad0",description:"available ad0~ad11",anyOf:[{$ref:"/request/ad/get"},{$ref:"/request/ad/deinit"}]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/request/ad/deinit",type:"null"}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",id:"/",definitions:{pinSetting:{id:"pinSetting",type:"integer",minimum:0,maximum:11,default:null,example:[0,1,2,3,4,5,6]},bleAdvertiseData:{id:"bleAdvertiseData",type:"array",default:null,maxItems:31,example:[[2,1,26,7,9,83,97,109,112,108,101],[7,9,83,97,109,112,108,101]],items:{type:"integer",minimum:0,maximum:255}},dataArray32:{id:"dataArray32",type:"array",default:null,maxItems:32,example:[[100,255,21,0,21]],items:{type:"integer",minimum:0,maximum:255}},dataArray1024:{id:"dataArray1024",type:"array",default:null,maxItems:1024,example:[[100,255,21,0,21]],items:{type:"integer",minimum:0,maximum:255}},zerooneArray:{id:"zerooneArray",type:"array",default:null,description:"Binary data array represented in 0 1.",example:[[0,1,1,0,0,1,1,0],[0,0,1,0,0,0,0,0]],items:{type:"integer",minimum:0,maximum:1}},dataArray:{id:"dataArray",type:"array",default:null,description:"Binary data array.",example:[[16,34,242],[100,255,21,0,21]],items:{type:"integer",minimum:0,maximum:255}},imageData128x64:{id:"imageData128x64",type:"array",description:"Image data bit array.",minItems:1024,maxItems:1024,example:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0,0,0,0,0,0,255,240,56,0,0,0,0,0,0,0,0,0,0,0,0,7,255,224,120,0,0,0,0,0,0,0,0,0,0,0,0,63,255,192,240,0,0,0,0,0,0,0,0,0,0,0,0,127,255,129,248,0,0,0,0,0,0,0,0,0,0,0,1,255,255,3,254,0,0,0,0,0,0,0,0,0,0,0,3,255,254,7,255,0,0,0,0,0,0,0,0,0,0,0,15,255,252,15,255,128,0,0,0,0,0,0,0,0,0,0,31,255,248,31,255,192,0,0,0,0,0,0,0,0,0,0,63,255,240,63,255,224,0,0,0,0,0,0,0,0,0,0,63,255,224,127,255,240,0,0,0,0,0,0,0,0,0,0,127,255,192,255,255,248,0,0,0,0,0,0,0,0,0,0,255,255,129,255,255,252,0,0,0,0,0,0,0,0,0,1,255,255,3,255,255,254,0,0,0,0,0,0,0,0,0,1,255,254,7,255,255,254,0,0,0,0,0,0,0,0,0,3,255,252,15,255,255,255,0,0,0,0,0,0,0,0,0,7,255,248,31,255,255,255,0,0,0,0,0,0,0,0,0,7,255,240,63,255,255,255,128,0,0,0,0,0,0,0,0,7,255,224,127,193,255,255,128,0,0,0,0,0,0,0,0,15,252,64,255,128,255,255,128,0,0,0,0,0,0,0,0,15,240,1,255,0,127,255,0,0,0,0,0,0,0,0,0,15,224,3,254,0,127,254,14,0,0,0,0,0,0,0,0,31,224,7,254,0,63,252,30,0,0,0,0,0,0,0,0,31,224,7,254,0,63,248,60,0,0,0,0,0,0,0,0,31,192,7,254,0,63,240,120,0,0,0,0,0,0,0,0,31,192,7,254,0,127,224,240,0,0,0,0,0,0,0,0,31,224,7,252,0,127,193,224,0,0,0,0,0,0,0,0,31,224,15,248,0,255,131,224,0,0,0,0,0,0,0,0,31,240,31,240,39,255,7,224,0,0,0,0,0,0,0,0,31,252,63,224,127,254,15,224,0,0,0,0,0,0,0,0,31,255,255,192,255,252,31,224,0,0,0,0,0,0,0,0,31,255,255,129,255,248,63,224,0,0,0,0,0,0,0,0,31,255,255,3,255,240,127,224,0,0,0,0,0,0,0,0,31,255,254,7,255,224,255,224,0,0,0,0,0,0,0,0,31,255,252,15,255,193,255,192,0,0,0,0,0,0,0,0,15,255,248,31,255,131,255,192,0,0,0,0,0,0,0,0,15,255,240,63,255,7,255,192,0,0,0,0,0,0,0,0,15,255,224,127,254,15,255,192,0,0,0,0,0,0,0,0,15,255,192,255,252,31,255,128,0,0,0,0,0,0,0,0,7,255,129,255,0,63,255,128,0,0,0,0,0,0,0,0,7,255,3,254,0,127,255,0,0,0,0,0,0,0,0,0,3,254,7,252,0,255,255,0,0,0,0,0,0,0,0,0,3,252,15,252,0,255,254,0,0,0,0,0,0,0,0,0,1,248,31,252,0,255,254,0,0,0,0,0,0,0,0,0,0,240,63,252,0,255,252,0,0,0,0,0,0,0,0,0,0,224,127,252,0,255,252,0,0,0,0,0,0,0,0,0,0,64,255,252,0,255,248,0,0,0,0,0,0,0,0,0,0,1,255,254,1,255,240,0,0,0,0,0,0,0,0,0,0,3,255,255,3,255,224,0,0,0,0,0,0,0,0,0,0,7,255,255,255,255,192,0,0,0,0,0,0,0,0,0,0,15,255,255,255,255,128,0,0,0,0,0,0,0,0,0,0,31,255,255,255,254,0,0,0,0,0,0,0,0,0,0,0,12,255,255,255,252,0,0,0,0,0,0,0,0,0,0,0,0,63,255,255,240,0,0,0,0,0,0,0,0,0,0,0,0,15,255,255,192,0,0,0,0,0,0,0,0,0,0,0,0,3,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,63,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],items:{type:"integer",minimum:0,maximum:255}},hexString:{id:"hexString",type:"string",default:null,pattern:"^([0-9a-fA-F]+)$",description:"Bluetooth device id.If it contain '-', it ignored.",example:"8d0fd8f9"},uuid:{id:"uuid",type:"string",pattern:"^([-0-9a-fA-F]+)$",minLength:4,maxLength:36,description:"Bluetooth uuid. If it contain '-', it ignored.",example:["e1cfb0d1-ae63-4d6f-b3b6-de2054f87e5e","8d3591bda71140fd8f9f00535fe57179","d822b53c","de44"]},uuidOrNull:{id:"uuidOrNull",type:["string","null"],pattern:"^([-0-9a-fA-F]+)$",minLength:4,maxLength:36,description:"Bluetooth uuid. If it contain '-', it ignored.",example:["e1cfb0d1-ae63-4d6f-b3b6-de2054f87e5e","8d3591bda71140fd8f9f00535fe57179","d822b53c","de44",null]},deviceAddress:{id:"deviceAddress",type:"string",pattern:"^([0-9a-fA-F]+)$",minLength:12,maxLength:12,description:"Bluetooth device id. It's hexString cannot cointain '0x' or '-'.",example:"77e754ab8591"},obnizId:{id:"obnizId",type:["string","integer"],pattern:"^[0-9]{4}-?[0-9]{4}$",minimum:0,maximum:99999999,description:"Obniz id. It can contain '-' or not.",example:["1234-5678",12345678]}}}},function(e,t,r){var i={"./index.yml":215,"./request/ad/deinit.yml":214,"./request/ad/index.yml":213,"./request/ad/input.yml":212,"./request/ble/central/characteristic_get.yml":211,"./request/ble/central/characteristic_read.yml":210,"./request/ble/central/characteristic_register_notify.yml":209,"./request/ble/central/characteristic_unregister_notify.yml":208,"./request/ble/central/characteristic_write.yml":207,"./request/ble/central/connect.yml":206,"./request/ble/central/descriptor_get.yml":205,"./request/ble/central/descriptor_read.yml":204,"./request/ble/central/descriptor_write.yml":203,"./request/ble/central/disconnect.yml":202,"./request/ble/central/index.yml":201,"./request/ble/central/scan_start.yml":200,"./request/ble/central/scan_stop.yml":199,"./request/ble/central/service_get.yml":198,"./request/ble/index.yml":197,"./request/ble/peripheral/advertisement_start.yml":196,"./request/ble/peripheral/advertisement_stop.yml":195,"./request/ble/peripheral/characteristic_notify.yml":194,"./request/ble/peripheral/characteristic_read.yml":193,"./request/ble/peripheral/characteristic_write.yml":192,"./request/ble/peripheral/descriptor_read.yml":191,"./request/ble/peripheral/descriptor_write.yml":190,"./request/ble/peripheral/index.yml":189,"./request/ble/peripheral/servie_start.yml":188,"./request/ble/peripheral/servie_stop.yml":187,"./request/ble/peripheral/servie_stop_all.yml":186,"./request/display/clear.yml":185,"./request/display/index.yml":184,"./request/display/pin_assign.yml":183,"./request/display/qr.yml":182,"./request/display/raw.yml":181,"./request/display/text.yml":180,"./request/i2c/deinit.yml":179,"./request/i2c/index.yml":178,"./request/i2c/init_master.yml":177,"./request/i2c/init_slave.yml":176,"./request/i2c/read.yml":175,"./request/i2c/write.yml":174,"./request/index.yml":173,"./request/io/deinit.yml":172,"./request/io/index.yml":171,"./request/io/input.yml":170,"./request/io/input_detail.yml":169,"./request/io/output.yml":168,"./request/io/output_detail.yml":167,"./request/io/output_type.yml":166,"./request/io/pull_type.yml":165,"./request/ioanimation/changeState.yml":164,"./request/ioanimation/index.yml":163,"./request/ioanimation/init.yml":162,"./request/logicanalyzer/deinit.yml":161,"./request/logicanalyzer/index.yml":160,"./request/logicanalyzer/init.yml":159,"./request/measure/echo.yml":158,"./request/measure/index.yml":157,"./request/message/index.yml":156,"./request/message/send.yml":155,"./request/pwm/deinit.yml":154,"./request/pwm/freq.yml":153,"./request/pwm/index.yml":152,"./request/pwm/init.yml":151,"./request/pwm/modulate.yml":150,"./request/pwm/pulse.yml":149,"./request/spi/deinit.yml":148,"./request/spi/index.yml":147,"./request/spi/init_master.yml":146,"./request/spi/write.yml":145,"./request/switch/get.yml":144,"./request/switch/index.yml":143,"./request/system/index.yml":142,"./request/system/keep_working_at_offline.yml":141,"./request/system/ping.yml":140,"./request/system/reboot.yml":139,"./request/system/reset.yml":138,"./request/system/self_check.yml":137,"./request/system/wait.yml":136,"./request/uart/deinit.yml":135,"./request/uart/index.yml":134,"./request/uart/init.yml":133,"./request/uart/send.yml":132,"./request/ws/index.yml":131,"./request/ws/reset_obniz_on_ws_disconnection.yml":130,"./response/ad/get.yml":129,"./response/ad/index.yml":128,"./response/ble/central/characteristic_get.yml":127,"./response/ble/central/characteristic_get_finish.yml":126,"./response/ble/central/characteristic_notify.yml":125,"./response/ble/central/characteristic_read.yml":124,"./response/ble/central/characteristic_register_notify.yml":123,"./response/ble/central/characteristic_unregister_notify.yml":122,"./response/ble/central/characteristic_write.yml":121,"./response/ble/central/descriptor_get.yml":120,"./response/ble/central/descriptor_get_finish.yml":119,"./response/ble/central/descriptor_read.yml":118,"./response/ble/central/descriptor_write.yml":117,"./response/ble/central/error.yml":116,"./response/ble/central/index.yml":115,"./response/ble/central/scan.yml":114,"./response/ble/central/scan_finish.yml":113,"./response/ble/central/service_get.yml":112,"./response/ble/central/service_get_finish.yml":111,"./response/ble/central/status_update.yml":110,"./response/ble/index.yml":109,"./response/ble/peripheral/characteristic_notify_read.yml":108,"./response/ble/peripheral/characteristic_notify_write.yml":107,"./response/ble/peripheral/characteristic_read.yml":106,"./response/ble/peripheral/characteristic_write.yml":105,"./response/ble/peripheral/descriptor_notify_read.yml":104,"./response/ble/peripheral/descriptor_notify_write.yml":103,"./response/ble/peripheral/descriptor_read.yml":102,"./response/ble/peripheral/descriptor_write.yml":101,"./response/ble/peripheral/index.yml":100,"./response/ble/peripheral/status.yml":99,"./response/debug/error.yml":98,"./response/debug/index.yml":97,"./response/debug/warning.yml":96,"./response/i2c/index.yml":95,"./response/i2c/master.yml":94,"./response/i2c/slave.yml":93,"./response/index.yml":92,"./response/io/get.yml":91,"./response/io/index.yml":90,"./response/logicanalyzer/data.yml":89,"./response/logicanalyzer/index.yml":88,"./response/measure/echo.yml":87,"./response/measure/index.yml":86,"./response/message/index.yml":85,"./response/message/receive.yml":84,"./response/spi/index.yml":83,"./response/spi/read.yml":82,"./response/switch/change.yml":81,"./response/switch/index.yml":80,"./response/system/index.yml":79,"./response/system/pong.yml":78,"./response/uart/index.yml":77,"./response/uart/receive.yml":76,"./response/ws/index.yml":75,"./response/ws/ready.yml":74,"./response/ws/redirect.yml":73};function s(e){var t=n(e);return r(t)}function n(e){var t=i[e];if(!(t+1)){var r=new Error('Cannot find module "'+e+'".');throw r.code="MODULE_NOT_FOUND",r}return t}s.keys=function(){return Object.keys(i)},s.resolve=n,e.exports=s,s.id=216},function(e,t,r){var i,s,n;s=[],void 0===(n="function"==typeof(i=function(){var e,t,r,i;Object.keys||(Object.keys=(e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),i=(r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(s){if("object"!=typeof s&&"function"!=typeof s||null===s)throw new TypeError("Object.keys called on non-object");var n=[];for(var a in s)e.call(s,a)&&n.push(a);if(t)for(var o=0;o<i;o++)e.call(s,r[o])&&n.push(r[o]);return n})),Object.create||(Object.create=function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return e.prototype=t,new e}}()),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null===this)throw new TypeError;var t=Object(this),r=t.length>>>0;if(0===r)return-1;var i=0;if(arguments.length>1&&((i=Number(arguments[1]))!=i?i=0:0!==i&&i!==1/0&&i!==-1/0&&(i=(i>0||-1)*Math.floor(Math.abs(i)))),i>=r)return-1;for(var s=i>=0?i:Math.max(r-Math.abs(i),0);s<r;s++)if(s in t&&t[s]===e)return s;return-1}),Object.isFrozen||(Object.isFrozen=function(e){for(var t="tv4_test_frozen_key";e.hasOwnProperty(t);)t+=Math.random();try{return e[t]=!0,delete e[t],!1}catch(e){return!0}});var s={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},n={"*":!0};function a(e){return encodeURI(e).replace(/%25[0-9][0-9]/g,function(e){return"%"+e.substring(3)})}function o(e){var t="";s[e.charAt(0)]&&(t=e.charAt(0),e=e.substring(1));var r="",i="",o=!0,c=!1,d=!1;"+"===t?o=!1:"."===t?(i=".",r="."):"/"===t?(i="/",r="/"):"#"===t?(i="#",o=!1):";"===t?(i=";",r=";",c=!0,d=!0):"?"===t?(i="?",r="&",c=!0):"&"===t&&(i="&",r="&",c=!0);for(var h=[],u=e.split(","),l=[],p={},m=0;m<u.length;m++){var f=u[m],g=null;if(-1!==f.indexOf(":")){var y=f.split(":");f=y[0],g=parseInt(y[1],10)}for(var v={};n[f.charAt(f.length-1)];)v[f.charAt(f.length-1)]=!0,f=f.substring(0,f.length-1);var _={truncate:g,name:f,suffices:v};l.push(_),p[f]=_,h.push(f)}var b=function(e){for(var t="",s=0,n=0;n<l.length;n++){var h=l[n],u=e(h.name);if(null===u||void 0===u||Array.isArray(u)&&0===u.length||"object"==typeof u&&0===Object.keys(u).length)s++;else if(t+=n===s?i:r||",",Array.isArray(u)){c&&(t+=h.name+"=");for(var p=0;p<u.length;p++)p>0&&(t+=h.suffices["*"]&&r||",",h.suffices["*"]&&c&&(t+=h.name+"=")),t+=o?encodeURIComponent(u[p]).replace(/!/g,"%21"):a(u[p])}else if("object"==typeof u){c&&!h.suffices["*"]&&(t+=h.name+"=");var m=!0;for(var f in u)m||(t+=h.suffices["*"]&&r||","),m=!1,t+=o?encodeURIComponent(f).replace(/!/g,"%21"):a(f),t+=h.suffices["*"]?"=":",",t+=o?encodeURIComponent(u[f]).replace(/!/g,"%21"):a(u[f])}else c&&(t+=h.name,d&&""===u||(t+="=")),null!=h.truncate&&(u=u.substring(0,h.truncate)),t+=o?encodeURIComponent(u).replace(/!/g,"%21"):a(u)}return t};return b.varNames=h,{prefix:i,substitution:b}}function c(e){if(!(this instanceof c))return new c(e);for(var t=e.split("{"),r=[t.shift()],i=[],s=[],n=[];t.length>0;){var a=t.shift(),d=a.split("}")[0],h=a.substring(d.length+1),u=o(d);s.push(u.substitution),i.push(u.prefix),r.push(h),n=n.concat(u.substitution.varNames)}this.fill=function(e){for(var t=r[0],i=0;i<s.length;i++){var n=s[i];t+=n(e),t+=r[i+1]}return t},this.varNames=n,this.template=e}c.prototype={toString:function(){return this.template},fillFromObject:function(e){return this.fill(function(t){return e[t]})}};var d=function(e,t,r,i,s){if(this.missing=[],this.missingMap={},this.formatValidators=e?Object.create(e.formatValidators):{},this.schemas=e?Object.create(e.schemas):{},this.collectMultiple=t,this.errors=[],this.handleError=t?this.collectError:this.returnError,i&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),s&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorReporter=r||y("en"),"string"==typeof this.errorReporter)throw new Error("debug");if(this.definedKeywords={},e)for(var n in e.definedKeywords)this.definedKeywords[n]=e.definedKeywords[n].slice(0)};function h(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(Array.isArray(e)!==Array.isArray(t))return!1;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!h(e[r],t[r]))return!1}else{var i;for(i in e)if(void 0===t[i]&&void 0!==e[i])return!1;for(i in t)if(void 0===e[i]&&void 0!==t[i])return!1;for(i in e)if(!h(e[i],t[i]))return!1}return!0}return!1}d.prototype.defineKeyword=function(e,t){this.definedKeywords[e]=this.definedKeywords[e]||[],this.definedKeywords[e].push(t)},d.prototype.createError=function(e,t,r,i,s,n,a){var o=new C(e,t,r,i,s);return o.message=this.errorReporter(o,n,a),o},d.prototype.returnError=function(e){return e},d.prototype.collectError=function(e){return e&&this.errors.push(e),null},d.prototype.prefixErrors=function(e,t,r){for(var i=e;i<this.errors.length;i++)this.errors[i]=this.errors[i].prefixWith(t,r);return this},d.prototype.banUnknownProperties=function(e,t){for(var r in this.unknownPropertyPaths){var i=this.createError(v.UNKNOWN_PROPERTY,{path:r},r,"",null,e,t),s=this.handleError(i);if(s)return s}return null},d.prototype.addFormat=function(e,t){if("object"==typeof e){for(var r in e)this.addFormat(r,e[r]);return this}this.formatValidators[e]=t},d.prototype.resolveRefs=function(e,t){if(void 0!==e.$ref){if((t=t||{})[e.$ref])return this.createError(v.CIRCULAR_REFERENCE,{urls:Object.keys(t).join(", ")},"","",null,void 0,e);t[e.$ref]=!0,e=this.getSchema(e.$ref,t)}return e},d.prototype.getSchema=function(e,t){var r;if(void 0!==this.schemas[e])return r=this.schemas[e],this.resolveRefs(r,t);var i=e,s="";if(-1!==e.indexOf("#")&&(s=e.substring(e.indexOf("#")+1),i=e.substring(0,e.indexOf("#"))),"object"==typeof this.schemas[i]){r=this.schemas[i];var n=decodeURIComponent(s);if(""===n)return this.resolveRefs(r,t);if("/"!==n.charAt(0))return;for(var a=n.split("/").slice(1),o=0;o<a.length;o++){var c=a[o].replace(/~1/g,"/").replace(/~0/g,"~");if(void 0===r[c]){r=void 0;break}r=r[c]}if(void 0!==r)return this.resolveRefs(r,t)}void 0===this.missing[i]&&(this.missing.push(i),this.missing[i]=i,this.missingMap[i]=i)},d.prototype.searchSchemas=function(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)this.searchSchemas(e[r],t);else if(e&&"object"==typeof e)for(var i in"string"==typeof e.id&&function(e,t){if(t.substring(0,e.length)===e){var r=t.substring(e.length);if(t.length>0&&"/"===t.charAt(e.length-1)||"#"===r.charAt(0)||"?"===r.charAt(0))return!0}return!1}(t,e.id)&&void 0===this.schemas[e.id]&&(this.schemas[e.id]=e),e)if("enum"!==i)if("object"==typeof e[i])this.searchSchemas(e[i],t);else if("$ref"===i){var s=f(e[i]);s&&void 0===this.schemas[s]&&void 0===this.missingMap[s]&&(this.missingMap[s]=s)}},d.prototype.addSchema=function(e,t){if("string"!=typeof e||void 0===t){if("object"!=typeof e||"string"!=typeof e.id)return;e=(t=e).id}e===f(e)+"#"&&(e=f(e)),this.schemas[e]=t,delete this.missingMap[e],g(t,e),this.searchSchemas(t,e)},d.prototype.getSchemaMap=function(){var e={};for(var t in this.schemas)e[t]=this.schemas[t];return e},d.prototype.getSchemaUris=function(e){var t=[];for(var r in this.schemas)e&&!e.test(r)||t.push(r);return t},d.prototype.getMissingUris=function(e){var t=[];for(var r in this.missingMap)e&&!e.test(r)||t.push(r);return t},d.prototype.dropSchemas=function(){this.schemas={},this.reset()},d.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},d.prototype.validateAll=function(e,t,r,i,s){var n;if(!(t=this.resolveRefs(t)))return null;if(t instanceof C)return this.errors.push(t),t;var a,o=this.errors.length,c=null,d=null;if(this.checkRecursive&&e&&"object"==typeof e){if(n=!this.scanned.length,e[this.validatedSchemasKey]){var h=e[this.validatedSchemasKey].indexOf(t);if(-1!==h)return this.errors=this.errors.concat(e[this.validationErrorsKey][h]),null}if(Object.isFrozen(e)&&-1!==(a=this.scannedFrozen.indexOf(e))){var u=this.scannedFrozenSchemas[a].indexOf(t);if(-1!==u)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[a][u]),null}if(this.scanned.push(e),Object.isFrozen(e))-1===a&&(a=this.scannedFrozen.length,this.scannedFrozen.push(e),this.scannedFrozenSchemas.push([])),c=this.scannedFrozenSchemas[a].length,this.scannedFrozenSchemas[a][c]=t,this.scannedFrozenValidationErrors[a][c]=[];else{if(!e[this.validatedSchemasKey])try{Object.defineProperty(e,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(e,this.validationErrorsKey,{value:[],configurable:!0})}catch(t){e[this.validatedSchemasKey]=[],e[this.validationErrorsKey]=[]}d=e[this.validatedSchemasKey].length,e[this.validatedSchemasKey][d]=t,e[this.validationErrorsKey][d]=[]}}var l=this.errors.length,p=this.validateBasic(e,t,s)||this.validateNumeric(e,t,s)||this.validateString(e,t,s)||this.validateArray(e,t,s)||this.validateObject(e,t,s)||this.validateCombinations(e,t,s)||this.validateHypermedia(e,t,s)||this.validateFormat(e,t,s)||this.validateDefinedKeywords(e,t,s)||null;if(n){for(;this.scanned.length;){var m=this.scanned.pop();delete m[this.validatedSchemasKey]}this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(p||l!==this.errors.length)for(;r&&r.length||i&&i.length;){var f=r&&r.length?""+r.pop():null,g=i&&i.length?""+i.pop():null;p&&(p=p.prefixWith(f,g)),this.prefixErrors(l,f,g)}return null!==c?this.scannedFrozenValidationErrors[a][c]=this.errors.slice(o):null!==d&&(e[this.validationErrorsKey][d]=this.errors.slice(o)),this.handleError(p)},d.prototype.validateFormat=function(e,t){if("string"!=typeof t.format||!this.formatValidators[t.format])return null;var r=this.formatValidators[t.format].call(null,e,t);return"string"==typeof r||"number"==typeof r?this.createError(v.FORMAT_CUSTOM,{message:r},"","/format",null,e,t):r&&"object"==typeof r?this.createError(v.FORMAT_CUSTOM,{message:r.message||"?"},r.dataPath||"",r.schemaPath||"/format",null,e,t):null},d.prototype.validateDefinedKeywords=function(e,t,r){for(var i in this.definedKeywords)if(void 0!==t[i])for(var s=this.definedKeywords[i],n=0;n<s.length;n++){var a=s[n],o=a(e,t[i],t,r);if("string"==typeof o||"number"==typeof o)return this.createError(v.KEYWORD_CUSTOM,{key:i,message:o},"","",null,e,t).prefixWith(null,i);if(o&&"object"==typeof o){var c=o.code;if("string"==typeof c){if(!v[c])throw new Error("Undefined error code (use defineError): "+c);c=v[c]}else"number"!=typeof c&&(c=v.KEYWORD_CUSTOM);var d="object"==typeof o.message?o.message:{key:i,message:o.message||"?"},h=o.schemaPath||"/"+i.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(c,d,o.dataPath||null,h,null,e,t)}}return null},d.prototype.validateBasic=function(e,t,r){var i;return(i=this.validateType(e,t,r))?i.prefixWith(null,"type"):(i=this.validateEnum(e,t,r))?i.prefixWith(null,"type"):null},d.prototype.validateType=function(e,t){if(void 0===t.type)return null;var r=typeof e;null===e?r="null":Array.isArray(e)&&(r="array");var i=t.type;Array.isArray(i)||(i=[i]);for(var s=0;s<i.length;s++){var n=i[s];if(n===r||"integer"===n&&"number"===r&&e%1==0)return null}return this.createError(v.INVALID_TYPE,{type:r,expected:i.join("/")},"","",null,e,t)},d.prototype.validateEnum=function(e,t){if(void 0===t.enum)return null;for(var r=0;r<t.enum.length;r++){var i=t.enum[r];if(h(e,i))return null}return this.createError(v.ENUM_MISMATCH,{value:"undefined"!=typeof JSON?JSON.stringify(e):e},"","",null,e,t)},d.prototype.validateNumeric=function(e,t,r){return this.validateMultipleOf(e,t,r)||this.validateMinMax(e,t,r)||this.validateNaN(e,t,r)||null};var u=Math.pow(2,-51),l=1-u;function p(e){var t=String(e).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return t?{href:t[0]||"",protocol:t[1]||"",authority:t[2]||"",host:t[3]||"",hostname:t[4]||"",port:t[5]||"",pathname:t[6]||"",search:t[7]||"",hash:t[8]||""}:null}function m(e,t){return t=p(t||""),e=p(e||""),t&&e?(t.protocol||e.protocol)+(t.protocol||t.authority?t.authority:e.authority)+(r=t.protocol||t.authority||"/"===t.pathname.charAt(0)?t.pathname:t.pathname?(e.authority&&!e.pathname?"/":"")+e.pathname.slice(0,e.pathname.lastIndexOf("/")+1)+t.pathname:e.pathname,i=[],r.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(e){"/.."===e?i.pop():i.push(e)}),i.join("").replace(/^\//,"/"===r.charAt(0)?"/":""))+(t.protocol||t.authority||t.pathname?t.search:t.search||e.search)+t.hash:null;var r,i}function f(e){return e.split("#")[0]}function g(e,t){if(e&&"object"==typeof e)if(void 0===t?t=e.id:"string"==typeof e.id&&(t=m(t,e.id),e.id=t),Array.isArray(e))for(var r=0;r<e.length;r++)g(e[r],t);else for(var i in"string"==typeof e.$ref&&(e.$ref=m(t,e.$ref)),e)"enum"!==i&&g(e[i],t)}function y(e){var t=x[e=e||"en"];return function(e){var r=t[e.code]||w[e.code];if("string"!=typeof r)return"Unknown error code "+e.code+": "+JSON.stringify(e.messageParams);var i=e.params;return r.replace(/\{([^{}]*)\}/g,function(e,t){var r=i[t];return"string"==typeof r||"number"==typeof r?r:e})}}d.prototype.validateMultipleOf=function(e,t){var r=t.multipleOf||t.divisibleBy;if(void 0===r)return null;if("number"==typeof e){var i=e/r%1;if(i>=u&&i<l)return this.createError(v.NUMBER_MULTIPLE_OF,{value:e,multipleOf:r},"","",null,e,t)}return null},d.prototype.validateMinMax=function(e,t){if("number"!=typeof e)return null;if(void 0!==t.minimum){if(e<t.minimum)return this.createError(v.NUMBER_MINIMUM,{value:e,minimum:t.minimum},"","/minimum",null,e,t);if(t.exclusiveMinimum&&e===t.minimum)return this.createError(v.NUMBER_MINIMUM_EXCLUSIVE,{value:e,minimum:t.minimum},"","/exclusiveMinimum",null,e,t)}if(void 0!==t.maximum){if(e>t.maximum)return this.createError(v.NUMBER_MAXIMUM,{value:e,maximum:t.maximum},"","/maximum",null,e,t);if(t.exclusiveMaximum&&e===t.maximum)return this.createError(v.NUMBER_MAXIMUM_EXCLUSIVE,{value:e,maximum:t.maximum},"","/exclusiveMaximum",null,e,t)}return null},d.prototype.validateNaN=function(e,t){return"number"!=typeof e?null:!0===isNaN(e)||e===1/0||e===-1/0?this.createError(v.NUMBER_NOT_A_NUMBER,{value:e},"","/type",null,e,t):null},d.prototype.validateString=function(e,t,r){return this.validateStringLength(e,t,r)||this.validateStringPattern(e,t,r)||null},d.prototype.validateStringLength=function(e,t){return"string"!=typeof e?null:void 0!==t.minLength&&e.length<t.minLength?this.createError(v.STRING_LENGTH_SHORT,{length:e.length,minimum:t.minLength},"","/minLength",null,e,t):void 0!==t.maxLength&&e.length>t.maxLength?this.createError(v.STRING_LENGTH_LONG,{length:e.length,maximum:t.maxLength},"","/maxLength",null,e,t):null},d.prototype.validateStringPattern=function(e,t){if("string"!=typeof e||"string"!=typeof t.pattern&&!(t.pattern instanceof RegExp))return null;var r;if(t.pattern instanceof RegExp)r=t.pattern;else{var i,s="",n=t.pattern.match(/^\/(.+)\/([img]*)$/);n?(i=n[1],s=n[2]):i=t.pattern,r=new RegExp(i,s)}return r.test(e)?null:this.createError(v.STRING_PATTERN,{pattern:t.pattern},"","/pattern",null,e,t)},d.prototype.validateArray=function(e,t,r){return Array.isArray(e)&&(this.validateArrayLength(e,t,r)||this.validateArrayUniqueItems(e,t,r)||this.validateArrayItems(e,t,r))||null},d.prototype.validateArrayLength=function(e,t){var r;return void 0!==t.minItems&&e.length<t.minItems&&(r=this.createError(v.ARRAY_LENGTH_SHORT,{length:e.length,minimum:t.minItems},"","/minItems",null,e,t),this.handleError(r))?r:void 0!==t.maxItems&&e.length>t.maxItems&&(r=this.createError(v.ARRAY_LENGTH_LONG,{length:e.length,maximum:t.maxItems},"","/maxItems",null,e,t),this.handleError(r))?r:null},d.prototype.validateArrayUniqueItems=function(e,t){if(t.uniqueItems)for(var r=0;r<e.length;r++)for(var i=r+1;i<e.length;i++)if(h(e[r],e[i])){var s=this.createError(v.ARRAY_UNIQUE,{match1:r,match2:i},"","/uniqueItems",null,e,t);if(this.handleError(s))return s}return null},d.prototype.validateArrayItems=function(e,t,r){if(void 0===t.items)return null;var i,s;if(Array.isArray(t.items)){for(s=0;s<e.length;s++)if(s<t.items.length){if(i=this.validateAll(e[s],t.items[s],[s],["items",s],r+"/"+s))return i}else if(void 0!==t.additionalItems)if("boolean"==typeof t.additionalItems){if(!t.additionalItems&&(i=this.createError(v.ARRAY_ADDITIONAL_ITEMS,{},"/"+s,"/additionalItems",null,e,t),this.handleError(i)))return i}else if(i=this.validateAll(e[s],t.additionalItems,[s],["additionalItems"],r+"/"+s))return i}else for(s=0;s<e.length;s++)if(i=this.validateAll(e[s],t.items,[s],["items"],r+"/"+s))return i;return null},d.prototype.validateObject=function(e,t,r){return"object"!=typeof e||null===e||Array.isArray(e)?null:this.validateObjectMinMaxProperties(e,t,r)||this.validateObjectRequiredProperties(e,t,r)||this.validateObjectProperties(e,t,r)||this.validateObjectDependencies(e,t,r)||null},d.prototype.validateObjectMinMaxProperties=function(e,t){var r,i=Object.keys(e);return void 0!==t.minProperties&&i.length<t.minProperties&&(r=this.createError(v.OBJECT_PROPERTIES_MINIMUM,{propertyCount:i.length,minimum:t.minProperties},"","/minProperties",null,e,t),this.handleError(r))?r:void 0!==t.maxProperties&&i.length>t.maxProperties&&(r=this.createError(v.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:i.length,maximum:t.maxProperties},"","/maxProperties",null,e,t),this.handleError(r))?r:null},d.prototype.validateObjectRequiredProperties=function(e,t){if(void 0!==t.required)for(var r=0;r<t.required.length;r++){var i=t.required[r];if(void 0===e[i]){var s=this.createError(v.OBJECT_REQUIRED,{key:i},"","/required/"+r,null,e,t);if(this.handleError(s))return s}}return null},d.prototype.validateObjectProperties=function(e,t,r){var i;for(var s in e){var n=r+"/"+s.replace(/~/g,"~0").replace(/\//g,"~1"),a=!1;if(void 0!==t.properties&&void 0!==t.properties[s]&&(a=!0,i=this.validateAll(e[s],t.properties[s],[s],["properties",s],n)))return i;if(void 0!==t.patternProperties)for(var o in t.patternProperties){var c=new RegExp(o);if(c.test(s)&&(a=!0,i=this.validateAll(e[s],t.patternProperties[o],[s],["patternProperties",o],n)))return i}if(a)this.trackUnknownProperties&&(this.knownPropertyPaths[n]=!0,delete this.unknownPropertyPaths[n]);else if(void 0!==t.additionalProperties){if(this.trackUnknownProperties&&(this.knownPropertyPaths[n]=!0,delete this.unknownPropertyPaths[n]),"boolean"==typeof t.additionalProperties){if(!t.additionalProperties&&(i=this.createError(v.OBJECT_ADDITIONAL_PROPERTIES,{key:s},"","/additionalProperties",null,e,t).prefixWith(s,null),this.handleError(i)))return i}else if(i=this.validateAll(e[s],t.additionalProperties,[s],["additionalProperties"],n))return i}else this.trackUnknownProperties&&!this.knownPropertyPaths[n]&&(this.unknownPropertyPaths[n]=!0)}return null},d.prototype.validateObjectDependencies=function(e,t,r){var i;if(void 0!==t.dependencies)for(var s in t.dependencies)if(void 0!==e[s]){var n=t.dependencies[s];if("string"==typeof n){if(void 0===e[n]&&(i=this.createError(v.OBJECT_DEPENDENCY_KEY,{key:s,missing:n},"","",null,e,t).prefixWith(null,s).prefixWith(null,"dependencies"),this.handleError(i)))return i}else if(Array.isArray(n))for(var a=0;a<n.length;a++){var o=n[a];if(void 0===e[o]&&(i=this.createError(v.OBJECT_DEPENDENCY_KEY,{key:s,missing:o},"","/"+a,null,e,t).prefixWith(null,s).prefixWith(null,"dependencies"),this.handleError(i)))return i}else if(i=this.validateAll(e,n,[],["dependencies",s],r))return i}return null},d.prototype.validateCombinations=function(e,t,r){return this.validateAllOf(e,t,r)||this.validateAnyOf(e,t,r)||this.validateOneOf(e,t,r)||this.validateNot(e,t,r)||null},d.prototype.validateAllOf=function(e,t,r){if(void 0===t.allOf)return null;for(var i,s=0;s<t.allOf.length;s++){var n=t.allOf[s];if(i=this.validateAll(e,n,[],["allOf",s],r))return i}return null},d.prototype.validateAnyOf=function(e,t,r){if(void 0===t.anyOf)return null;var i,s,n=[],a=this.errors.length;this.trackUnknownProperties&&(i=this.unknownPropertyPaths,s=this.knownPropertyPaths);for(var o=!0,c=0;c<t.anyOf.length;c++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var d=t.anyOf[c],h=this.errors.length,u=this.validateAll(e,d,[],["anyOf",c],r);if(null===u&&h===this.errors.length){if(this.errors=this.errors.slice(0,a),this.trackUnknownProperties){for(var l in this.knownPropertyPaths)s[l]=!0,delete i[l];for(var p in this.unknownPropertyPaths)s[p]||(i[p]=!0);o=!1;continue}return null}u&&n.push(u.prefixWith(null,""+c).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=i,this.knownPropertyPaths=s),o?(n=n.concat(this.errors.slice(a)),this.errors=this.errors.slice(0,a),this.createError(v.ANY_OF_MISSING,{},"","/anyOf",n,e,t)):void 0},d.prototype.validateOneOf=function(e,t,r){if(void 0===t.oneOf)return null;var i,s,n=null,a=[],o=this.errors.length;this.trackUnknownProperties&&(i=this.unknownPropertyPaths,s=this.knownPropertyPaths);for(var c=0;c<t.oneOf.length;c++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var d=t.oneOf[c],h=this.errors.length,u=this.validateAll(e,d,[],["oneOf",c],r);if(null===u&&h===this.errors.length){if(null!==n)return this.errors=this.errors.slice(0,o),this.createError(v.ONE_OF_MULTIPLE,{index1:n,index2:c},"","/oneOf",null,e,t);if(n=c,this.trackUnknownProperties){for(var l in this.knownPropertyPaths)s[l]=!0,delete i[l];for(var p in this.unknownPropertyPaths)s[p]||(i[p]=!0)}}else u&&a.push(u)}return this.trackUnknownProperties&&(this.unknownPropertyPaths=i,this.knownPropertyPaths=s),null===n?(a=a.concat(this.errors.slice(o)),this.errors=this.errors.slice(0,o),this.createError(v.ONE_OF_MISSING,{},"","/oneOf",a,e,t)):(this.errors=this.errors.slice(0,o),null)},d.prototype.validateNot=function(e,t,r){if(void 0===t.not)return null;var i,s,n=this.errors.length;this.trackUnknownProperties&&(i=this.unknownPropertyPaths,s=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var a=this.validateAll(e,t.not,null,null,r),o=this.errors.slice(n);return this.errors=this.errors.slice(0,n),this.trackUnknownProperties&&(this.unknownPropertyPaths=i,this.knownPropertyPaths=s),null===a&&0===o.length?this.createError(v.NOT_PASSED,{},"","/not",null,e,t):null},d.prototype.validateHypermedia=function(e,t,r){if(!t.links)return null;for(var i,s=0;s<t.links.length;s++){var n=t.links[s];if("describedby"===n.rel){for(var a=new c(n.href),o=!0,d=0;d<a.varNames.length;d++)if(!(a.varNames[d]in e)){o=!1;break}if(o){var h=a.fillFromObject(e),u={$ref:h};if(i=this.validateAll(e,u,[],["links",s],r))return i}}}};var v={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,NUMBER_NOT_A_NUMBER:105,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},_={};for(var b in v)_[v[b]]=b;var w={INVALID_TYPE:"Invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",NUMBER_NOT_A_NUMBER:"Value {value} is not a valid number",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};function C(e,t,r,i,s){if(Error.call(this),void 0===e)throw new Error("No error code supplied: "+i);this.message="",this.params=t,this.code=e,this.dataPath=r||"",this.schemaPath=i||"",this.subErrors=s||null;var n=new Error(this.message);if(this.stack=n.stack||n.stacktrace,!this.stack)try{throw n}catch(n){this.stack=n.stack||n.stacktrace}}C.prototype=Object.create(Error.prototype),C.prototype.constructor=C,C.prototype.name="ValidationError",C.prototype.prefixWith=function(e,t){if(null!==e&&(e=e.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+e+this.dataPath),null!==t&&(t=t.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+t+this.schemaPath),null!==this.subErrors)for(var r=0;r<this.subErrors.length;r++)this.subErrors[r].prefixWith(e,t);return this};var x={},S=function e(t){var r,i,s=new d,n={setErrorReporter:function(e){return"string"==typeof e?this.language(e):(i=e,!0)},addFormat:function(){s.addFormat.apply(s,arguments)},language:function(e){return e?(x[e]||(e=e.split("-")[0]),!!x[e]&&(r=e,e)):r},addLanguage:function(e,t){var r;for(r in v)t[r]&&!t[v[r]]&&(t[v[r]]=t[r]);var i=e.split("-")[0];if(x[i])for(r in x[e]=Object.create(x[i]),t)void 0===x[i][r]&&(x[i][r]=t[r]),x[e][r]=t[r];else x[e]=t,x[i]=t;return this},freshApi:function(t){var r=e();return t&&r.language(t),r},validate:function(e,t,n,a){var o=y(r),c=i?function(e,t,r){return i(e,t,r)||o(e,t,r)}:o,h=new d(s,!1,c,n,a);"string"==typeof t&&(t={$ref:t}),h.addSchema("",t);var u=h.validateAll(e,t,null,null,"");return!u&&a&&(u=h.banUnknownProperties(e,t)),this.error=u,this.missing=h.missing,this.valid=null===u,this.valid},validateResult:function(){var e={toString:function(){return this.valid?"valid":this.error.message}};return this.validate.apply(e,arguments),e},validateMultiple:function(e,t,n,a){var o=y(r),c=i?function(e,t,r){return i(e,t,r)||o(e,t,r)}:o,h=new d(s,!0,c,n,a);"string"==typeof t&&(t={$ref:t}),h.addSchema("",t),h.validateAll(e,t,null,null,""),a&&h.banUnknownProperties(e,t);var u={toString:function(){return this.valid?"valid":this.error.message}};return u.errors=h.errors,u.missing=h.missing,u.valid=0===u.errors.length,u},addSchema:function(){return s.addSchema.apply(s,arguments)},getSchema:function(){return s.getSchema.apply(s,arguments)},getSchemaMap:function(){return s.getSchemaMap.apply(s,arguments)},getSchemaUris:function(){return s.getSchemaUris.apply(s,arguments)},getMissingUris:function(){return s.getMissingUris.apply(s,arguments)},dropSchemas:function(){s.dropSchemas.apply(s,arguments)},defineKeyword:function(){s.defineKeyword.apply(s,arguments)},defineError:function(e,t,r){if("string"!=typeof e||!/^[A-Z]+(_[A-Z]+)*$/.test(e))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if("number"!=typeof t||t%1!=0||t<1e4)throw new Error("Code number must be an integer > 10000");if(void 0!==v[e])throw new Error("Error already defined: "+e+" as "+v[e]);if(void 0!==_[t])throw new Error("Error code already used: "+_[t]+" as "+t);for(var i in v[e]=t,_[t]=e,w[e]=w[t]=r,x){var s=x[i];s[e]&&(s[t]=s[t]||s[e])}},reset:function(){s.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:g,resolveUrl:m,getDocumentUri:f,errorCodes:v};return n.language(t||"en"),n}();return S.addLanguage("en-gb",w),S.tv4=S,S})?i.apply(t,s):i)||(e.exports=n)},function(e,t,r){(function(t){const i=r(217);i.defineError("UNIQUE_KEYS",10001,"{uniqueKeys} are must be unique value."),i.defineKeyword("uniqueKeys",function(e,t,r){if(!Array.isArray(t))return null;let s=[];for(let r of t)null!==e[r]&&void 0!==e[r]&&s.push(e[r]);return s.filter(function(e,t,r){return r.indexOf(e)!==r.lastIndexOf(e)}).length>0?{code:i.errorCodes.UNIQUE_KEYS,message:{uniqueKeys:t.join(",")}}:null});let s=[];r(6).context=r(13),r(6).context&&r(6).context.setBaseDir&&r(6).context.setBaseDir(t);let n=r(216);for(let e of n.keys()){let t=n(e);s.push(t)}s.map(i.addSchema),e.exports=i}).call(this,"/")},function(e,t,r){const i=r(1);i.addCommandClass("WSCommand_System",r(72)),i.addCommandClass("WSCommand_Directive",r(71)),i.addCommandClass("WSCommand_IO",r(12)),i.addCommandClass("WSCommand_PWM",r(11)),i.addCommandClass("WSCommand_UART",r(70)),i.addCommandClass("WSCommand_AD",r(69)),i.addCommandClass("WSCommand_SPI",r(68)),i.addCommandClass("WSCommand_I2C",r(67)),i.addCommandClass("WSCommand_LogicAnalyzer",r(66)),i.addCommandClass("WSCommand_Display",r(65)),i.addCommandClass("WSCommand_Switch",r(63)),i.addCommandClass("WSCommand_Ble",r(62)),i.addCommandClass("WSCommand_Measurement",r(60)),e.exports=i},function(e,t,r){const i=r(219),s="undefined"==typeof window;e.exports=class{constructor(e,t){if(this.isNode=s,this.id=e,this.socket=null,this.socket_local=null,this.debugprint=!1,this.debugprintBinary=!1,this.debugs=[],this.bufferdAmoundWarnBytes=1e5,this._prepareComponents(),t||(t={}),this.options={binary:!1!==t.binary,local_connect:!1!==t.local_connect,debug_dom_id:t.debug_dom_id||"obniz-debug",auto_connect:!1!==t.auto_connect,access_token:t.access_token||null,obniz_server:t.obniz_server||"wss://obniz.io"},this.options.binary){this.wscommand=this.constructor.WSCommand;let e=this.constructor.WSCommand.CommandClasses;this.wscommands=[];for(let t in e)this.wscommands.push(new e[t])}this.options.auto_connect&&this.wsconnect()}isValidObnizId(e){if("string"!=typeof e||e.length<8)return null;e=e.replace("-","");let t=parseInt(e);return isNaN(t)&&(t=null),null!=t}prompt(e,t){var r=prompt("Please enter obniz id",e);r&&t(r)}static get version(){return r(59).version}wsOnOpen(){this.print_debug("ws connected"),"function"==typeof this.onopen&&this.onopen(this)}wsOnMessage(e){let t;if(this.debugprintBinary&&"string"!=typeof e&&this.print_debug(""+new Uint8Array(e).toString()),"string"==typeof e?t=JSON.parse(e):this.wscommands&&(t=this.binary2Json(e)),Array.isArray(t))for(let e in t)this.notifyToModule(t[e])}wsOnClose(e){this.print_debug("closed"),this.close(),"function"==typeof this.onclose&&this.onclose(this),this.options.auto_connect&&setTimeout(()=>{this.wsconnect()},1e3)}wsOnError(e){}wsOnUnexpectedResponse(e,t){let r=1e3;t&&404==t.statusCode?this.print_debug("obniz not online"):(r=5e3,this.print_debug(t.statusCode)),this.clearSocket(this.socket),delete this.socket,this.options.auto_connect&&setTimeout(()=>{this.wsconnect()},r)}wsconnect(e){let t=this.options.obniz_server;e&&(t=""+e),this.close();let i,s=t+"/obniz/"+this.id+"/ws/1",n=[];if(this.constructor.version&&n.push("obnizjs="+this.constructor.version),this.options.access_token&&n.push("access_token="+this.options.access_token),this.wscommand&&n.push("accept_binary=true"),n.length>0&&(s+="?"+n.join("&")),this.print_debug("connecting to "+s),this.isNode){(i=new(r(10))(s)).on("open",this.wsOnOpen.bind(this)),i.on("message",this.wsOnMessage.bind(this)),i.on("close",this.wsOnClose.bind(this)),i.on("error",this.wsOnError.bind(this)),i.on("unexpected-response",this.wsOnUnexpectedResponse.bind(this))}else(i=new WebSocket(s)).binaryType="arraybuffer",i.onopen=this.wsOnOpen.bind(this),i.onmessage=function(e){this.wsOnMessage(e.data)}.bind(this),i.onclose=this.wsOnClose.bind(this),i.onerror=this.wsOnError.bind(this);this.socket=i}_connectLocal(e){const t="ws://"+e;let i;if(this.print_debug("local connect to "+t),this.isNode){(i=new(r(10))(t)).on("open",()=>{this.print_debug("connected to "+t),this._waitForLocalConnectReadyTimer&&(clearTimeout(this._waitForLocalConnectReadyTimer),this._waitForLocalConnectReadyTimer=null,this._callOnConnect())}),i.on("message",e=>{this.print_debug("recvd via local"),this.wsOnMessage(e)}),i.on("close",e=>{console.log("local websocket closed"),this._disconnectLocal()}),i.on("error",e=>{console.error("local websocket error.",e),this._disconnectLocal()}),i.on("unexpected-response",e=>{console.log("local websocket closed"),this._disconnectLocal()})}else(i=new WebSocket(t)).binaryType="arraybuffer",i.onopen=(()=>{this.print_debug("connected to "+t),this._waitForLocalConnectReadyTimer&&(clearTimeout(this._waitForLocalConnectReadyTimer),this._waitForLocalConnectReadyTimer=null,this._callOnConnect())}),i.onmessage=(e=>{this.print_debug("recvd via local"),this.wsOnMessage(e.data)}),i.onclose=(e=>{console.log("local websocket closed"),this._disconnectLocal()}),i.onerror=(e=>{console.log("local websocket error.",e),this._disconnectLocal()});this.socket_local=i}_disconnectLocal(){this._waitForLocalConnectReadyTimer&&(clearTimeout(this._waitForLocalConnectReadyTimer),this._waitForLocalConnectReadyTimer=null),this.socket_local&&(this.socket_local.close(),this.clearSocket(this.socket_local),delete this.socket_local)}clearSocket(e){if(e)if(this._sendQueueTimer&&(delete this._sendQueue,clearTimeout(this._sendQueueTimer),this._sendQueueTimer=null),this.isNode){let t=["open","message","close","error","unexpected-response"];for(let r=0;r<t.length;r++)e.removeAllListeners(t[r])}else e.onopen=null,e.onmessage=null,e.onclose=null,e.onerror=null}connect(){this.wsconnect()}close(){this._drainQueued(),this._disconnectLocal(),this.socket&&(3!==this.socket.readyState&&this.socket.close(1e3,"close"),this.clearSocket(this.socket),delete this.socket)}_callOnConnect(){if(this._waitForLocalConnectReadyTimer&&(clearTimeout(this._waitForLocalConnectReadyTimer),this._waitForLocalConnectReadyTimer=null),"function"!=typeof this.onconnect)return;const e=this.onconnect(this);e instanceof Promise&&e.catch(e=>{console.error(e)})}print_debug(e){this.debugprint&&console.log("Obniz: "+e)}send(e,t){if(!e||"object"!=typeof e)return void console.log("obnizjs. didnt send ",e);if(Array.isArray(e)){for(let t=0;t<e.length;t++)this.send(e[t]);return}if(this.sendPool)return void this.sendPool.push(e);let r=JSON.stringify([e]);if(this.debugprint&&this.print_debug("send: "+r),this.wscommand&&("object"!=typeof t||!1!==t.local_connect)){let e;try{(e=this.wscommand.compress(this.wscommands,JSON.parse(r)[0]))&&(r=e,this.debugprintBinary&&this.print_debug("binalized: "+new Uint8Array(e).toString()))}catch(e){throw this.error("------ errored json -------"),this.error(r),e}}"string"==typeof r?(this._drainQueued(),this._sendRouted(r)):this._sendQueue?this._sendQueue.push(r):(this._sendQueue=[r],this._sendQueueTimer=setTimeout(this._drainQueued.bind(this),0))}_sendRouted(e){return this.socket_local&&1===this.socket_local.readyState&&"string"!=typeof e?(this.print_debug("send via local"),this.print_debug(e),this.socket_local.send(e),void(this.socket_local.bufferedAmount>this.bufferdAmoundWarnBytes&&this.error("Warning: over "+this.socket_local.bufferedAmount+" bytes queued"))):this.socket&&1===this.socket.readyState?(this.socket.send(e),void(this.socket.bufferedAmount>this.bufferdAmoundWarnBytes&&this.error("Warning: over "+this.socket.bufferedAmount+" bytes queued"))):void 0}_drainQueued(){if(!this._sendQueue)return;let e=0;for(let t=0;t<this._sendQueue.length;t++)e+=this._sendQueue[t].length;let t=0,r=new Uint8Array(e);for(let e=0;e<this._sendQueue.length;e++)r.set(this._sendQueue[e],t),t+=this._sendQueue[e].length;this._sendRouted(r),delete this._sendQueue,clearTimeout(this._sendQueueTimer),this._sendQueueTimer=null}_prepareComponents(){}notifyToModule(e){this.print_debug(JSON.stringify(e)),e.ws?this.handleWSCommand(e.ws):e.system&&this.handleSystemCommand(e.system)}handleWSCommand(e){if(e.ready&&(this.resetOnDisconnect(!0),e.local_connect&&e.local_connect.ip&&this.wscommand&&this.options.local_connect&&(this._connectLocal(e.local_connect.ip),this._waitForLocalConnectReadyTimer=setTimeout(()=>{this._callOnConnect()},1e3)),this._waitForLocalConnectReadyTimer||this._callOnConnect()),e.redirect){let t=e.redirect;this.print_debug("WS connection changed to "+t),this.close(),this.wsconnect(t)}}handleSystemCommand(e){}static get WSCommand(){return i}binary2Json(e){let t=new Uint8Array(e),r=[];for(;;){const e=i.dequeueOne(t);if(!e)break;let n={};for(var s=0;s<this.wscommands.length;s++){const t=this.wscommands[s];if(t.module===e.module){t.notifyFromBinary(n,e.func,e.payload);break}}r.push(n),t=e.next}return r}updateOnlineUI(){}warning(e){console.log("warning:"+e)}error(e){console.error("error:"+e)}}},function(e,t,r){const i=r(220),s=r(2);let n={};e.exports=class e extends i{constructor(e,t){super(e,t)}static _parts(){return n}static PartsRegistrate(e,t){n[e]=t}static Parts(e){return new n[e]}wired(t){let r=e.Parts(t);if(!r)throw new Error("No such a parts ["+t+"] found");let i=Array.from(arguments);if(i.shift(),i.unshift(this),r.keys){if(r.requiredKeys){let e=s._requiredKeys(i[1],r.requiredKeys);if(e)throw new Error(t+" wired param '"+e+"' required, but not found ")}r.params=s._keyFilter(i[1],r.keys)}if(r.obniz=this,r.wired.apply(r,i),r.keys||r.ioKeys){let e=r.ioKeys||r.keys,s=r.displayName||t,n={};for(let t in e){let s=e[t],a=i[1][s];this.isValidIO(a)&&(r.displayIoNames&&r.displayIoNames[s]&&(s=r.displayIoNames[s]),n[a]=s)}this.display.setPinNames(s,n)}return r}}},function(e,t,r){(function(t){const i=r(2),s="undefined"==typeof window;e.exports=class{constructor(e,t){this.Obniz=e,this.id=t,this.received=new Uint8Array([]),this.used=!1}start(e){var t=i._requiredKeys(e,["tx","rx"]);if(t)throw new Error("uart start param '"+t+"' required, but not found ");this.params=i._keyFilter(e,["tx","rx","baud","stop","bits","parity","flowcontrol","rts","cts","drive","pull"]);let r=["rx","tx","rts","cts"];for(let e of r)if(this.params[e]&&!this.Obniz.isValidIO(this.params[e]))throw new Error("uart start param '"+e+"' are to be valid io no");this.params.hasOwnProperty("drive")?(this.Obniz.getIO(this.params.rx).drive(this.params.drive),this.Obniz.getIO(this.params.tx).drive(this.params.drive)):(this.Obniz.getIO(this.params.rx).drive("5v"),this.Obniz.getIO(this.params.tx).drive("5v")),this.params.hasOwnProperty("pull")?(this.Obniz.getIO(this.params.rx).pull(this.params.pull),this.Obniz.getIO(this.params.tx).pull(this.params.pull)):(this.Obniz.getIO(this.params.rx).pull(null),this.Obniz.getIO(this.params.tx).pull(null));var s={};s["uart"+this.id]=this.params,this.Obniz.send(s),this.received=[],this.used=!0}send(e){var r=null;if(void 0!==e){if("number"==typeof e&&(e=[e]),s&&e instanceof t);else if(e.constructor===Array)r=e;else if("string"==typeof e)if(s)r=[...t(e)];else if(TextEncoder){const t=new TextEncoder("utf-8").encode(e);r=new Array(t.length);for(var i=0;i<t.length;i++)r[i]=t[i]}var n={};n["uart"+this.id]={},n["uart"+this.id].data=r,this.Obniz.send(n)}}isDataExists(){return this.received&&this.received.length>0}readBytes(){var e=[];if(this.isDataExists())for(var t=0;t<this.received.length;t++)e.push(this.received[t]);return this.received=[],e}readText(){var e=null;if(this.isDataExists()){var t=this.readBytes();e=this.tryConvertString(t)}return this.received=[],e}tryConvertString(e){return i.dataArray2string(e)}notified(e){if(this.onreceive){var t=this.tryConvertString(e.data);this.onreceive(e.data,t)}else this.received||(this.received=[]),this.received.push.apply(this.received,e.data)}isUsed(){return this.used}end(){var e={};e["uart"+this.id]=null,this.params=null,this.Obniz.send(e),this.used=!1}}}).call(this,r(4).Buffer)},function(e,t,r){const i=r(2);e.exports=class{constructor(e,t){this.Obniz=e,this.id=t,this.observers=[],this.used=!1}addObserver(e){e&&this.observers.push(e)}start(e){var t=i._requiredKeys(e,["mode","frequency"]);if(t)throw new Error("spi start param '"+t+"' required, but not found ");this.params=i._keyFilter(e,["mode","clk","mosi","miso","frequency","drive","pull"]);var r={};let s=["clk","mosi","miso"];for(let e of s)if(this.params[e]&&!this.Obniz.isValidIO(this.params[e]))throw new Error("spi start param '"+e+"' are to be valid io no");r["spi"+this.id]={mode:this.params.mode,clock:this.params.frequency},void 0!==this.params.clk&&(r["spi"+this.id].clk=this.params.clk),void 0!==this.params.mosi&&(r["spi"+this.id].mosi=this.params.mosi),void 0!==this.params.miso&&(r["spi"+this.id].miso=this.params.miso),this.params.drive?(void 0!==this.params.clk&&this.Obniz.getIO(this.params.clk).drive(this.params.drive),void 0!==this.params.mosi&&this.Obniz.getIO(this.params.mosi).drive(this.params.drive),void 0!==this.params.miso&&this.Obniz.getIO(this.params.miso).drive(this.params.drive)):(void 0!==this.params.clk&&this.Obniz.getIO(this.params.clk).drive("5v"),void 0!==this.params.mosi&&this.Obniz.getIO(this.params.mosi).drive("5v"),void 0!==this.params.miso&&this.Obniz.getIO(this.params.miso).drive("5v")),this.params.pull?(void 0!==this.params.clk&&this.Obniz.getIO(this.params.clk).pull(this.params.pull),void 0!==this.params.mosi&&this.Obniz.getIO(this.params.mosi).pull(this.params.pull),void 0!==this.params.miso&&this.Obniz.getIO(this.params.miso).pull(this.params.pull)):(void 0!==this.params.clk&&this.Obniz.getIO(this.params.clk).pull(null),void 0!==this.params.mosi&&this.Obniz.getIO(this.params.mosi).pull(null),void 0!==this.params.miso&&this.Obniz.getIO(this.params.miso).pull(null)),this.used=!0,this.Obniz.send(r)}writeWait(e){var t=this;return new Promise(function(r,i){var s={};s["spi"+t.id]={data:e,read:!0},t.Obniz.send(s),t.addObserver(r)})}write(e){var t={};t["spi"+this.id]={data:e,read:!1},this.Obniz.send(t)}notified(e){var t=this.observers.shift();t&&t(e.data)}isUsed(){return this.used}end(e){var t={};t["spi"+this.id]=null,this.params=null,this.Obniz.send(t),e||(this.used=!1)}}},function(e,t,r){const i=r(2);e.exports=class{constructor(e,t){this.Obniz=e,this.id=t,this.state={},this.used=!1}sendWS(e){var t={};t["pwm"+this.id]=e,this.Obniz.send(t)}start(e){const t=i._requiredKeys(e,["io"]);if(t)throw new Error("pwm start param '"+t+"' required, but not found ");this.params=i._keyFilter(e,["io","drive","pull"]);const r=this.params.io,s=this.Obniz.getIO(r);s.drive(this.params.drive||"5v"),s.pull(this.params.pull||null),this.state={io:r,freq:1e3},this.sendWS({io:r}),this.used=!0}freq(e){if(e*=1,"number"!=typeof this.state.io)throw new Error("pwm"+this.id+" haven't started");if("number"!=typeof e)throw new Error("please provide freq in number");this.state.freq=e,this.sendWS({freq:e}),"number"==typeof this.state.duty&&this.duty(this.state.duty)}pulse(e){if("number"!=typeof this.state.io)throw new Error("pwm"+this.id+" haven't started");this.state.pulse=e,delete this.state.duty,this.sendWS({pulse:e})}duty(e){if(e*=1,"number"!=typeof this.state.io)throw new Error("pwm"+this.id+" haven't started");if("number"!=typeof this.state.freq||this.state.freq<=0)throw new Error("please provide freq first.");if("number"!=typeof e)throw new Error("please provide duty in number");e<0&&(e=0),e>100&&(e=100);const t=1/this.state.freq*1e3*e*.01;this.state.duty=e,this.sendWS({pulse:t})}isUsed(){return this.used}end(){this.state={},this.sendWS(null),this.used=!1}modulate(e,t,r){if("number"!=typeof this.state.io)throw new Error("pwm"+this.id+" haven't started");this.sendWS({modulate:{type:e,symbol_length:t,data:r}})}}},function(e,t){e.exports=class{constructor(e,t){this.Obniz=e}animation(e,t,r){var i={};i.io={animation:{name:e,status:t}},r||(r=[]);let s=[];for(var n=0;n<r.length;n++){let e=r[n],t=e.duration,i=e.state;this.Obniz.sendPool=[],i(n);let o=this.Obniz.sendPool;this.Obniz.sendPool=null;let c={};for(var a=0;a<o.length;a++)for(let e in o[a])c[e]=o[a][e];s.push({duration:t,state:c})}"loop"===t&&(i.io.animation.states=s),this.Obniz.send(i)}}},function(e,t){e.exports=class{constructor(e,t){this.Obniz=e,this.id=t,this.value=0,this.observers=[]}addObserver(e){e&&this.observers.push(e)}output(e){var t={};t["io"+this.id]=e,this.value=e,this.Obniz.send(t)}drive(e){if("string"!=typeof e)throw new Error("please specify drive methods in string");let t="";switch(e){case"5v":t="push-pull5v";break;case"3v":t="push-pull3v";break;case"open-drain":t="open-drain";break;default:throw new Error("unknown drive method")}var r={};r["io"+this.id]={output_type:t},this.Obniz.send(r)}pull(e){if("string"!=typeof e&&null!==e)throw new Error("please specify pull methods in string");let t="";switch(e){case"5v":case"pull-up5v":t="pull-up5v";break;case"3v":case"pull-up3v":t="pull-up3v";break;case"0v":case"pull-down":t="pull-down";break;case null:case"float":t="float";break;default:throw new Error("unknown pull_type method")}var r={};r["io"+this.id]={pull_type:t},this.Obniz.send(r)}input(e){this.onchange=e;var t={};return t["io"+this.id]={direction:"input",stream:!0},this.Obniz.send(t),this.value}inputWait(){var e=this;return new Promise(function(t,r){var i={};i["io"+e.id]={direction:"input",stream:!1},e.Obniz.send(i),e.addObserver(t)})}end(){var e={};e["io"+this.id]=null,this.Obniz.send(e)}notified(e){if("boolean"==typeof e){this.value=e;var t=this.observers.shift();t&&t(e),"function"==typeof this.onchange&&this.onchange(e)}else e&&"object"==typeof e&&(e.warning&&this.Obniz.warning({alert:"warning",message:`io${this.id}: ${e.warning.message}`}),e.error&&this.Obniz.error({alert:"error",message:`io${this.id}: ${e.error.message}`}))}}},function(e,t,r){const i=r(2);e.exports=class{constructor(e,t){this.Obniz=e,this.id=t,this.observers=[],this.state={},this.used=!1,this.onwritten=void 0}addObserver(e){e&&this.observers.push(e)}start(e){var t=i._requiredKeys(e,["mode","sda","scl"]);if(t)throw new Error("I2C start param '"+t+"' required, but not found ");this.state=i._keyFilter(e,["mode","sda","scl","pull"]);let r=["sda","scl"];for(let e of r)if(this.state[e]&&!this.Obniz.isValidIO(this.state[e]))throw new Error("i2c start param '"+e+"' are to be valid io no");var s=this.state.mode,n="number"==typeof e.clock?parseInt(e.clock):null,a="number"==typeof e.slave_address?parseInt(e.slave_address):null,o="number"==typeof e.slave_address_length?parseInt(e.slave_address_length):null;if("master"!==s&&"slave"!==s)throw new Error("i2c: invalid mode "+s);if("master"===s){if(null===n)throw new Error("i2c: please specify clock when master mode");if(n<=0||n>1e6)throw new Error("i2c: invalid clock "+n);if("5v"==typeof e.pull&&n>4e5)throw new Error("i2c: please use under 400khz when internal 5v internal pull-up");if("3v"==typeof e.pull&&n>1e5)throw new Error("i2c: please use under 100khz when internal 3v internal pull-up")}else{if(null===a)throw new Error("i2c: please specify slave_address");if(a<0||a>127)throw new Error("i2c: invalid slave_address");if(a<0||a>127)throw new Error("i2c: invalid slave_address");if(null!==o&&7!==o)throw new Error("i2c: invalid slave_address_length. please specify 7")}this.Obniz.getIO(this.state.sda).drive("open-drain"),this.Obniz.getIO(this.state.scl).drive("open-drain"),this.state.pull?(this.Obniz.getIO(this.state.sda).pull(this.state.pull),this.Obniz.getIO(this.state.scl).pull(this.state.pull)):(this.Obniz.getIO(this.state.sda).pull(null),this.Obniz.getIO(this.state.scl).pull(null));var c=i._keyFilter(this.state,["mode","sda","scl"]);"master"===s?c.clock=n:(c.slave_address=a,o&&(c.slave_address_length=o));var d={};d["i2c"+this.id]=c,this.used=!0,this.Obniz.send(d)}write(e,t){if(e=parseInt(e),isNaN(e))throw new Error("i2c: please specify address");if(e<0||e>127)throw new Error("i2c: invalid address");if(!t)throw new Error("i2c: please provide data");if(t.length>1024)throw new Error("i2c: data should be under 1024 bytes");var r={};r["i2c"+this.id]={address:e,data:t},this.Obniz.send(r)}readWait(e,t){if(e=parseInt(e),isNaN(e))throw new Error("i2c: please specify address");if(e<0||e>127)throw new Error("i2c: invalid address");if(t=parseInt(t),isNaN(t)||t<0)throw new Error("i2c: invalid length to read");if(t>1024)throw new Error("i2c: data length should be under 1024 bytes");var r=this;return new Promise(function(i,s){var n={};n["i2c"+r.id]={address:e,read:t},r.Obniz.send(n),r.addObserver(i)})}notified(e){if(e&&"object"==typeof e){if(e.data)if("slave"===e.mode&&"function"==typeof this.onwritten)this.onwritten(e.data,e.address);else{var t=this.observers.shift();t&&t(e.data)}if(e.warnings)for(let t=0;t<e.warnings.length;t++)this.Obniz.warning({alert:"warning",message:`i2c${this.id}: ${e.warnings[t].message}`});if(e.errors)for(let t=0;t<e.errors.length;t++)this.Obniz.error({alert:"error",message:`i2c${this.id}: ${e.errors[t].message}`})}}isUsed(){return this.used}end(){this.state={};var e={};e["i2c"+this.id]=null,this.Obniz.send(e),this.used=!1}}},function(e,t){e.exports=class{constructor(e,t){this.Obniz=e,this.id=t,this.value=0,this.observers=[]}addObserver(e){e&&this.observers.push(e)}start(e){this.onchange=e;var t={};return t["ad"+this.id]={stream:!0},this.Obniz.send(t),this.value}getWait(){var e=this;return new Promise(function(t,r){var i={};i["ad"+e.id]={stream:!1},e.Obniz.send(i),e.addObserver(t)})}end(){this.onchange=null;var e={};e["ad"+this.id]=null,this.Obniz.send(e)}notified(e){this.value=e,this.onchange&&this.onchange(e);var t=this.observers.shift();t&&t(e)}}},function(e,t,r){const i=r(2);e.exports=class{constructor(e){this.obniz=e,this.observers=[]}echo(e){var t=i._requiredKeys(e,["io_pulse","pulse","pulse_width","io_echo","measure_edges"]);if(t)throw new Error("Measure start param '"+t+"' required, but not found ");this.params=i._keyFilter(e,["io_pulse","pulse","pulse_width","io_echo","measure_edges","timeout","callback"]);var r={};r.io_pulse=this.params.io_pulse,r.pulse=this.params.pulse,r.pulse_width=this.params.pulse_width,r.io_echo=this.params.io_echo,r.measure_edges=this.params.measure_edges,"number"==typeof this.params.timeout&&(r.timeout=this.params.timeout),this.obniz.send({measure:{echo:r}}),this.params.callback&&this.observers.push(this.params.callback)}notified(e){var t=this.observers.shift();t&&t(e.echo)}}},function(e,t,r){const i=r(2);e.exports=class{constructor(e){this.obniz=e}start(e){var t=i._requiredKeys(e,["io","interval","duration"]);if(t)throw new Error("LogicAnalyzer start param '"+t+"' required, but not found ");this.params=i._keyFilter(e,["io","interval","duration","trigerValue","trigerValueSamples"]);var r={};r.logic_analyzer={io:[this.params.io],interval:this.params.interval,duration:this.params.duration},this.params.trigerValueSamples>0&&(r.logic_analyzer.triger={value:!!this.params.trigerValue,samples:this.params.trigerValueSamples}),this.obniz.send(r)}end(){var e={logic_analyzer:null};this.obniz.send(e)}notified(e){this.onmeasured?this.onmeasured(e.data):(this.measured||(this.measured=[]),this.measured.push(e.data))}}},function(e,t){e.exports=class{constructor(e){this.Obniz=e,this.observers=[]}addObserver(e){e&&this.observers.push(e)}getWait(){let e=this;return new Promise(function(t,r){let i={switch:"get"};e.Obniz.send(i),e.addObserver(t)})}notified(e){this.state=e.state,this.onchange&&this.onchange(this.state);const t=this.observers.shift();t&&t(this.state)}}},function(e,t,r){e.exports=class{constructor(e){this.Obniz=e,this.width=128,this.height=64,this._pos={x:0,y:0},this._canvas=null}warnCanvasAvailability(){throw this.Obniz.isNode?new Error("obniz.js require node-canvas to draw rich contents. see more detail on docs"):new Error("obniz.js cant create canvas element to body")}_preparedCanvas(){if(this._canvas)return this._canvas;if(this.Obniz.isNode)try{const{createCanvas:e}=r(16);this._canvas=e(this.width,this.height)}catch(e){return null}else{const e="obnizcanvas-"+this.Obniz.id;let t=document.getElementById(e);t||((t=document.createElement("canvas")).setAttribute("id",e),t.style.visibility="hidden",t.width=this.width,t.height=this.height,t.style["-webkit-font-smoothing"]="none",document.getElementsByTagName("body")[0].appendChild(t)),this._canvas=t}const e=this._canvas.getContext("2d");return e.fillStyle="#000",e.fillRect(0,0,this.width,this.height),e.fillStyle="#FFF",e.strokeStyle="#FFF",this._pos.x=0,this._pos.y=0,this.fontSize=16,e.font=`${this.fontSize}px Arial`,this._canvas}_ctx(){const e=this._preparedCanvas();if(e)return e.getContext("2d")}font(e,t){const r=this._ctx();"number"!=typeof t&&(t=12),this.fontSize=t,r.font="0"+t+"px "+e}clear(){const e=this._ctx();e&&(e.fillStyle="#000",e.fillRect(0,0,this.width,this.height),e.fillStyle="#FFF",e.strokeStyle="#FFF"),this._pos.x=0,this._pos.y=0;var t={display:{clear:!0}};this.Obniz.send(t)}pos(e,t){return this._ctx(),"number"==typeof e&&(this._pos.x=e),"number"==typeof t&&(this._pos.y=t),this._pos}print(e){const t=this._ctx();if(t)t.fillText(e,this._pos.x,this._pos.y+this.fontSize),this.draw(t),this._pos.y+=this.fontSize;else{var r={};r.display={text:""+e},this.Obniz.send(r)}}line(e,t,r,i){const s=this._ctx();s?(s.beginPath(),s.moveTo(e,t),s.lineTo(r,i),s.stroke(),this.draw(s)):this.warnCanvasAvailability()}rect(e,t,r,i,s){const n=this._ctx();n?(s?n.fillRect(e,t,r,i):n.strokeRect(e,t,r,i),this.draw(n)):this.warnCanvasAvailability()}circle(e,t,r,i){const s=this._ctx();s?(s.beginPath(),s.arc(e,t,r,0,2*Math.PI),i?s.fill():s.stroke(),this.draw(s)):this.warnCanvasAvailability()}qr(e,t){var r={};r.display={qr:{text:e}},t&&(r.display.qr.correction=t),this.Obniz.send(r)}raw(e){var t={};t.display={raw:e},this.Obniz.send(t)}setPinName(e,t,r){var i={display:{}};i.display.pin_assign={},i.display.pin_assign[e]={module_name:t,pin_name:r},this.Obniz.send(i)}setPinNames(e,t){var r={display:{}};for(var i in r.display.pin_assign={},t)r.display.pin_assign[i]={module_name:e,pin_name:t[i]};this.Obniz.send(r)}draw(e){const t=this.width/8;let r=new Array(64*t);const i=e.getImageData(0,0,this.width,this.height).data;for(let e=0;e<i.length;e+=4){var s=.34*i[e]+.5*i[e+1]+.16*i[e+2],n=parseInt(e/4),a=parseInt(n/this.width),o=parseInt((n-a*this.width)/8),c=parseInt(n-a*this.width)%8;0==c&&(r[a*t+o]=0),s>127&&(r[a*t+o]|=128>>c)}this.raw(r)}}},function(e,t,r){const i=r(9);e.exports=class{constructor(e){this.scanTarget=null,this.Obniz=e,this.emitter=new i,this.scanedPeripherals=[]}start(e,t){let r={ble:{}};r.ble.scan={duration:t&&t.duration?t.duration:30},this.scanTarget=e,this.scanTarget&&this.scanTarget.uuids&&Array.isArray(this.scanTarget.uuids)&&(this.scanTarget.uuids=this.scanTarget.uuids.map(e=>e.toLowerCase())),this.scanedPeripherals=[],this.Obniz.send(r)}startOneWait(e,t){let r=0;return new Promise(i=>{this.emitter.once("onfind",e=>{0===r&&(r=1,this.end(),i(e))}),this.emitter.once("onfinish",()=>{0===r&&(r=1,i(null))}),this.start(e,t)})}startAllWait(e,t){return new Promise(r=>{this.emitter.once("onfinish",()=>{r(this.scanedPeripherals)}),this.start(e,t)})}end(){let e={ble:{}};e.ble.scan=null,this.Obniz.send(e)}isTarget(e){if(this.scanTarget&&this.scanTarget.localName&&e.localName()!==this.scanTarget.localName)return!1;if(this.scanTarget&&this.scanTarget.uuids){let t=e.advertisementServiceUuids();for(let e of this.scanTarget.uuids)if(!t.includes(e))return!1}return!0}onfinish(){}onfind(){}notifyFromServer(e,t){switch(e){case"onfind":this.isTarget(t)&&(this.scanedPeripherals.push(t),this.emitter.emit(e,t),this.onfind(t));break;case"onfinish":this.emitter.emit(e,this.scanedPeripherals),this.onfinish(this.scanedPeripherals)}}}},function(e,t){e.exports=class{constructor(e,t){if(this.Obniz=e,this.rows={},t&&(t.localName&&this.setCompleteLocalName(t.localName),t.manufacturerData&&t.manufacturerData.campanyCode&&t.manufacturerData.data&&this.setManufacturerSpecificData(t.manufacturerData.campanyCode,t.manufacturerData.data),t.serviceUuids))for(let e of t.serviceUuids)this.setUuid(e);"function"==typeof this.extendEvalJson&&this.extendEvalJson(t)}setRow(e,t){this.rows[e]=t}getRow(e){return this.rows[e]||[]}build(){let e=[];for(let t in this.rows)0!==this.rows[t].length&&(e.push(this.rows[t].length+1),e.push(parseInt(t)),Array.prototype.push.apply(e,this.rows[t]));return e.length>31&&this.Obniz.error("Too large data. Advertise/ScanResponse data are must be less than 32 byte."),e}setStringData(e,t){let r=[];for(let e=0;e<t.length;e++)r.push(t.charCodeAt(e));this.setRow(e,r)}setShortenedLocalName(e){this.setStringData(8,e)}setCompleteLocalName(e){this.setStringData(9,e)}setManufacturerSpecificData(e,t){let r=[];r.push(255&e),r.push(e>>8&255),Array.prototype.push.apply(r,t),this.setRow(255,r)}setUuid(e){let t=this.convertUuid(e),r={16:6,4:4,2:2}[t.length];this.setRow(r,t)}convertUuid(e){let t=e.toLowerCase().replace(/[^0-9abcdef]/g,"");32!==t.length&&8!==t.length&&4!==t.length&&this.Obniz.error("BLE uuid must be 16/32/128 bit . (example: c28f0ad5-a7fd-48be-9fd0-eae9ffd3a8bb for 128bit)");let r=[];for(let e=t.length;e>1;e-=2)r.push(parseInt(t[e-2]+t[e-1],16));return r}setIbeaconData(e,t,r,i){let s=[];s.push(2,21);let n=this.convertUuid(e);Array.prototype.push.apply(s,n),s.push(t>>8&255),s.push(t>>0&255),s.push(r>>8&255),s.push(r>>0&255),s.push(i>>0&255),this.setManufacturerSpecificData(76,s)}extendEvalJson(e){e&&e.flags&&(e.flags.includes("limited_discoverable_mode")&&this.setLeLimitedDiscoverableModeFlag(),e.flags.includes("general_discoverable_mode")&&this.setLeGeneralDiscoverableModeFlag(),e.flags.includes("br_edr_not_supported")&&this.setBrEdrNotSupportedFlag(),e.flags.includes("le_br_edr_controller")&&this.setLeBrEdrControllerFlag(),e.flags.includes("le_br_edr_host")&&this.setLeBrEdrHostFlag())}setFlags(e){let t=this.getRow(1);t[0]=(t[0]||0)|e,this.setRow(1,t)}setLeLimitedDiscoverableModeFlag(){this.setFlags(1)}setLeGeneralDiscoverableModeFlag(){this.setFlags(2)}setBrEdrNotSupportedFlag(){this.setFlags(4)}setLeBrEdrControllerFlag(){this.setFlags(8)}setLeBrEdrHostFlag(){this.setFlags(16)}}},function(e,t,r){const i=r(234);e.exports=class{constructor(e){this.Obniz=e,this.adv_data=[],this.scan_resp=[]}start(){let e={ble:{}};e.ble.advertisement={adv_data:this.adv_data},this.scan_resp.length>0&&(e.ble.advertisement.scan_resp=this.scan_resp),this.Obniz.send(e)}end(){let e={ble:{}};e.ble.advertisement=null,this.Obniz.send(e)}setAdvDataRaw(e){this.adv_data=e}setAdvData(e){let t=this.advDataBulider(e);this.setAdvDataRaw(t.build())}advDataBulider(e){return new i(this.Obniz,e)}scanRespDataBuilder(e){return new i(this.Obniz,e)}setScanRespDataRaw(e){this.scan_resp=e}setScanRespData(e){this.setScanRespDataRaw(this.scanRespDataBuilder(e).build())}}},function(e,t,r){const i=r(8);e.exports=class extends i{constructor(e){super(e)}get parentName(){return"characteristic"}read(){const e={ble:{read_descriptor:{address:this.characteristic.service.peripheral.address,service_uuid:this.characteristic.service.uuid,characteristic_uuid:this.characteristic.uuid,descriptor_uuid:this.uuid}}};this.characteristic.service.peripheral.Obniz.send(e)}write(e){const t={ble:{write_descriptor:{address:this.characteristic.service.peripheral.address,service_uuid:this.characteristic.service.uuid,characteristic_uuid:this.characteristic.uuid,descriptor_uuid:this.uuid,data:e}}};this.characteristic.service.peripheral.Obniz.send(t)}}},function(e,t,r){const i=r(236),s=r(8);e.exports=class extends s{constructor(e){super(e),this.properties=e.properties||[],Array.isArray(this.properties)||(this.properties=[this.properties])}get parentName(){return"service"}get childrenClass(){return i}get childrenName(){return"descriptors"}addDescriptor(e){return this.addChild(e)}getDescriptor(e){let t=this.getChild(e);if(t)return t;let r=new i(this.Obniz,this,e);return this.addChild(r),r}registerNotify(e){this.onnotify=e;const t={ble:{register_notify_characteristic:{address:this.service.peripheral.address,service_uuid:this.service.uuid,characteristic_uuid:this.uuid}}};this.service.peripheral.Obniz.send(t)}unregisterNotify(){this.onnotify=function(){};const e={ble:{unregister_notify_characteristic:{address:this.service.peripheral.address,service_uuid:this.service.uuid,characteristic_uuid:this.uuid}}};this.service.peripheral.Obniz.send(e)}read(){const e={ble:{read_characteristic:{address:this.service.peripheral.address,service_uuid:this.service.uuid,characteristic_uuid:this.uuid}}};this.service.peripheral.Obniz.send(e)}write(e){const t={ble:{write_characteristic:{address:this.service.peripheral.address,service_uuid:this.service.uuid,characteristic_uuid:this.uuid,data:e}}};this.service.peripheral.Obniz.send(t)}discoverChildren(){const e={ble:{get_descriptors:{address:this.service.peripheral.address,service_uuid:this.service.uuid,characteristic_uuid:this.uuid}}};this.service.peripheral.Obniz.send(e)}discoverAllDescriptors(){return this.discoverChildren()}discoverAllDescriptorsWait(){return this.discoverChildrenWait()}toJSON(){let e=super.toJSON();return this.properties.length>0&&(e.properties=this.properties),e}canBroadcast(){return this.properties.includes("broadcast")}canNotify(){return this.properties.includes("notify")}canRead(){return this.properties.includes("read")}canWrite(){return this.properties.includes("write")}canWriteWithoutResponse(){return this.properties.includes("write_without_response")}canIndicate(){return this.properties.includes("indicate")}ondiscover(e){this.ondiscoverdescriptor(e)}ondiscoverfinished(e){this.ondiscoverdescriptorfinished(e)}ondiscoverdescriptor(){}ondiscoverdescriptorfinished(){}onregisternofity(){}onunregisternofity(){}onnotify(){}notifyFromServer(e,t){switch(super.notifyFromServer(e,t),e){case"onregisternofity":this.onregisternofity();break;case"onunregisternofity":this.onunregisternofity();break;case"onnotify":this.onnotify()}}}},function(e,t,r){const i=r(237),s=r(8);e.exports=class extends s{constructor(e){super(e)}get parentName(){return"peripheral"}get childrenClass(){return i}get childrenName(){return"characteristics"}addCharacteristic(e){return this.addChild(e)}getCharacteristic(e){return this.getChild(e)}discoverAllCharacteristics(){return this.discoverChildren()}discoverAllCharacteristicsWait(){return this.discoverChildrenWait()}discoverChildren(){const e={ble:{get_characteristics:{address:this.peripheral.address,service_uuid:this.uuid}}};this.parent.Obniz.send(e)}ondiscover(e){this.ondiscovercharacteristic(e)}ondiscoverfinished(e){this.ondiscovercharacteristicfinished(e)}ondiscovercharacteristic(){}ondiscovercharacteristicfinished(){}}},function(e,t,r){const i=r(238),s=r(9);e.exports=class{constructor(e,t){this.Obniz=e,this.address=t,this.connected=!1,this.device_type=null,this.address_type=null,this.ble_event_type=null,this.rssi=null,this.adv_data=null,this.scan_resp=null,this.keys=["device_type","address_type","ble_event_type","rssi","adv_data","scan_resp"],this.services=[],this.emitter=new s}toString(){return JSON.stringify({address:this.address,addressType:this.address_type,advertisement:this.adv_data,scanResponse:this.scan_resp,rssi:this.rssi})}setParams(e){for(let t in e)e.hasOwnProperty(t)&&this.keys.includes(t)&&(this[t]=e[t])}analyseAdvertisement(){if(!this.advertise_data_rows){if(this.advertise_data_rows=[],this.adv_data)for(let e=0;e<this.adv_data.length;e++){let t=this.adv_data[e],r=new Array(t);for(let i=0;i<t;i++)r[i]=this.adv_data[e+i+1];this.advertise_data_rows.push(r),e+=t}if(this.scan_resp)for(let e=0;e<this.scan_resp.length;e++){let t=this.scan_resp[e],r=new Array(t);for(let i=0;i<t;i++)r[i]=this.scan_resp[e+i+1];this.advertise_data_rows.push(r),e+=t}}}searchTypeVal(e){this.analyseAdvertisement();for(let t=0;t<this.advertise_data_rows.length;t++)if(this.advertise_data_rows[t][0]===e){let e=[].concat(this.advertise_data_rows[t]);return e.shift(),e}}get localName(){let e=this.searchTypeVal(9);return e||(e=this.searchTypeVal(8)),e?String.fromCharCode.apply(null,e):null}get iBeacon(){let e=this.searchTypeVal(255);if(!e||76!==e[0]||0!==e[1]||2!==e[2]||21!==e[3]||25!==e.length)return null;let t=e.slice(4,20),r="";for(let e=0;e<t.length;e++)r+=("00"+t[e].toString(16)).slice(-2),3!==e&&5!==e&&7!==e&&9!==e||(r+="-");return{uuid:r,major:(e[20]<<8)+e[21],minor:(e[22]<<8)+e[23],power:e[24],rssi:this.rssi}}_addServiceUuids(e,t,r){if(!t)return;let i=r/4;for(let r=0;r<t.length;r+=i){let s=t.slice(r,r+i);e.push(this.Obniz.ble.constructor._dataArray2uuidHex(s,!0))}}advertisementServiceUuids(){let e=[];return this._addServiceUuids(e,this.searchTypeVal(2),16),this._addServiceUuids(e,this.searchTypeVal(3),16),this._addServiceUuids(e,this.searchTypeVal(4),32),this._addServiceUuids(e,this.searchTypeVal(5),32),this._addServiceUuids(e,this.searchTypeVal(6),64),this._addServiceUuids(e,this.searchTypeVal(7),64),e}connect(){let e={ble:{connect:{address:this.address}}};this.Obniz.send(e)}connectWait(){return new Promise(e=>{this.emitter.once("statusupdate",t=>{e("connected"===t.status)}),this.connect()})}disconnect(){let e={ble:{disconnect:{address:this.address}}};this.Obniz.send(e)}disconnectWait(){return new Promise(e=>{this.emitter.once("statusupdate",t=>{e("disconnected"===t.status)}),this.disconnect()})}getService(e){e=e.toLowerCase();for(let t in this.services)if(this.services[t].uuid===e)return this.services[t];let t=new i({uuid:e});return t.parent=this,this.services.push(t),t}findService(e){let t=e.service_uuid.toLowerCase();return this.getService(t)}findCharacteristic(e){let t=e.service_uuid.toLowerCase(),r=e.characteristic_uuid.toLowerCase(),i=this.getService(t);return i?i.getCharacteristic(r):null}findDescriptor(e){let t=e.descriptor_uuid.toLowerCase(),r=this.findCharacteristic(e);return r?r.getDescriptor(t):null}discoverAllServices(){let e={ble:{get_services:{address:this.address}}};this.Obniz.send(e)}discoverAllServicesWait(){return new Promise(e=>{this.emitter.once("discoverfinished",()=>{let t=this.services.filter(e=>e.discoverdOnRemote);e(t)}),this.discoverAllServices()})}onconnect(){}ondisconnect(){}ondiscoverservice(){}ondiscoverservicefinished(){}ondiscover(){}ondiscoverfinished(){}notifyFromServer(e,t){switch(this.emitter.emit(e,t),e){case"statusupdate":"connected"===t.status&&(this.connected=!0,this.onconnect()),"disconnected"===t.status&&(this.connected=!1,this.ondisconnect());break;case"discover":{let e=this.getService(t.service_uuid);e.discoverdOnRemote=!0,this.ondiscoverservice(e);break}case"discoverfinished":{let e=this.services.filter(e=>e.discoverdOnRemote);this.ondiscoverservicefinished(e);break}}}onerror(){}}},function(e,t,r){var i=r(4),s=i.Buffer;function n(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return s(e,t,r)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=i:(n(i,t),t.Buffer=a),n(s,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return s(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=s(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},function(e,t,r){"use strict";var i=r(240).Buffer,s=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===s||!s(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=d,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=h,this.end=u,t=3;break;default:return this.write=l,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:-1}function o(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"".repeat(r);if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"".repeat(r+1);if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"".repeat(r+2)}}(this,e,t);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function d(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function h(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function u(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function l(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}t.StringDecoder=n,n.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},n.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"".repeat(this.lastTotal-this.lastNeed):t},n.prototype.text=function(e,t){var r=function(e,t,r){var i=t.length-1;if(i<r)return 0;var s=a(t[i]);if(s>=0)return s>0&&(e.lastNeed=s-1),s;if(--i<r)return 0;if((s=a(t[i]))>=0)return s>0&&(e.lastNeed=s-2),s;if(--i<r)return 0;if((s=a(t[i]))>=0)return s>0&&(2===s?s=0:e.lastNeed=s-3),s;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},n.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t){t.read=function(e,t,r,i,s){var n,a,o=8*s-i-1,c=(1<<o)-1,d=c>>1,h=-7,u=r?s-1:0,l=r?-1:1,p=e[t+u];for(u+=l,n=p&(1<<-h)-1,p>>=-h,h+=o;h>0;n=256*n+e[t+u],u+=l,h-=8);for(a=n&(1<<-h)-1,n>>=-h,h+=i;h>0;a=256*a+e[t+u],u+=l,h-=8);if(0===n)n=1-d;else{if(n===c)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,i),n-=d}return(p?-1:1)*a*Math.pow(2,n-i)},t.write=function(e,t,r,i,s,n){var a,o,c,d=8*n-s-1,h=(1<<d)-1,u=h>>1,l=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:n-1,m=i?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=h):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+u>=1?l/c:l*Math.pow(2,1-u))*c>=2&&(a++,c/=2),a+u>=h?(o=0,a=h):a+u>=1?(o=(t*c-1)*Math.pow(2,s),a+=u):(o=t*Math.pow(2,u-1)*Math.pow(2,s),a=0));s>=8;e[r+p]=255&o,p+=m,o/=256,s-=8);for(a=a<<s|o,d+=s;d>0;e[r+p]=255&a,p+=m,a/=256,d-=8);e[r+p-m]|=128*f}},function(e,t,r){"use strict";t.byteLength=function(e){return 3*e.length/4-d(e)},t.toByteArray=function(e){var t,r,i,a,o,c=e.length;a=d(e),o=new n(3*c/4-a),r=a>0?c-4:c;var h=0;for(t=0;t<r;t+=4)i=s[e.charCodeAt(t)]<<18|s[e.charCodeAt(t+1)]<<12|s[e.charCodeAt(t+2)]<<6|s[e.charCodeAt(t+3)],o[h++]=i>>16&255,o[h++]=i>>8&255,o[h++]=255&i;2===a?(i=s[e.charCodeAt(t)]<<2|s[e.charCodeAt(t+1)]>>4,o[h++]=255&i):1===a&&(i=s[e.charCodeAt(t)]<<10|s[e.charCodeAt(t+1)]<<4|s[e.charCodeAt(t+2)]>>2,o[h++]=i>>8&255,o[h++]=255&i);return o},t.fromByteArray=function(e){for(var t,r=e.length,s=r%3,n="",a=[],o=0,c=r-s;o<c;o+=16383)a.push(h(e,o,o+16383>c?c:o+16383));1===s?(t=e[r-1],n+=i[t>>2],n+=i[t<<4&63],n+="=="):2===s&&(t=(e[r-2]<<8)+e[r-1],n+=i[t>>10],n+=i[t>>4&63],n+=i[t<<2&63],n+="=");return a.push(n),a.join("")};for(var i=[],s=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,c=a.length;o<c;++o)i[o]=a[o],s[a.charCodeAt(o)]=o;function d(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function h(e,t,r){for(var s,n,a=[],o=t;o<r;o+=3)s=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(i[(n=s)>>18&63]+i[n>>12&63]+i[n>>6&63]+i[63&n]);return a.join("")}s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){const i=r(17);e.exports=class{constructor(e){this.Obniz=e,this.services=[]}addService(e){e instanceof i||(e=new i(e)),this.services.push(e),e.peripheral=this,this.Obniz.send({ble:{peripheral:{services:[e]}}})}setJson(e){if(e.services)for(let t of e.services)this.addService(t)}getService(e){return e=e.toLowerCase(),this.services.filter(function(t){return t.uuid.toLowerCase()===e}).shift()}removeService(e){this.services=this.services.filter(function(t){return t.uuid.toLowerCase()!==e})}stopAllService(){this.Obniz.send({ble:{peripheral:null}}),this.services=[]}toJSON(){return{services:this.services}}findCharacteristic(e){let t=e.service_uuid.toLowerCase(),r=e.characteristic_uuid.toLowerCase(),i=this.getService(t);return i?i.getCharacteristic(r):null}findDescriptor(e){let t=e.descriptor_uuid.toLowerCase(),r=this.findCharacteristic(e);return r?r.getDescriptor(t):null}end(){this.Obniz.send({ble:{peripheral:null}})}onconnectionupdates(){}onerror(){}}},function(e,t,r){const i=r(246),s=r(17),n=r(15),a=r(14),o=r(239),c=r(235),d=r(233);e.exports=class{constructor(e){this.Obniz=e,this.remotePeripherals=[],this.service=s,this.characteristic=n,this.descriptor=a,this.peripheral=new i(e),this.scanTarget=null,this.advertisement=new c(e),this.scan=new d(e)}findPeripheral(e){for(let t in this.remotePeripherals)if(this.remotePeripherals[t].address===e)return this.remotePeripherals[t];return null}notified(e){if(e.scan_result){let t=this.findPeripheral(e.scan_result.address);t||(t=new o(this.Obniz,e.scan_result.address),this.remotePeripherals.push(t)),t.discoverdOnRemote=!0,t.setParams(e.scan_result),this.scan.notifyFromServer("onfind",t)}e.scan_result_finish&&this.scan.notifyFromServer("onfinish");let t=function(e,t,r){let i=null;if(void 0===e)return;let s=this.findPeripheral(e.address);s&&("peripheral"===r?i=s:"service"===r?i=s.findService(e):"characteristic"===r?i=s.findCharacteristic(e):"descriptor"===r&&(i=s.findDescriptor(e)),i&&t(e,i))}.bind(this);const r={status_update:{name:"statusupdate",obj:"peripheral"},get_service_result:{name:"discover",obj:"peripheral"},get_service_result_finish:{name:"discoverfinished",obj:"peripheral"},get_characteristic_result:{name:"discover",obj:"service"},get_characteristic_result_finish:{name:"discoverfinished",obj:"service"},write_characteristic_result:{name:"onwrite",obj:"characteristic"},read_characteristic_result:{name:"onread",obj:"characteristic"},register_notify_characteristic_result:{name:"onregisternotify",obj:"characteristic"},unregister_notify_characteristic_result:{name:"onunregisternotify",obj:"characteristic"},nofity_characteristic:{name:"onnotify",obj:"characteristic"},get_descriptor_result:{name:"discover",obj:"characteristic"},get_descriptor_result_finish:{name:"discoverfinished",obj:"characteristic"},write_descriptor_result:{name:"onwrite",obj:"descriptor"},read_descriptor_result:{name:"onread",obj:"descriptor"}};for(let i in r)t(e[i],function(e,t){t.notifyFromServer(r[i].name,e)}.bind(this),r[i].obj);let i=function(e,t,r){let i=null;void 0!==e&&("peripheral"===r?i=this.peripheral:"service"===r?i=this.peripheral.getService(e):"characteristic"===r?i=this.peripheral.findCharacteristic(e):"descriptor"===r&&(i=this.peripheral.findDescriptor(e)),i&&t(e,i))}.bind(this);if(e.peripheral){i(e.peripheral.connection_status,function(e){this.peripheral.onconnectionupdates(e)}.bind(this),"peripheral");const t={read_characteristic_result:{name:"onread",obj:"characteristic"},write_characteristic_result:{name:"onwrite",obj:"characteristic"},notify_read_characteristic:{name:"onreadfromremote",obj:"characteristic"},notify_write_characteristic:{name:"onwritefromremote",obj:"characteristic"},read_descriptor_result:{name:"onread",obj:"descriptor"},write_descriptor_result:{name:"onwrite",obj:"descriptor"},notify_read_descriptor:{name:"onreadfromremote",obj:"descriptor"},notify_write_descriptor:{name:"onwritefromremote",obj:"descriptor"}};for(let r in t)i(e.peripheral[r],function(e,i){i.notifyFromServer(t[r].name,e)}.bind(this),t[r].obj)}if(e.error){let t,r,i=e.error,s=!1;(t=i.address?this.findPeripheral(i.address):this.peripheral)&&(i.service_uuid&&i.characteristic_uuid&&i.descriptor_uuid?r=t.findDescriptor(i):i.service_uuid&&i.characteristic_uuid?r=t.findCharacteristic(i):i.service_uuid&&(r=t.findService(i)),r?(r.notifyFromServer("onerror",i),s=!0):(t.onerror(i),s=!0)),s||this.Obniz.error(`ble ${i.message} service=${i.service_uuid} characteristic_uuid=${i.characteristic_uuid} descriptor_uuid=${i.descriptor_uuid}`)}}static _dataArray2uuidHex(e,t){let r=[];for(let t=0;t<e.length;t++)r.push(("00"+e[t].toString(16).toLowerCase()).slice(-2));t&&(r=r.reverse());let i=r.join("");return r.length>=16&&(i=i.slice(0,8)+"-"+i.slice(8,12)+"-"+i.slice(12,16)+"-"+i.slice(16,20)+"-"+i.slice(20)),i}}},function(e,t,r){const i=r(247),s=r(232),n=r(231),a=r(230),o=r(229),c=r(228),d=r(227),h=r(226),u=r(225),l=r(224),p=r(223),m=r(222),f=r(2),g=r(221);e.exports=class extends g{constructor(e,t){super(e,t),this.pongObservers=[]}_prepareComponents(){this.io=new u(this);for(let e=0;e<12;e++)this["io"+e]=new h(this,e);for(let e=0;e<12;e++)this["ad"+e]=new c(this,e);for(let e=0;e<2;e++)this["uart"+e]=new m(this,e);for(let e=0;e<2;e++)this["spi"+e]=new p(this,e);for(let e=0;e<1;e++)this["i2c"+e]=new d(this,e);for(let e=0;e<6;e++)this["pwm"+e]=new l(this,e);this.display=new s(this),this.switch=new n(this),this.logicAnalyzer=new a(this),this.ble=new i(this),this.measure=new o(this),this.util=new f(this)}notifyToModule(e){super.notifyToModule(e);const t=["io","uart","spi","i2c","ad"];for(let r=0;r<t.length;r++){const i=t[r];let s=-1;for(;this[i+""+ ++s];){let t=e[i+""+s];void 0!==t&&this[i+""+s].notified(t)}}const r=["switch","ble","measure"];for(let t=0;t<r.length;t++)e[r[t]]&&this[r[t]].notified(e[r[t]]);e.logic_analyzer&&this.logicAnalyzer.notified(e.logic_analyzer)}handleSystemCommand(e){if(super.handleSystemCommand(e),e.pong)for(let t of this.pongObservers)t(e)}addPongObserver(e){e&&this.pongObservers.push(e)}removePongObserver(e){if(this.pongObservers.includes(e)){let t=this.pongObservers.indexOf(e);this.pongObservers.splice(t,1)}}isValidIO(e){return"number"==typeof e&&e>=0&&e<12}setVccGnd(e,t,r){this.isValidIO(e)&&(r&&this.getIO(e).drive(r),this.getIO(e).output(!0)),this.isValidIO(t)&&(r&&this.getIO(t).drive(r),this.getIO(t).output(!1))}getIO(e){if(!this.isValidIO(e))throw new Error("io "+e+" is not valid io");return this["io"+e]}getAD(e){if(!this.isValidIO(e))throw new Error("ad "+e+" is not valid io");return this["ad"+e]}getFreePwm(){let e=0;for(;;){let t=this["pwm"+e];if(!t)break;if(!t.isUsed())return t.used=!0,t;e++}throw new Error("No More PWM Available. max = "+e)}getFreeI2C(){let e=0;for(;;){let t=this["i2c"+e];if(!t)break;if(!t.isUsed())return t.used=!0,t;e++}throw new Error("No More I2C Available. max = "+e)}getI2CWithConfig(e){if("object"!=typeof e)throw new Error("getI2CWithConfig need config arg");if(e.i2c)return e.i2c;let t=this.getFreeI2C();return t.start(e),t}getFreeSpi(){let e=0;for(;;){let t=this["spi"+e];if(!t)break;if(!t.isUsed())return t.used=!0,t;e++}throw new Error("No More SPI Available. max = "+e)}getSpiWithConfig(e){if("object"!=typeof e)throw new Error("getSpiWithConfig need config arg");if(e.spi)return e.spi;let t=this.getFreeSpi();return t.start(e),t}getFreeUart(){let e=0;for(;;){let t=this["uart"+e];if(!t)break;if(!t.isUsed())return t.used=!0,t;e++}throw new Error("No More uart Available. max = "+e)}}},function(e,t,r){const i=r(248);e.exports=class extends i{constructor(e,t){super(e,t)}wait(e){return e<0?e=0:e>6e4&&(e=6e4),this.send({system:{wait:e}}),new Promise(t=>setTimeout(t,e))}reset(){this.send({system:{reset:!0}}),this._prepareComponents()}reboot(){this.send({system:{reboot:!0}}),this._prepareComponents()}selfCheck(){this.send({system:{self_check:!0}})}keepWorkingAtOffline(e){this.send({system:{keep_working_at_offline:e}})}resetOnDisconnect(e){this.send({ws:{reset_obniz_on_ws_disconnection:e}})}pingWait(e,t,r){e=e||(new Date).getTime();let i=Math.floor(e/Math.pow(2,32)),s=e-i*Math.pow(2,32);t=t||Math.floor(Math.random()*Math.pow(2,4));let n=[];n.push(i>>>24&255),n.push(i>>>16&255),n.push(i>>>8&255),n.push(i>>>0&255),n.push(s>>>24&255),n.push(s>>>16&255),n.push(s>>>8&255),n.push(s>>>0&255),n.push(t>>>24&255),n.push(t>>>16&255),n.push(t>>>8&255),n.push(t>>>0&255);let a={system:{ping:{key:n}}};return this.send(a,{local_connect:!r}),new Promise(e=>{let t=r=>{for(let e=0;e<n.length;e++)if(n[e]!==r.pong.key[e])return;this.removePongObserver(t);let i=(r.pong.key[0]<<24>>>0)+(r.pong.key[1]<<16>>>0)+(r.pong.key[2]<<8>>>0)+(r.pong.key[3]<<0>>>0),s=(r.pong.key[4]<<24>>>0)+(r.pong.key[5]<<16>>>0)+(r.pong.key[6]<<8>>>0)+(r.pong.key[7]<<0>>>0),a=i*Math.pow(2,32)+s,o=(new Date).getTime(),c=`ping ${o-a}ms (js --[${r.pong.pingServerTime-a}ms]--\x3e server --[${r.pong.obnizTime-r.pong.pingServerTime}ms]--\x3e obniz --[${r.pong.pongServerTime-r.pong.obnizTime}ms]--\x3e server --[${o-r.pong.pongServerTime}ms]--\x3e js)`;this.print_debug(c),e(c)};this.addPongObserver(t)})}}},function(e,t,r){const i=r(249);e.exports=class extends i{constructor(e,t){super(e,t)}wsconnect(e){if(this.showOffLine(),this.isValidObnizId(this.id))super.wsconnect(e);else if(this.isNode)this.error("invalid obniz id");else{let t=function(e){let t=e+"=",r=document.cookie.split(";");for(let e=0;e<r.length;e++){let i=r[e];for(;" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null}("obniz-last-used")||"";this.prompt(t,function(t){this.id=t,this.wsconnect(e)}.bind(this))}}showAlertUI(e){if(this.isNode||!document.getElementById(this.options.debug_dom_id))return;let t=`\n    <div style="background-color:${"warning"===e.alert?"#ffee35":"#ff7b34"}">${e.message}</div>`;document.getElementById(this.options.debug_dom_id).insertAdjacentHTML("beforeend",t)}getDebugDoms(){if(this.isNode)return;let e=document.querySelector("#loader"),t=document.querySelector("#"+this.options.debug_dom_id),r=document.querySelector("#"+this.options.debug_dom_id+" #online-status");return t&&!r&&((r=document.createElement("div")).id="online-status",r.style.color="#FFF",r.style.padding="5px",r.style.textAlign="center",t.insertBefore(r,t.firstChild)),{loaderDom:e,debugDom:t,statusDom:r}}_callOnConnect(){this.updateOnlineUI(),super._callOnConnect()}close(){super.close(),this.updateOnlineUI()}_disconnectLocal(){super._disconnectLocal(),this.updateOnlineUI()}updateOnlineUI(){if(this.isNode)return;const e=this.socket&&1===this.socket.readyState,t=this.socket_local&&1===this.socket_local.readyState;e&&t?this.showOnLine(!0):e?this.showOnLine(!1):this.showOffLine()}showOnLine(e){if(this.isNode)return;const t=this.getDebugDoms();t.loaderDom&&(t.loaderDom.style.display="none"),t.statusDom&&(t.statusDom.style.backgroundColor=e?"#0cd362":"#31965d",t.statusDom.style.color="#FFF",t.statusDom.innerHTML=this.id?"online : "+this.id:"online")}showOffLine(){if(this.isNode)return;const e=this.getDebugDoms();e.loaderDom&&(e.loaderDom.style.display="block"),e.statusDom&&(e.statusDom.style.backgroundColor="#d9534f",e.statusDom.style.color="#FFF",e.statusDom.innerHTML=this.id?"offline : "+this.id:"offline")}}}]);