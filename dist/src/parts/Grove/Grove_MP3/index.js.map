{"version":3,"sources":["../src/parts/Grove/Grove_MP3/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import Obniz from \"../../../obniz\";\nimport ObnizPartsInterface, {ObnizPartsInfo} from \"../../../obniz/ObnizPartsInterface\";\n\n/**\n * @category Parts\n */\nexport interface  Grove_MP3Options {\n  vcc?: number;\n  gnd?: number;\n  mp3_rx: number;\n  mp3_tx: number;\n}\n\n/**\n * @category Parts\n */\nexport default class Grove_MP3 implements ObnizPartsInterface {\n\n  public static info(): ObnizPartsInfo {\n    return {\n      name: \"Grove_MP3\",\n    };\n  }\n\n  public keys: string[];\n  public requiredKeys: string[];\n  public ioKeys: string[];\n  public displayName: any;\n  public displayIoNames: any;\n  public obniz!: Obniz;\n  public params: any;\n  public my_tx: any;\n  public my_rx: any;\n  public uart: any;\n\n  constructor() {\n    this.keys = [\"vcc\", \"gnd\", \"mp3_rx\", \"mp3_tx\"];\n    this.requiredKeys = [\"mp3_rx\", \"mp3_tx\"];\n\n    this.ioKeys = this.keys;\n    this.displayName = \"MP3\";\n    this.displayIoNames = {mp3_rx: \"MP3Rx\", mp3_tx: \"MP3Tx\"};\n  }\n\n  public wired(obniz: Obniz) {\n    this.obniz = obniz;\n    obniz.setVccGnd(this.params.vcc, this.params.gnd, \"5v\");\n\n    this.my_tx = this.params.mp3_rx;\n    this.my_rx = this.params.mp3_tx;\n\n    this.uart = this.obniz.getFreeUart();\n  }\n\n  public async initWait(strage: any) {\n    this.uart.start({\n      tx: this.my_tx,\n      rx: this.my_rx,\n      baud: 9600,\n    });\n    await this.obniz.wait(100);\n    this.uartSend(0x0c, 0);\n    await this.obniz.wait(500);\n    this.uartSend(0x0b, 0);\n    await this.obniz.wait(100);\n\n    if (strage) {\n      if (strage === \"usb\") {\n        this.uartSend(0x09, 1);\n      } else if (strage === \"sd\") {\n        this.uartSend(0x09, 2);\n      }\n    } else {\n      this.uartSend(0x09, 2);\n    }\n    await this.obniz.wait(200);\n  }\n\n  public setVolume(vol: number) {\n    if (vol >= 0 && vol <= 31) {\n      this.uartSend(0x06, vol);\n    }\n  }\n\n  public volUp() {\n    this.uartSend(0x04, 0);\n  }\n\n  public volDown() {\n    this.uartSend(0x05, 0);\n  }\n\n  public play(track: any, folder: any) {\n    // if (!folder) folder = {};\n    if (folder) {\n      this.uart.send([0x7e, 0xff, 0x06, 0x0f, 0x00, folder, track, 0xef]);\n    } else {\n      // Play 'MP3' folder\n      this.uartSend(0x12, track);\n    }\n  }\n\n  public stop() {\n    this.uartSend(0x16, 0);\n  }\n\n  public pause() {\n    this.uartSend(0x0e, 0);\n  }\n\n  public resume() {\n    this.uartSend(0x0d, 0);\n  }\n\n  public next() {\n    this.uartSend(0x01, 0);\n  }\n\n  public prev() {\n    this.uartSend(0x02, 0);\n  }\n\n  public uartSend(command: any, param: any) {\n    const paramM: any = param >> 8;\n    const paramL: any = param & 0xff;\n    this.uart.send([0x7e, 0xff, 0x06, command, 0x01, paramM, paramL, 0xef]);\n    const response: any = this.uart.readBytes();\n    return response;\n    // return response;\n  }\n}\n"]}