{"version":3,"sources":["../src/parts/Grove/Grove_MP3/index.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,gBAAgB,CAAC;AACnC,OAAO,mBAAmB,EAAE,EAAC,cAAc,EAAC,MAAM,oCAAoC,CAAC;AAEvF;;GAEG;AACH,MAAM,WAAY,gBAAgB;IAChC,GAAG,CAAC,EAAE,MAAM,CAAC;IACb,GAAG,CAAC,EAAE,MAAM,CAAC;IACb,MAAM,EAAE,MAAM,CAAC;IACf,MAAM,EAAE,MAAM,CAAC;CAChB;AAED;;GAEG;AACH,MAAM,CAAC,OAAO,OAAO,SAAU,YAAW,mBAAmB;WAE7C,IAAI,IAAI,cAAc;IAM7B,IAAI,EAAE,MAAM,EAAE,CAAC;IACf,YAAY,EAAE,MAAM,EAAE,CAAC;IACvB,MAAM,EAAE,MAAM,EAAE,CAAC;IACjB,WAAW,EAAE,GAAG,CAAC;IACjB,cAAc,EAAE,GAAG,CAAC;IACpB,KAAK,EAAG,KAAK,CAAC;IACd,MAAM,EAAE,GAAG,CAAC;IACZ,KAAK,EAAE,GAAG,CAAC;IACX,KAAK,EAAE,GAAG,CAAC;IACX,IAAI,EAAE,GAAG,CAAC;;IAWV,KAAK,CAAC,KAAK,EAAE,KAAK;IAUZ,QAAQ,CAAC,MAAM,EAAE,GAAG;IAwB1B,SAAS,CAAC,GAAG,EAAE,MAAM;IAMrB,KAAK;IAIL,OAAO;IAIP,IAAI,CAAC,KAAK,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG;IAU5B,IAAI;IAIJ,KAAK;IAIL,MAAM;IAIN,IAAI;IAIJ,IAAI;IAIJ,QAAQ,CAAC,OAAO,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG;CAQzC","file":"index.d.ts","sourcesContent":["import Obniz from \"../../../obniz\";\nimport ObnizPartsInterface, {ObnizPartsInfo} from \"../../../obniz/ObnizPartsInterface\";\n\n/**\n * @category Parts\n */\nexport interface  Grove_MP3Options {\n  vcc?: number;\n  gnd?: number;\n  mp3_rx: number;\n  mp3_tx: number;\n}\n\n/**\n * @category Parts\n */\nexport default class Grove_MP3 implements ObnizPartsInterface {\n\n  public static info(): ObnizPartsInfo {\n    return {\n      name: \"Grove_MP3\",\n    };\n  }\n\n  public keys: string[];\n  public requiredKeys: string[];\n  public ioKeys: string[];\n  public displayName: any;\n  public displayIoNames: any;\n  public obniz!: Obniz;\n  public params: any;\n  public my_tx: any;\n  public my_rx: any;\n  public uart: any;\n\n  constructor() {\n    this.keys = [\"vcc\", \"gnd\", \"mp3_rx\", \"mp3_tx\"];\n    this.requiredKeys = [\"mp3_rx\", \"mp3_tx\"];\n\n    this.ioKeys = this.keys;\n    this.displayName = \"MP3\";\n    this.displayIoNames = {mp3_rx: \"MP3Rx\", mp3_tx: \"MP3Tx\"};\n  }\n\n  public wired(obniz: Obniz) {\n    this.obniz = obniz;\n    obniz.setVccGnd(this.params.vcc, this.params.gnd, \"5v\");\n\n    this.my_tx = this.params.mp3_rx;\n    this.my_rx = this.params.mp3_tx;\n\n    this.uart = this.obniz.getFreeUart();\n  }\n\n  public async initWait(strage: any) {\n    this.uart.start({\n      tx: this.my_tx,\n      rx: this.my_rx,\n      baud: 9600,\n    });\n    await this.obniz.wait(100);\n    this.uartSend(0x0c, 0);\n    await this.obniz.wait(500);\n    this.uartSend(0x0b, 0);\n    await this.obniz.wait(100);\n\n    if (strage) {\n      if (strage === \"usb\") {\n        this.uartSend(0x09, 1);\n      } else if (strage === \"sd\") {\n        this.uartSend(0x09, 2);\n      }\n    } else {\n      this.uartSend(0x09, 2);\n    }\n    await this.obniz.wait(200);\n  }\n\n  public setVolume(vol: number) {\n    if (vol >= 0 && vol <= 31) {\n      this.uartSend(0x06, vol);\n    }\n  }\n\n  public volUp() {\n    this.uartSend(0x04, 0);\n  }\n\n  public volDown() {\n    this.uartSend(0x05, 0);\n  }\n\n  public play(track: any, folder: any) {\n    // if (!folder) folder = {};\n    if (folder) {\n      this.uart.send([0x7e, 0xff, 0x06, 0x0f, 0x00, folder, track, 0xef]);\n    } else {\n      // Play 'MP3' folder\n      this.uartSend(0x12, track);\n    }\n  }\n\n  public stop() {\n    this.uartSend(0x16, 0);\n  }\n\n  public pause() {\n    this.uartSend(0x0e, 0);\n  }\n\n  public resume() {\n    this.uartSend(0x0d, 0);\n  }\n\n  public next() {\n    this.uartSend(0x01, 0);\n  }\n\n  public prev() {\n    this.uartSend(0x02, 0);\n  }\n\n  public uartSend(command: any, param: any) {\n    const paramM: any = param >> 8;\n    const paramL: any = param & 0xff;\n    this.uart.send([0x7e, 0xff, 0x06, command, 0x01, paramM, paramL, 0xef]);\n    const response: any = this.uart.readBytes();\n    return response;\n    // return response;\n  }\n}\n"]}