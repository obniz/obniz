{"version":3,"sources":["../src/parts/Grove/Grove_GPS/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import Obniz from \"../../../obniz\";\r\nimport PeripheralIO from \"../../../obniz/libs/io_peripherals/io\";\r\nimport PeripheralUART from \"../../../obniz/libs/io_peripherals/uart\";\r\nimport ObnizPartsInterface, {ObnizPartsInfo} from \"../../../obniz/ObnizPartsInterface\";\r\n\r\nexport interface Grove_GPSOptions {\r\n  vcc?: number;\r\n  gnd?: number;\r\n  tx: number;\r\n  rx: number;\r\n}\r\n\r\nexport interface Grove_GPSEditedData {\r\n  enable: boolean;\r\n  GPGGA: any;\r\n  GPGLL: any;\r\n  GPGSA: any;\r\n  GPGSV: any[];\r\n  GPRMC: any;\r\n  GPVTG: any;\r\n  GPZDA: any;\r\n  [key: string]: any;\r\n  timestamp: Date;\r\n}\r\n\r\nexport default class Grove_GPS implements ObnizPartsInterface {\r\n  // -------------------\r\n  get latitude() {\r\n    return this.nmea2dd(this._latitude);\r\n  }\r\n\r\n  get longitude() {\r\n    return this.nmea2dd(this._longitude);\r\n  }\r\n\r\n  public static info(): ObnizPartsInfo {\r\n    return {\r\n      name: \"Grove_GPS\",\r\n    };\r\n  }\r\n\r\n  public keys: string[];\r\n  public requiredKeys: string[];\r\n  public ioKeys: string[];\r\n  public displayName: any;\r\n  public displayIoNames: any;\r\n\r\n  public params: any;\r\n\r\n  public editedData: any;\r\n  public gpsInfo: any;\r\n  public status: any;\r\n  public fixMode: any;\r\n  public gpsQuality: any;\r\n\r\n  protected obniz!: Obniz;\r\n\r\n  private uart!: PeripheralUART;\r\n  private _latitude: number = 0;\r\n  private _longitude: number = 0;\r\n\r\n  constructor() {\r\n    this.keys = [\"tx\", \"rx\", \"vcc\", \"gnd\"];\r\n    this.requiredKeys = [\"tx\", \"rx\"];\r\n\r\n    this.ioKeys = this.keys;\r\n    this.displayName = \"gps\";\r\n    this.displayIoNames = {tx: \"tx\", rx: \"rx\"};\r\n  }\r\n\r\n  public wired(obniz: Obniz) {\r\n    this.obniz = obniz;\r\n\r\n    this.obniz.setVccGnd(this.params.vcc, this.params.gnd, \"5v\");\r\n    this.uart = obniz.getFreeUart();\r\n    this.uart.start({\r\n      tx: this.params.tx,\r\n      rx: this.params.rx,\r\n      baud: 9600,\r\n    });\r\n\r\n    this.editedData = {};\r\n    this.editedData.enable = false;\r\n    this.editedData.GPGSV = new Array(4);\r\n\r\n    this.gpsInfo = {};\r\n    this.gpsInfo._sentenceType = {\r\n      GPGGA: 0x0001, // GGA - Global Positioning System Fix Data\r\n      GPGSA: 0x0002, // GSA - GNSS DOP and active satellites\r\n      GPGSV: 0x0004, // GSV - Satellites in view\r\n      GPRMC: 0x0008, // RMC - Recommended minimum specific GNSS data\r\n      GPVTG: 0x0010, // VTG - Track made good and ground speed\r\n      GPZDA: 0x0020, // ZDA - Date & Time\r\n    };\r\n    this.gpsInfo.status = \"V\";\r\n    this.gpsInfo.sentences = new Set(); // Set specifying sentence of MNEA from which data have been obtained\r\n    this.gpsInfo.satelliteInfo = {\r\n      satellites: [],\r\n      inView: 0,\r\n    };\r\n  }\r\n\r\n  public readSentence(): string {\r\n    let results: any = [];\r\n    if (this.uart.isDataExists()) {\r\n      const pos: any = this.uart.received.indexOf(0x0a);\r\n      if (pos >= 0) {\r\n        results = this.uart.received.slice(0, pos - 1);\r\n        this.uart.received.splice(0, pos + 1);\r\n        return this.uart.tryConvertString(results);\r\n      }\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  public getEditedData(): Grove_GPSEditedData {\r\n    let n: any;\r\n    let utc: any;\r\n    let format: any;\r\n    let sentence: any = this.readSentence();\r\n    this.editedData.enable = false;\r\n    this.editedData.GPGSV = new Array(4);\r\n    while (sentence.length > 0) {\r\n      const part: any = sentence.split(\",\");\r\n      if (sentence.slice(-4, -3) !== \",\") {\r\n        const st: any = part[part.length - 1].slice(0, -3);\r\n        part.push(part[part.length - 1].slice(-3));\r\n        part[part.length - 2] = st;\r\n      }\r\n      this.editedData.sentence = part.join(\",\");\r\n      switch (part[0]) {\r\n        case \"$GPGGA\":\r\n          this.editedData.GPGGA = part;\r\n          break;\r\n        case \"$GPGLL\":\r\n          this.editedData.GPGLL = part;\r\n          break;\r\n        case \"$GPGSA\":\r\n          this.editedData.GPGSA = part;\r\n          break;\r\n        case \"$GPGSV\":\r\n          n = Number(part[2]);\r\n          if (n > this.editedData.GPGSV.length) {\r\n            while (n > this.editedData.GPGSV.length) {\r\n              this.editedData.GPGSV.push([]);\r\n            }\r\n          }\r\n          this.editedData.GPGSV[n - 1] = part;\r\n          break;\r\n        case \"$GPRMC\":\r\n          this.editedData.GPRMC = part;\r\n          break;\r\n        case \"$GPVTG\":\r\n          this.editedData.GPVTG = part;\r\n          break;\r\n        case \"$GPZDA\":\r\n          this.editedData.GPZDA = part;\r\n          utc =\r\n            part[4] +\r\n            \"/\" +\r\n            part[3] +\r\n            \"/\" +\r\n            part[2] +\r\n            \" \" +\r\n            part[1].substring(0, 2) +\r\n            \":\" +\r\n            part[1].substring(2, 4) +\r\n            \":\" +\r\n            part[1].substring(4, 6) +\r\n            \" +00:00\";\r\n          this.editedData.timestamp = new Date(utc);\r\n          break;\r\n        default:\r\n          format = part[0].substr(1);\r\n          this.editedData[format] = part;\r\n      }\r\n\r\n      this.editedData.enable = true;\r\n      sentence = this.readSentence();\r\n    }\r\n    return this.editedData;\r\n  }\r\n\r\n  public getGpsInfo(editedData?: Grove_GPSEditedData): any {\r\n    const NMEA_SATINSENTENCE: any = 4;\r\n    const NMEA_MAXSAT: any = 12;\r\n    editedData = editedData || this.getEditedData();\r\n    this.gpsInfo.status = \"V\";\r\n    if (editedData.enable) {\r\n      if (editedData.GPGGA) {\r\n        const gga: any = editedData.GPGGA;\r\n        this.gpsInfo.gpsQuality = parseFloat(gga[6]); // Fix Quality: 0 = Invalid, 1 = GPS fix, 2 = DGPS fix\r\n        this.gpsInfo.hdop = parseFloat(gga[8]); // Horizontal Dilution of Precision (HDOP)\r\n        this.gpsInfo.altitude = parseFloat(gga[9]); // Antenna Altitude meters above mean sea level\r\n        const latitude: any = this.nmea2dd(parseFloat(gga[2]));\r\n        this.gpsInfo.latitude = gga[3] === \"N\" ? latitude : -latitude;\r\n        const longitude: any = this.nmea2dd(parseFloat(gga[4]));\r\n        this.gpsInfo.longitude = gga[5] === \"E\" ? longitude : -longitude;\r\n        this.gpsInfo.sentences.add(this.gpsInfo._sentenceType.GPGGA);\r\n      }\r\n      if (editedData.GPGSV) {\r\n        for (let n = 0; n < editedData.GPGSV.length; n++) {\r\n          if (editedData.GPGSV[n]) {\r\n            const gsv: any = editedData.GPGSV[n].map((v: any) => parseFloat(v));\r\n            const pack_count: any = gsv[1];\r\n            const pack_index: any = gsv[2];\r\n            const sat_count: any = gsv[3];\r\n            if (pack_index > pack_count) {\r\n              continue;\r\n            }\r\n\r\n            this.gpsInfo.satelliteInfo.inView = sat_count;\r\n            let nsat: any = (pack_index - 1) * NMEA_SATINSENTENCE;\r\n            nsat =\r\n              nsat + NMEA_SATINSENTENCE > sat_count\r\n                ? sat_count - nsat\r\n                : NMEA_SATINSENTENCE;\r\n\r\n            for (let isat = 0; isat < nsat; ++isat) {\r\n              const isi: any = (pack_index - 1) * NMEA_SATINSENTENCE + isat;\r\n              if (this.gpsInfo.satelliteInfo.satellites.length <= isi) {\r\n                this.gpsInfo.satelliteInfo.satellites.push({});\r\n              }\r\n              const isatn: any = isat * NMEA_SATINSENTENCE;\r\n              this.gpsInfo.satelliteInfo.satellites[isi] = {\r\n                id: gsv[isatn + 4], // SV PRN number\r\n                elevation: gsv[isatn + 5], // Elevation in degrees, 90 maximum\r\n                azimuth: gsv[isatn + 6], // Azimuth, degrees from true north, 000 to 359\r\n                snr: gsv[isatn + 7], // SNR, 00-99 dB (null when not tracking)\r\n                inUse: false,\r\n              };\r\n            }\r\n            this.gpsInfo.sentences.add(this.gpsInfo._sentenceType.GPGSV);\r\n          }\r\n        }\r\n      }\r\n      if (editedData.GPGSA) {\r\n        const gsa: any = editedData.GPGSA;\r\n        let nuse: any = 0;\r\n        this.gpsInfo.fixMode = parseFloat(gsa[2]); // Fix Mode: 1=Fix not available, 2=2D, 3=3D\r\n        this.gpsInfo.pdop = parseFloat(gsa[15]); // PDOP: Position Dilution of Precision\r\n        this.gpsInfo.hdop = parseFloat(gsa[16]); // HDOP: Horizontal Dilution of Precision\r\n        this.gpsInfo.vdop = parseFloat(gsa[17]); // VDOP: Vertical Dilution of Position\r\n        for (let i = 0; i < NMEA_MAXSAT; ++i) {\r\n          for (let j = 0; j < this.gpsInfo.satelliteInfo.inView; ++j) {\r\n            if (\r\n              this.gpsInfo.satelliteInfo.satellites[j] &&\r\n              gsa[i + 3] === this.gpsInfo.satelliteInfo.satellites[j].id\r\n            ) {\r\n              this.gpsInfo.satelliteInfo.satellites[j].inUse = true;\r\n              nuse++;\r\n            }\r\n          }\r\n        }\r\n        this.gpsInfo.satelliteInfo.inUse = nuse;\r\n        this.gpsInfo.sentences.add(this.gpsInfo._sentenceType.GPGSA);\r\n      }\r\n      if (editedData.GPRMC) {\r\n        const rmc: any = editedData.GPRMC;\r\n        this.gpsInfo.status = rmc[2]; // Status Active or Void\r\n        const latitude: any = this.nmea2dd(parseFloat(rmc[3]));\r\n        this.gpsInfo.latitude = rmc[4] === \"N\" ? latitude : -latitude;\r\n        const longitude: any = this.nmea2dd(parseFloat(rmc[5]));\r\n        this.gpsInfo.longitude = rmc[6] === \"E\" ? longitude : -longitude;\r\n        const NMEA_TUD_KNOTS: any = 1.852; // 1knot=1.852km/h\r\n        this.gpsInfo.speed = parseFloat(rmc[7]) * NMEA_TUD_KNOTS; // unit: km/h\r\n        this.gpsInfo.direction = rmc[8];\r\n        this.gpsInfo.sentences.add(this.gpsInfo._sentenceType.GPRMC);\r\n      }\r\n      if (editedData.GPVTG) {\r\n        const vtg: any = editedData.GPVTG;\r\n        this.gpsInfo.direction = parseFloat(vtg[1]);\r\n        this.gpsInfo.declination = parseFloat(vtg[3]);\r\n        this.gpsInfo.speed = parseFloat(vtg[7]);\r\n        this.gpsInfo.sentences.add(this.gpsInfo._sentenceType.GPVTG);\r\n      }\r\n      if (editedData.GPZDA) {\r\n        this.gpsInfo.utc = editedData.timestamp;\r\n        this.gpsInfo.sentences.add(this.gpsInfo._sentenceType.GPZDA);\r\n      }\r\n    }\r\n    return this.gpsInfo;\r\n  }\r\n\r\n  public _mneaTo(format: any, value: any) {\r\n    let result: any = this.nmea2dd(value);\r\n    if (typeof format === \"string\") {\r\n      switch (format.toUpperCase()) {\r\n        case \"DMS\":\r\n          result = this.nmea2dms(value);\r\n          break;\r\n        case \"DM\":\r\n          result = this.nmea2dm(value);\r\n          break;\r\n        case \"S\":\r\n          result = this.nmea2s(value);\r\n          break;\r\n        default:\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  public latitudeTo(format: any) {\r\n    return this._mneaTo(format, this._latitude);\r\n  }\r\n\r\n  public longitudeTo(format: any) {\r\n    return this._mneaTo(format, this._longitude);\r\n  }\r\n\r\n  public status2string(status: any) {\r\n    status = status || this.status;\r\n    if (status === \"A\") {\r\n      return \"Active\";\r\n    }\r\n    if (status === \"V\") {\r\n      return \"Void\";\r\n    }\r\n    return status;\r\n  }\r\n\r\n  public fixMode2string(fixMode: any) {\r\n    fixMode = fixMode || this.fixMode;\r\n    if (fixMode === 1) {\r\n      return \"Fix not available\";\r\n    }\r\n    if (fixMode === 2) {\r\n      return \"2D\";\r\n    }\r\n    if (fixMode === 3) {\r\n      return \"3D\";\r\n    }\r\n    return fixMode;\r\n  }\r\n\r\n  public gpsQuality2string(gpsQuality: any) {\r\n    gpsQuality = gpsQuality || this.gpsQuality;\r\n    if (gpsQuality === 0) {\r\n      return \"Invalid\";\r\n    }\r\n    if (gpsQuality === 1) {\r\n      return \"GPS fix\";\r\n    }\r\n    if (gpsQuality === 2) {\r\n      return \"DGPS fix\";\r\n    }\r\n    return gpsQuality;\r\n  }\r\n\r\n  // --- latitude/longitude MNEA format change to each unit\r\n  public nmea2dms(val: any): string {\r\n    // NMEA format to DMS format string (999째 99'99.9\")\r\n    val = parseFloat(val);\r\n    const d: any = Math.floor(val / 100);\r\n    const m: any = Math.floor((val / 100.0 - d) * 100.0);\r\n    const s: any = ((val / 100.0 - d) * 100.0 - m) * 60;\r\n    return d + \"째\" + m + \"'\" + s.toFixed(1) + '\"';\r\n  }\r\n\r\n  public nmea2dm(val: any): string {\r\n    // NMEA format to DM format string (999째 99.9999')\r\n    val = parseFloat(val);\r\n    const d: any = Math.floor(val / 100.0);\r\n    const m: any = (val / 100.0 - d) * 100.0;\r\n    return d + \"째\" + m.toFixed(4) + \"'\";\r\n  }\r\n\r\n  public nmea2dd(val: any): number {\r\n    // NMEA format to DD format decimal (999.999999)\r\n    val = parseFloat(val);\r\n    const d: any = Math.floor(val / 100.0);\r\n    const m: any = Math.floor(((val / 100.0 - d) * 100.0) / 60);\r\n    const s: any = (((val / 100.0 - d) * 100.0 - m) * 60) / (60 * 60);\r\n    return parseFloat((d + m + s).toFixed(6));\r\n  }\r\n\r\n  public nmea2s(val: any): number {\r\n    // NMEA format to S format decimal (99999.9999)\r\n    val = parseFloat(val);\r\n    const d: any = Math.floor(val / 100.0);\r\n    const m: any = Math.floor(((val / 100.0 - d) * 100.0) / 60);\r\n    const s: any = (((val / 100.0 - d) * 100.0 - m) * 60) / (60 * 60);\r\n    return (d + m + s) / (1.0 / 60.0 / 60.0);\r\n  }\r\n}\r\n"]}