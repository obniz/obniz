{"version":3,"sources":["../src/obniz/libs/wscommand/WSCommandBle.ts"],"names":[],"mappings":"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","file":"WSCommandBle.d.ts","sourcesContent":["import JsonBinaryConverter from \"./jsonBinaryConverter\";\nimport WSCommand from \"./WSCommand\";\nimport WSCommandBleHci from \"./WSCommandBleHci\";\n\nclass WSCommandBle extends WSCommand {\n  public module: any;\n  public uuidLength: any;\n  public _CommandSetAdvData: any;\n  public _CommandSetScanRespData: any;\n  public _CommandStartAdv: any;\n  public _CommandStopAdv: any;\n  public _CommandScan: any;\n  public _CommandStartScan: any;\n  public _CommandStopScan: any;\n  public _CommandScanResults: any;\n  public _CommandConnect: any;\n  public _CommandServices: any;\n  public _CommandCharacteristics: any;\n  public _CommandWriteCharacteristics: any;\n  public _CommandReadCharacteristics: any;\n  public _CommandRegisterNotifyCharacteristic: any;\n  public _CommandUnregisterNotifyCharacteristic: any;\n  public _CommandDescriptors: any;\n  public _CommandWriteDescriptor: any;\n  public _CommandReadDescriptor: any;\n  public _CommandNotifyCharacteristic: any;\n  public _CommandSetDeviceName: any;\n  public _CommandServerStartPeripheral: any;\n  public _CommandServerNotifyConnect: any;\n  public _CommandServerAddService: any;\n  public _CommandServerAddCharacteristic: any;\n  public _CommandServerAddDescriptor: any;\n  public _CommandServerWriteCharavteristicValue: any;\n  public _CommandServerReadCharavteristicValue: any;\n  public _CommandServerNotifyWriteCharavteristicValue: any;\n  public _CommandServerNotifyReadCharavteristicValue: any;\n  public _CommandServerWriteDescriptorValue: any;\n  public _CommandServerReadDescriptorValue: any;\n  public _CommandServerNotifyWriteDescriptorValue: any;\n  public _CommandServerNotifyReadDescriptorValue: any;\n  public _CommandServerNotifyCharavteristic: any;\n  public _CommandServerStartStopService: any;\n  public _CommandSecuritySetAuth: any;\n  public _CommandSecuritySetEncryptionLevel: any;\n  public _CommandSecuritySetEnableKeyTypes: any;\n  public _CommandSecuritySetKeyMaxSize: any;\n  public _CommandSecuritySetIOCapability: any;\n  public _CommandSecurityClearBondingDevices: any;\n  public _CommandScanResultsDevice: any;\n  public _CommandScanResultsDeviceAddress: any;\n  public _CommandScanResultsEvet: any;\n  public _CommandScanResultsBleEvent: any;\n  public _CommandCharacteristicsProperties: any;\n  public _commandResults: any;\n  public _securityAuthValues: any;\n  public _securityEncryotionLevels: any;\n  public _securityKeyTypes: any;\n  public hciCommand: any;\n  public sendCommand: any;\n  public validateCommandSchema: any;\n  public WSCommandNotFoundError: any;\n  public COMMAND_FUNC_ID_ERROR: any;\n  public envelopError: any;\n\n  constructor() {\n    super();\n    this.module = 11;\n\n    this.uuidLength = 16 + 2;\n\n    this._CommandSetAdvData = 0;\n    this._CommandSetScanRespData = 1;\n    this._CommandStartAdv = 2;\n    this._CommandStopAdv = 3;\n    this._CommandScan = 4;\n    this._CommandStartScan = 4;\n    this._CommandStopScan = 5;\n    this._CommandScanResults = 6;\n    this._CommandConnect = 7;\n    this._CommandServices = 8;\n    this._CommandCharacteristics = 9;\n    this._CommandWriteCharacteristics = 10;\n    this._CommandReadCharacteristics = 11;\n    this._CommandRegisterNotifyCharacteristic = 12;\n    this._CommandUnregisterNotifyCharacteristic = 13;\n    this._CommandDescriptors = 14;\n    this._CommandWriteDescriptor = 15;\n    this._CommandReadDescriptor = 16;\n    this._CommandNotifyCharacteristic = 17;\n\n    this._CommandSetDeviceName = 19;\n    this._CommandServerStartPeripheral = 20;\n    this._CommandServerNotifyConnect = 21;\n    this._CommandServerAddService = 22;\n    this._CommandServerAddCharacteristic = 23;\n    this._CommandServerAddDescriptor = 24;\n    this._CommandServerWriteCharavteristicValue = 25;\n    this._CommandServerReadCharavteristicValue = 26;\n    this._CommandServerNotifyWriteCharavteristicValue = 27;\n    this._CommandServerNotifyReadCharavteristicValue = 28;\n    this._CommandServerWriteDescriptorValue = 29;\n    this._CommandServerReadDescriptorValue = 30;\n    this._CommandServerNotifyWriteDescriptorValue = 31;\n    this._CommandServerNotifyReadDescriptorValue = 32;\n    this._CommandServerNotifyCharavteristic = 33;\n    this._CommandServerStartStopService = 34;\n\n    this._CommandSecuritySetAuth = 35;\n    this._CommandSecuritySetEncryptionLevel = 36;\n    this._CommandSecuritySetEnableKeyTypes = 37;\n    this._CommandSecuritySetKeyMaxSize = 38;\n    this._CommandSecuritySetIOCapability = 39;\n    this._CommandSecurityClearBondingDevices = 40;\n\n    this._CommandScanResultsDevice = {\n      breder: 0x01,\n      ble: 0x02,\n      dumo: 0x03,\n    };\n\n    /// BLE device address type\n    this._CommandScanResultsDeviceAddress = {\n      public: 0x00,\n      random: 0x01,\n      rpa_public: 0x02,\n      rpa_random: 0x03,\n    };\n\n    this._CommandScanResultsEvet = {\n      inquiry_result: 0 /*!< Inquiry result for a peer device. */,\n      inquiry_complete: 1 /*!< Inquiry complete. */,\n      discovery_result: 2 /*!< Discovery result for a peer device. */,\n      discovery_ble_result: 3 /*!< Discovery result for BLE GATT based service on a peer device. */,\n      discovery_cmoplete: 4 /*!< Discovery complete. */,\n      discovery_di_cmoplete: 5 /*!< Discovery complete. */,\n      cancelled: 6 /*!< Search cancelled */,\n    };\n\n    this._CommandScanResultsBleEvent = {\n      connectable_advertisemnt: 0x00 /*!< Connectable undirected advertising (ADV_IND) */,\n      connectable_directed_advertisemnt: 0x01 /*!< Connectable directed advertising (ADV_DIRECT_IND) */,\n      scannable_advertising: 0x02 /*!< Scannable undirected advertising (ADV_SCAN_IND) */,\n      non_connectable_advertising: 0x03 /*!< Non connectable undirected advertising (ADV_NONCONN_IND) */,\n      scan_response: 0x04 /*!< Scan Response (SCAN_RSP) */,\n    };\n\n    this._CommandCharacteristicsProperties = {\n      broadcast: 0x01,\n      read: 0x02,\n      write_without_response: 0x04,\n      write: 0x08,\n      notify: 0x10,\n      indicate: 0x20,\n      auth: 0x40,\n      extended_properties: 0x80,\n    };\n\n    this._commandResults = {\n      success: 0,\n      failed: 1,\n    };\n\n    this._securityAuthValues = {\n      0x01: \"bonding\",\n      0x04: \"mitm\",\n      0x08: \"secure_connection\",\n    };\n    this._securityEncryotionLevels = {\n      none: 0x01,\n      encryption: 0x02,\n      mitm: 0x03,\n    };\n\n    this._securityKeyTypes = {\n      0x01: \"ltk\",\n      0x02: \"irk\",\n      0x04: \"csrk\",\n    };\n\n    this.hciCommand = new WSCommandBleHci(this);\n  }\n\n  /* CENTRAL   */\n\n  public centralScanStart(params: any) {\n    const schema: any = [\n      {path: \"scan.duration\", length: 4, type: \"int\", default: 30},\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandStartScan, buf);\n  }\n\n  public centralScanStop(params: any) {\n    this.sendCommand(this._CommandStopScan, null);\n  }\n\n  public centralConnect(params: any) {\n    const schema: any = [\n      {\n        path: \"connect.address\",\n        length: 6,\n        type: \"hex\",\n        required: true,\n        endianness: \"little\",\n      },\n      {path: null, length: 1, type: \"char\", default: false}, // const val\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandConnect, buf);\n  }\n\n  public centralDisconnect(params: any) {\n    const schema: any = [\n      {\n        path: \"disconnect.address\",\n        length: 6,\n        type: \"hex\",\n        required: true,\n        endianness: \"little\",\n      },\n      {path: null, length: 1, type: \"char\", default: true}, // const val\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandConnect, buf);\n  }\n\n  public centralServiceGet(params: any) {\n    const schema: any = [\n      {\n        path: \"get_services.address\",\n        length: 6,\n        type: \"hex\",\n        required: true,\n        endianness: \"little\",\n      },\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandServices, buf);\n  }\n\n  public centralCharacteristicGet(params: any) {\n    const schema: any = [\n      {\n        path: \"get_characteristics.address\",\n        length: 6,\n        type: \"hex\",\n        required: true,\n        endianness: \"little\",\n      },\n      {\n        path: \"get_characteristics.service_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandCharacteristics, buf);\n  }\n\n  public centralCharacteristicRead(params: any) {\n    const schema: any = [\n      {\n        path: \"read_characteristic.address\",\n        length: 6,\n        type: \"hex\",\n        required: true,\n        endianness: \"little\",\n      },\n      {\n        path: \"read_characteristic.service_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"read_characteristic.characteristic_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandReadCharacteristics, buf);\n  }\n\n  public centralCharacteristicWrite(params: any) {\n    const schema: any = [\n      {\n        path: \"write_characteristic.address\",\n        length: 6,\n        type: \"hex\",\n        required: true,\n        endianness: \"little\",\n      },\n      {\n        path: \"write_characteristic.service_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"write_characteristic.characteristic_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"write_characteristic.needResponse\",\n        length: 1,\n        type: \"char\",\n        default: 1,\n      },\n      {path: \"write_characteristic.data\", length: null, type: \"dataArray\"},\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandWriteCharacteristics, buf);\n  }\n\n  public centralCharacteristicRegisterNotify(params: any) {\n    const schema: any = [\n      {\n        path: \"register_notify_characteristic.address\",\n        length: 6,\n        type: \"hex\",\n        required: true,\n        endianness: \"little\",\n      },\n      {\n        path: \"register_notify_characteristic.service_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"register_notify_characteristic.characteristic_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandRegisterNotifyCharacteristic, buf);\n  }\n\n  public centralCharacteristicUnregisterNotify(params: any) {\n    const schema: any = [\n      {\n        path: \"unregister_notify_characteristic.address\",\n        length: 6,\n        type: \"hex\",\n        required: true,\n        endianness: \"little\",\n      },\n      {\n        path: \"unregister_notify_characteristic.service_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"unregister_notify_characteristic.characteristic_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandUnregisterNotifyCharacteristic, buf);\n  }\n\n  public centralDescriptorGet(params: any) {\n    const schema: any = [\n      {\n        path: \"get_descriptors.address\",\n        length: 6,\n        type: \"hex\",\n        required: true,\n        endianness: \"little\",\n      },\n      {\n        path: \"get_descriptors.service_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"get_descriptors.characteristic_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandDescriptors, buf);\n  }\n\n  public centralDescriptorRead(params: any) {\n    const schema: any = [\n      {\n        path: \"read_descriptor.address\",\n        length: 6,\n        type: \"hex\",\n        required: true,\n        endianness: \"little\",\n      },\n      {\n        path: \"read_descriptor.service_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"read_descriptor.characteristic_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"read_descriptor.descriptor_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandReadDescriptor, buf);\n  }\n\n  public centralDescriptorWrite(params: any) {\n    const schema: any = [\n      {\n        path: \"write_descriptor.address\",\n        length: 6,\n        type: \"hex\",\n        required: true,\n        endianness: \"little\",\n      },\n      {\n        path: \"write_descriptor.service_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"write_descriptor.characteristic_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"write_descriptor.descriptor_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"write_descriptor.needResponse\",\n        length: 1,\n        type: \"char\",\n        default: 1,\n      },\n      {path: \"write_descriptor.data\", length: null, type: \"dataArray\"},\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandWriteDescriptor, buf);\n  }\n\n  /* PERIPHERAL   */\n\n  public peripheralAdvertisementStart(params: any) {\n    this.sendCommand(\n      this._CommandSetAdvData,\n      new Uint8Array(params.advertisement.adv_data),\n    );\n\n    if (params.advertisement.scan_resp) {\n      this.sendCommand(\n        this._CommandSetScanRespData,\n        new Uint8Array(params.advertisement.scan_resp),\n      );\n    }\n\n    this.sendCommand(this._CommandStartAdv, null);\n  }\n\n  public peripheralAdvertisementStop(params: any) {\n    this.sendCommand(this._CommandStopAdv, null);\n  }\n\n  public peripheralServiceStart(params: any) {\n    const val: any = params.peripheral;\n    const propFlags: any = {\n      0x01: \"broadcast\",\n      0x02: \"read\",\n      0x04: \"write_without_response\",\n      0x08: \"write\",\n      0x10: \"notify\",\n      0x20: \"indiate\",\n      0x40: \"auth\",\n      0x80: \"ext_prop\",\n    };\n\n    const permissionFlags: any = {\n      0x001: \"read\",\n      0x002: \"read_encrypted\",\n      0x004: \"read_encrypted_mitm\",\n      0x010: \"write\",\n      0x020: \"write_encrypted\",\n      0x040: \"write_encrypted_mitm\",\n      0x080: \"write_signed\",\n      0x100: \"write_signed_mitm\",\n    };\n    const schema: any = {\n      service: {\n        command: this._CommandServerAddService,\n        schema: [{path: \"uuid\", length: 18, type: \"uuid\", required: true}],\n      },\n      characteristic: {\n        command: this._CommandServerAddCharacteristic,\n        schema: [\n          {path: \"service_uuid\", length: 18, type: \"uuid\", required: true},\n          {path: \"uuid\", length: 18, type: \"uuid\", required: true},\n          {\n            path: \"permissions\",\n            length: 2,\n            type: \"flag\",\n            default: [\"write\", \"read\"],\n            flags: permissionFlags,\n          },\n          {\n            path: \"properties\",\n            length: 1,\n            type: \"flag\",\n            default: [\"write\", \"read\"],\n            flags: propFlags,\n          },\n          {path: \"data\", type: \"dataArray\"},\n        ],\n      },\n      descriptor: {\n        command: this._CommandServerAddDescriptor,\n        schema: [\n          {path: \"service_uuid\", length: 18, type: \"uuid\", required: true},\n          {\n            path: \"characteristic_uuid\",\n            length: 18,\n            type: \"uuid\",\n            required: true,\n          },\n          {path: \"uuid\", length: 18, type: \"uuid\", required: true},\n          {\n            path: \"permissions\",\n            length: 2,\n            type: \"flag\",\n            default: [\"write\", \"read\"],\n            flags: permissionFlags,\n          },\n          {path: \"data\", type: \"dataArray\"},\n        ],\n      },\n      startService: {\n        command: this._CommandServerStartStopService,\n        schema: [\n          {path: \"uuid\", length: 18, type: \"uuid\", required: true},\n          {path: null, length: 1, type: \"char\", default: 0}, // const val\n        ],\n      },\n    };\n\n    const sendBufs: any = [];\n    const startServiceBufs: any = [];\n    let buf: any;\n    for (const serviceIndex in val.services) {\n      const service: any = val.services[serviceIndex];\n      buf = JsonBinaryConverter.createSendBuffer(\n        schema.service.schema,\n        service,\n      );\n      if (buf.length === 0) {\n        return;\n      }\n      sendBufs.push({command: schema.service.command, buffer: buf});\n\n      buf = JsonBinaryConverter.createSendBuffer(\n        schema.startService.schema,\n        service,\n      );\n      startServiceBufs.push({\n        command: schema.startService.command,\n        buffer: buf,\n      });\n\n      for (const charaIndex in service.characteristics) {\n        const chara: any = service.characteristics[charaIndex];\n        chara.service_uuid = service.uuid;\n        buf = JsonBinaryConverter.createSendBuffer(\n          schema.characteristic.schema,\n          chara,\n        );\n        if (buf.length === 0) {\n          return;\n        }\n        sendBufs.push({\n          command: schema.characteristic.command,\n          buffer: buf,\n        });\n\n        for (const descIndex in chara.descriptors) {\n          const desc: any = chara.descriptors[descIndex];\n          desc.service_uuid = service.uuid;\n          desc.characteristic_uuid = chara.uuid;\n          buf = JsonBinaryConverter.createSendBuffer(\n            schema.descriptor.schema,\n            desc,\n          );\n          if (buf.length === 0) {\n            return;\n          }\n          sendBufs.push({command: schema.descriptor.command, buffer: buf});\n        }\n      }\n    }\n    for (const index in sendBufs) {\n      this.sendCommand(sendBufs[index].command, sendBufs[index].buffer);\n    }\n    for (const index in startServiceBufs) {\n      this.sendCommand(\n        startServiceBufs[index].command,\n        startServiceBufs[index].buffer,\n      );\n    }\n  }\n\n  public peripheralServiceStop(params: any) {\n    const schema: any = [\n      {\n        path: \"peripheral.stop_service.service_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {path: null, length: 1, type: \"char\", default: 1}, // const val\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandServerStartStopService, buf);\n  }\n\n  public peripheralServiceStopAll() {\n    this.sendCommand(this._CommandServerStartPeripheral, new Uint8Array([1]));\n  }\n\n  public peripheralCharacteristicRead(params: any) {\n    const schema: any = [\n      {\n        path: \"peripheral.read_characteristic.service_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"peripheral.read_characteristic.characteristic_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandServerReadCharavteristicValue, buf);\n  }\n\n  public peripheralCharacteristicWrite(params: any) {\n    const schema: any = [\n      {\n        path: \"peripheral.write_characteristic.service_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"peripheral.write_characteristic.characteristic_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {path: \"peripheral.write_characteristic.data\", type: \"dataArray\"},\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandServerWriteCharavteristicValue, buf);\n  }\n\n  public peripheralCharacteristicNotify(params: any) {\n    const schema: any = [\n      {\n        path: \"peripheral.notify_characteristic.service_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"peripheral.notify_characteristic.characteristic_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandServerNotifyCharavteristic, buf);\n  }\n\n  public peripheralDescriptorRead(params: any) {\n    const schema: any = [\n      {\n        path: \"peripheral.read_descriptor.service_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"peripheral.read_descriptor.characteristic_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"peripheral.read_descriptor.descriptor_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandServerReadDescriptorValue, buf);\n  }\n\n  public peripheralDescriptorWrite(params: any) {\n    const schema: any = [\n      {\n        path: \"peripheral.write_descriptor.service_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"peripheral.write_descriptor.characteristic_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {\n        path: \"peripheral.write_descriptor.descriptor_uuid\",\n        length: 18,\n        type: \"uuid\",\n        required: true,\n      },\n      {path: \"peripheral.write_descriptor.data\", type: \"dataArray\"},\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandServerWriteDescriptorValue, buf);\n  }\n\n  public securityAuth(params: any) {\n    const schema: any = [\n      {\n        path: \"security.auth\",\n        type: \"flag\",\n        length: 1,\n        required: true,\n        flags: this._securityAuthValues,\n      },\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandSecuritySetAuth, buf);\n  }\n\n  public securityIndicateLevel(params: any) {\n    const schema: any = [\n      {\n        path: \"security.indicate_security_level\",\n        type: \"char\",\n        length: 1,\n        required: true,\n      },\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandSecuritySetEncryptionLevel, buf);\n  }\n\n  public securityKeyType(params: any) {\n    const schema: any = [\n      {\n        path: \"security.key.type\",\n        type: \"flag\",\n        length: 1,\n        required: true,\n        flags: this._securityKeyTypes,\n      },\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandSecuritySetEnableKeyTypes, buf);\n  }\n\n  public securityKeySize(params: any) {\n    const schema: any = [\n      {\n        path: \"security.key.max_size\",\n        type: \"char\",\n        length: 1,\n        required: true,\n      },\n    ];\n    const buf: any = JsonBinaryConverter.createSendBuffer(schema, params);\n    this.sendCommand(this._CommandSecuritySetKeyMaxSize, buf);\n  }\n\n  public clearBondingDevicesList(params: any) {\n    const buf: any = new Uint8Array([]); // noting to send\n    this.sendCommand(this._CommandSecurityClearBondingDevices, buf);\n  }\n\n  public parseFromJson(json: any) {\n    const module: any = json.ble;\n    if (module === undefined) {\n      return;\n    }\n    const schemaData: any = [\n      {\n        uri: \"/request/ble/central/scan_start\",\n        onValid: this.centralScanStart,\n      },\n      {uri: \"/request/ble/central/scan_stop\", onValid: this.centralScanStop},\n      {uri: \"/request/ble/central/connect\", onValid: this.centralConnect},\n      {\n        uri: \"/request/ble/central/disconnect\",\n        onValid: this.centralDisconnect,\n      },\n      {\n        uri: \"/request/ble/central/service_get\",\n        onValid: this.centralServiceGet,\n      },\n      {\n        uri: \"/request/ble/central/characteristic_get\",\n        onValid: this.centralCharacteristicGet,\n      },\n      {\n        uri: \"/request/ble/central/characteristic_read\",\n        onValid: this.centralCharacteristicRead,\n      },\n      {\n        uri: \"/request/ble/central/characteristic_write\",\n        onValid: this.centralCharacteristicWrite,\n      },\n      {\n        uri: \"/request/ble/central/characteristic_register_notify\",\n        onValid: this.centralCharacteristicRegisterNotify,\n      },\n      {\n        uri: \"/request/ble/central/characteristic_unregister_notify\",\n        onValid: this.centralCharacteristicUnregisterNotify,\n      },\n      {\n        uri: \"/request/ble/central/descriptor_get\",\n        onValid: this.centralDescriptorGet,\n      },\n      {\n        uri: \"/request/ble/central/descriptor_read\",\n        onValid: this.centralDescriptorRead,\n      },\n      {\n        uri: \"/request/ble/central/descriptor_write\",\n        onValid: this.centralDescriptorWrite,\n      },\n      {\n        uri: \"/request/ble/peripheral/advertisement_start\",\n        onValid: this.peripheralAdvertisementStart,\n      },\n      {\n        uri: \"/request/ble/peripheral/advertisement_stop\",\n        onValid: this.peripheralAdvertisementStop,\n      },\n      {\n        uri: \"/request/ble/peripheral/service_start\",\n        onValid: this.peripheralServiceStart,\n      },\n      {\n        uri: \"/request/ble/peripheral/service_stop\",\n        onValid: this.peripheralServiceStop,\n      },\n      {\n        uri: \"/request/ble/peripheral/service_stop_all\",\n        onValid: this.peripheralServiceStopAll,\n      },\n      {\n        uri: \"/request/ble/peripheral/characteristic_read\",\n        onValid: this.peripheralCharacteristicRead,\n      },\n      {\n        uri: \"/request/ble/peripheral/characteristic_write\",\n        onValid: this.peripheralCharacteristicWrite,\n      },\n      {\n        uri: \"/request/ble/peripheral/characteristic_notify\",\n        onValid: this.peripheralCharacteristicNotify,\n      },\n      {\n        uri: \"/request/ble/peripheral/descriptor_read\",\n        onValid: this.peripheralDescriptorRead,\n      },\n      {\n        uri: \"/request/ble/peripheral/descriptor_write\",\n        onValid: this.peripheralDescriptorWrite,\n      },\n      {\n        uri: \"/request/ble/security/auth\",\n        onValid: this.securityAuth,\n      },\n      {\n        uri: \"/request/ble/security/indicate_security_level\",\n        onValid: this.securityIndicateLevel,\n      },\n      {\n        uri: \"/request/ble/security/key_type\",\n        onValid: this.securityKeyType,\n      },\n      {\n        uri: \"/request/ble/security/key_max_size\",\n        onValid: this.securityKeySize,\n      },\n      {\n        uri: \"/request/ble/security/devices_clear\",\n        onValid: this.clearBondingDevicesList,\n      },\n    ];\n\n    schemaData.push(...this.hciCommand.schemaData());\n    const res: any = this.validateCommandSchema(schemaData, module, \"ble\");\n    if (res.valid === 0) {\n      if (res.invalidButLike.length > 0) {\n        throw new Error(res.invalidButLike[0].message);\n      } else {\n        throw new this.WSCommandNotFoundError(`[ble]unknown command`);\n      }\n    }\n  }\n\n  public notifyFromBinary(objToSend: any, func: any, payload: any) {\n    const funcList: any = {};\n    funcList[this._CommandScanResults] = this.notifyFromBinaryScanResponse.bind(\n      this,\n    );\n    funcList[this._CommandConnect] = this.notifyFromBinaryConnect.bind(this);\n    funcList[this._CommandServices] = this.notifyFromBinaryServices.bind(this);\n    funcList[\n      this._CommandCharacteristics\n      ] = this.notifyFromBinaryChacateristics.bind(this);\n    funcList[\n      this._CommandWriteCharacteristics\n      ] = this.notifyFromBinaryWriteChacateristics.bind(this);\n    funcList[\n      this._CommandReadCharacteristics\n      ] = this.notifyFromBinaryReadChacateristics.bind(this);\n    funcList[\n      this._CommandRegisterNotifyCharacteristic\n      ] = this.notifyFromBinaryRegisterNotifyChacateristic.bind(this);\n    funcList[\n      this._CommandUnregisterNotifyCharacteristic\n      ] = this.notifyFromBinaryUnregisterNotifyChacateristic.bind(this);\n    funcList[\n      this._CommandNotifyCharacteristic\n      ] = this.notifyFromBinaryNotifyChacateristic.bind(this);\n    funcList[this._CommandDescriptors] = this.notifyFromBinaryDescriptors.bind(\n      this,\n    );\n    funcList[\n      this._CommandWriteDescriptor\n      ] = this.notifyFromBinaryWriteDescriptor.bind(this);\n    funcList[\n      this._CommandReadDescriptor\n      ] = this.notifyFromBinaryReadDescriptor.bind(this);\n\n    funcList[\n      this._CommandServerNotifyConnect\n      ] = this.notifyFromBinaryServerConnectionState.bind(this);\n    funcList[\n      this._CommandServerReadCharavteristicValue\n      ] = this.notifyFromBinaryServerReadCharavteristicValue.bind(this);\n    funcList[\n      this._CommandServerWriteCharavteristicValue\n      ] = this.notifyFromBinaryServerWriteCharavteristicValue.bind(this);\n    funcList[\n      this._CommandServerNotifyReadCharavteristicValue\n      ] = this.notifyFromBinaryServerNotifyReadCharavteristicValue.bind(this);\n    funcList[\n      this._CommandServerNotifyWriteCharavteristicValue\n      ] = this.notifyFromBinaryServerNotifyWriteCharavteristicValue.bind(this);\n    funcList[\n      this._CommandServerReadDescriptorValue\n      ] = this.notifyFromBinaryServerReadDescriptorValue.bind(this);\n    funcList[\n      this._CommandServerWriteDescriptorValue\n      ] = this.notifyFromBinaryServerWriteDescriptorValue.bind(this);\n    funcList[\n      this._CommandServerNotifyReadDescriptorValue\n      ] = this.notifyFromBinaryServerNotifyReadDescriptorValue.bind(this);\n    funcList[\n      this._CommandServerNotifyWriteDescriptorValue\n      ] = this.notifyFromBinaryServerNotifyWriteDescriptorValue.bind(this);\n\n    funcList[this.COMMAND_FUNC_ID_ERROR] = this.notifyFromBinaryError.bind(\n      this,\n    );\n\n    Object.assign(funcList, this.hciCommand.notifyFunctionList());\n\n    if (funcList[func]) {\n      funcList[func](objToSend, payload);\n    }\n  }\n\n  public notifyFromBinaryScanResponse(objToSend: any, payload?: any) {\n    if (payload.byteLength > 1) {\n      const schema: any = [\n        {\n          name: \"event_type\",\n          type: \"enum\",\n          length: 1,\n          enum: this._CommandScanResultsEvet,\n        },\n        {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n        {\n          name: \"device_type\",\n          type: \"enum\",\n          length: 1,\n          enum: this._CommandScanResultsDevice,\n        },\n        {\n          name: \"address_type\",\n          type: \"enum\",\n          length: 1,\n          enum: this._CommandScanResultsDeviceAddress,\n        },\n        {\n          name: \"ble_event_type\",\n          type: \"enum\",\n          length: 1,\n          enum: this._CommandScanResultsBleEvent,\n        },\n        {name: \"rssi\", type: \"signed number\", length: 4},\n        {name: \"adv_data\", type: \"dataArray\", length: 31 * 2},\n        {name: \"flag\", type: \"number\", length: 4},\n        {name: \"num_response\", type: \"number\", length: 4},\n        {name: \"advertise_length\", type: \"number\", length: 1},\n        {name: \"scan_response_length\", type: \"number\", length: 1},\n      ];\n\n      const results: any = JsonBinaryConverter.convertFromBinaryToJson(\n        schema,\n        payload,\n      );\n\n      results.scan_resp = results.adv_data.slice(\n        results.advertise_length,\n        results.advertise_length + results.scan_response_length,\n      );\n      results.adv_data = results.adv_data.slice(0, results.advertise_length);\n\n      delete results.num_response;\n      delete results.advertise_length;\n      delete results.scan_response_length;\n      delete results.advertise_data;\n\n      if (results.event_type === \"inquiry_result\") {\n        delete results.event_type;\n        this._addRowForPath(objToSend, \"ble.scan_result\", results);\n      } else if (results.event_type === \"inquiry_complete\") {\n        this._addRowForPath(objToSend, \"ble.scan_result_finish\", true);\n      }\n    }\n  }\n\n  public notifyFromBinaryConnect(objToSend: any, payload?: any) {\n    if (payload.length === 7) {\n      const schema: any = [\n        {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n        {\n          name: \"status\",\n          type: \"enum\",\n          length: 1,\n          enum: {connected: 0, disconnected: 1},\n        },\n      ];\n\n      const results: any = JsonBinaryConverter.convertFromBinaryToJson(\n        schema,\n        payload,\n      );\n      this._addRowForPath(objToSend, \"ble.status_update\", results);\n    }\n  }\n\n  public notifyFromBinaryServices(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n\n    if (results.service_uuid !== null) {\n      this._addRowForPath(objToSend, \"ble.get_service_result\", results);\n    } else {\n      delete results.service_uuid;\n      this._addRowForPath(objToSend, \"ble.get_service_result_finish\", results);\n    }\n  }\n\n  public notifyFromBinaryChacateristics(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {\n        name: \"properties\",\n        type: \"enum\",\n        length: 1,\n        enum: this._CommandCharacteristicsProperties,\n        flags: true,\n      },\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n\n    if (results.characteristic_uuid !== null) {\n      this._addRowForPath(objToSend, \"ble.get_characteristic_result\", results);\n    } else {\n      delete results.characteristic_uuid;\n      delete results.properties;\n      this._addRowForPath(\n        objToSend,\n        \"ble.get_characteristic_result_finish\",\n        results,\n      );\n    }\n  }\n\n  public notifyFromBinaryReadChacateristics(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"result\", type: \"int\", length: 1},\n      {name: \"data\", type: \"dataArray\", length: null},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    results.result =\n      results.result === this._commandResults.success ? \"success\" : \"failed\";\n    this._addRowForPath(objToSend, \"ble.read_characteristic_result\", results);\n  }\n\n  public notifyFromBinaryWriteChacateristics(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"result\", type: \"int\", length: 1},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    results.result =\n      results.result === this._commandResults.success ? \"success\" : \"failed\";\n    this._addRowForPath(objToSend, \"ble.write_characteristic_result\", results);\n  }\n\n  public notifyFromBinaryRegisterNotifyChacateristic(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"result\", type: \"int\", length: 1},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    results.result =\n      results.result === this._commandResults.success ? \"success\" : \"failed\";\n    this._addRowForPath(\n      objToSend,\n      \"ble.register_notify_characteristic_result\",\n      results,\n    );\n  }\n\n  public notifyFromBinaryUnregisterNotifyChacateristic(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"result\", type: \"int\", length: 1},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    results.result =\n      results.result === this._commandResults.success ? \"success\" : \"failed\";\n    this._addRowForPath(\n      objToSend,\n      \"ble.unregister_notify_characteristic_result\",\n      results,\n    );\n  }\n\n  public notifyFromBinaryNotifyChacateristic(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"is_notify\", type: \"int\", length: 1},\n      {name: \"data\", type: \"dataArray\", length: null},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    results.is_notify = results.is_notify === 1;\n    this._addRowForPath(objToSend, \"ble.notify_characteristic\", results);\n  }\n\n  public notifyFromBinaryDescriptors(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"descriptor_uuid\", type: \"uuid\", length: this.uuidLength},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n\n    if (results.descriptor_uuid !== null) {\n      this._addRowForPath(objToSend, \"ble.get_descriptor_result\", results);\n    } else {\n      delete results.descriptor_uuid;\n      this._addRowForPath(\n        objToSend,\n        \"ble.get_descriptor_result_finish\",\n        results,\n      );\n    }\n  }\n\n  public notifyFromBinaryReadDescriptor(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"descriptor_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"result\", type: \"int\", length: 1},\n      {name: \"data\", type: \"dataArray\", length: null},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    results.result =\n      results.result === this._commandResults.success ? \"success\" : \"failed\";\n    this._addRowForPath(objToSend, \"ble.read_descriptor_result\", results);\n  }\n\n  public notifyFromBinaryWriteDescriptor(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"descriptor_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"result\", type: \"int\", length: 1},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    results.result =\n      results.result === this._commandResults.success ? \"success\" : \"failed\";\n    this._addRowForPath(objToSend, \"ble.write_descriptor_result\", results);\n  }\n\n  public notifyFromBinaryServerConnectionState(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {\n        name: \"status\",\n        type: \"enum\",\n        length: 1,\n        enum: {connected: 1, disconnected: 0},\n      },\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    this._addRowForPath(objToSend, \"ble.peripheral.connection_status\", results);\n  }\n\n  public notifyFromBinaryServerWriteCharavteristicValue(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"result\", type: \"int\", length: 1},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    results.result =\n      results.result === this._commandResults.success ? \"success\" : \"failed\";\n    this._addRowForPath(\n      objToSend,\n      \"ble.peripheral.write_characteristic_result\",\n      results,\n    );\n  }\n\n  public notifyFromBinaryServerReadCharavteristicValue(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"data\", type: \"dataArray\", length: null},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    results.result = \"success\"; // always success\n    this._addRowForPath(\n      objToSend,\n      \"ble.peripheral.read_characteristic_result\",\n      results,\n    );\n  }\n\n  public notifyFromBinaryServerNotifyReadCharavteristicValue(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    this._addRowForPath(\n      objToSend,\n      \"ble.peripheral.notify_read_characteristic\",\n      results,\n    );\n  }\n\n  public notifyFromBinaryServerNotifyWriteCharavteristicValue(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"data\", type: \"dataArray\", length: null},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    this._addRowForPath(\n      objToSend,\n      \"ble.peripheral.notify_write_characteristic\",\n      results,\n    );\n  }\n\n  public notifyFromBinaryServerReadDescriptorValue(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"descriptor_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"data\", type: \"dataArray\", length: null},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    results.result = \"success\"; // always success\n    this._addRowForPath(\n      objToSend,\n      \"ble.peripheral.read_descriptor_result\",\n      results,\n    );\n  }\n\n  public notifyFromBinaryServerWriteDescriptorValue(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"descriptor_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"result\", type: \"int\", length: 1},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    results.result =\n      results.result === this._commandResults.success ? \"success\" : \"failed\";\n    this._addRowForPath(\n      objToSend,\n      \"ble.peripheral.write_descriptor_result\",\n      results,\n    );\n  }\n\n  public notifyFromBinaryServerNotifyReadDescriptorValue(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"descriptor_uuid\", type: \"uuid\", length: this.uuidLength},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    this._addRowForPath(\n      objToSend,\n      \"ble.peripheral.notify_read_descriptor\",\n      results,\n    );\n  }\n\n  public notifyFromBinaryServerNotifyWriteDescriptorValue(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"descriptor_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"data\", type: \"dataArray\", length: null},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n    this._addRowForPath(\n      objToSend,\n      \"ble.peripheral.notify_write_descriptor\",\n      results,\n    );\n  }\n\n  public notifyFromBinaryError(objToSend: any, payload?: any) {\n    const schema: any = [\n      {name: \"module_error_code\", type: \"char\", length: 1},\n      {name: \"error_code\", type: \"char\", length: 1},\n      {name: \"function_code\", type: \"char\", length: 1},\n      {name: \"address\", type: \"hex\", length: 6, endianness: \"little\"},\n      {name: \"service_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"characteristic_uuid\", type: \"uuid\", length: this.uuidLength},\n      {name: \"descriptor_uuid\", type: \"uuid\", length: this.uuidLength},\n    ];\n\n    const results: any = JsonBinaryConverter.convertFromBinaryToJson(schema, payload);\n\n    const errorMessage: any = {\n      0x00: \"no error\",\n      0x01: \"device not connected\",\n      0x02: \"service not found\",\n      0x03: \"charavteristic not found\",\n      0x04: \"descriptor not found\",\n      0x05: \"no permission\",\n      0x06: \"device not found\",\n      0x07: \"ble is busy\",\n      0x08: \"service already running\",\n      0x09: \"security param are already set\",\n      0xff: \"error\",\n    };\n\n    const functionMessage: any = {\n      0: \"on setting advertisement data\",\n      1: \"on setting scan response data\",\n      2: \"on starting advertisement\",\n      3: \"on stopping advertisement\",\n      4: \"on starting scan\",\n      5: \"on stoping scan\",\n      6: \"\",\n      7: \"on connecting device\",\n      8: \"on getting services\",\n      9: \"on getting characteristic\",\n      10: \"on writing characteristic\",\n      11: \"on reading characteristic\",\n      14: \"on getting descriptor\",\n      15: \"on writing descriptor\",\n      16: \"on reading descriptor\",\n      20: \"on start pheripheral\",\n      21: \"on notify connect\",\n      22: \"on adding service\",\n      23: \"on adding characteristic\",\n      24: \"on adding descriptor\",\n      25: \"on writing characteristic\",\n      26: \"on reading characteristic\",\n      27: \"on writing characteristic from remote\",\n      28: \"on reading characteristic from remote\",\n      29: \"on writing descriptor\",\n      30: \"on reading descriptor\",\n      31: \"on writing descriptor from remote\",\n      32: \"on reading descriptor from remote\",\n      33: \"on notify characteristic\",\n      34: \"on start/stop service\",\n      35: \"on set security auth param\",\n      36: \"on set security encryption level param\",\n      37: \"on set security key type param\",\n      38: \"on set security key size param\",\n      39: \"on set security io capability\",\n      40: \"on clear bonding devices list\",\n    };\n\n    results.message =\n      errorMessage[results.error_code] +\n      \" \" +\n      functionMessage[results.function_code];\n\n    this.envelopError(objToSend, \"ble\", results);\n  }\n\n  public _addRowForPath(sendObj: any, path: any, row: any) {\n    const keys: any = path.split(\".\");\n    let target: any = sendObj;\n    for (let index = 0; index < keys.length - 1; index++) {\n      target[keys[index]] = target[keys[index]] || {};\n      target = target[keys[index]];\n    }\n    target[keys[keys.length - 1]] = row;\n  }\n}\n\nexport default WSCommandBle;\n"]}