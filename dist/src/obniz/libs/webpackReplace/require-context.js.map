{"version":3,"sources":["../src/obniz/libs/webpackReplace/require-context.ts"],"names":[],"mappings":";;AAAA,IAAI,OAAY,CAAC;AACjB,yBAA0B;AAC1B,gCAAiC;AACjC,oCAAqC;AACrC,6BAA8B;AAE9B,kBAAe,CAAC,SAAiB,EAAE,SAAkB,EAAE,MAAc,EAAO,EAAE;IAE5E,kCAAkC;IAClC,IAAI,QAAQ,GAAQ,SAAS,CAAC;IAE9B,IAAI,SAAS,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;QACxB,gBAAgB;QAChB,IAAI,GAAG,GAAQ,SAAS,CAAC;QACzB,IAAI,OAAO,EAAE;YACX,GAAG,GAAG,OAAO,CAAC;SACf;QACD,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC;KACtC;SAAM,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,EAAE;QACtC,cAAc;QACd,QAAQ,GAAG,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;KACvC;IAED,MAAM,IAAI,GAAS,OAAe;SAC/B,KAAK,CAAC,QAAQ,EAAE;QACf,IAAI,EAAE,IAAI;QACV,SAAS,EAAE,SAAS,IAAI,KAAK;KAC9B,CAAC;SACD,MAAM,CAAC,CAAC,IAAY,EAAE,EAAE;QACvB,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,cAAc,CAAC,CAAC;IAC9C,CAAC,CAAC;SACD,GAAG,CAAC,CAAC,IAAY,EAAE,EAAE;QACpB,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;IACzD,CAAC,CAAC,CAAC;IAEL,MAAM,OAAO,GAAQ,CAAC,GAAW,EAAE,EAAE;QACnC,MAAM,UAAU,GAAQ,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAC7C,IAAI,cAAc,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE;YACnC,OAAO,OAAO,CAAC,UAAU,CAAC,CAAC;SAC5B;aAAM,IAAI,eAAe,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE;YAC3C,OAAO,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,YAAY,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC,CAAC;SAC3D;aAAM;YACL,MAAM,IAAI,KAAK,CAAC,cAAc,CAAC,CAAC;SACjC;IACH,CAAC,CAAC;IAEF,OAAO,CAAC,OAAO,GAAG,CAAC,GAAW,EAAE,EAAE;QAChC,OAAO,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;IAClC,CAAC,CAAC;IAEF,OAAO,CAAC,IAAI,GAAG,GAAG,EAAE;QAClB,OAAO,IAAI,CAAC;IACd,CAAC,CAAC;IAEF,OAAO,OAAO,CAAC;AACjB,CAAC,CAAC;AAES,QAAA,UAAU,GAAG,CAAC,IAAY,EAAE,EAAE;IACvC,OAAO,GAAG,IAAI,CAAC;AACjB,CAAC,CAAC","file":"require-context.js","sourcesContent":["let baseDir: any;\r\nimport fs = require(\"fs\");\r\nimport yaml = require(\"js-yaml\");\r\nimport nodeDir = require(\"node-dir\");\r\nimport path = require(\"path\");\r\n\r\nexport default (directory: string, recursive: boolean, regExp: RegExp): any => {\r\n\r\n  // Assume absolute path by default\r\n  let basepath: any = directory;\r\n\r\n  if (directory[0] === \".\") {\r\n    // Relative path\r\n    let dir: any = __dirname;\r\n    if (baseDir) {\r\n      dir = baseDir;\r\n    }\r\n    basepath = path.join(dir, directory);\r\n  } else if (!path.isAbsolute(directory)) {\r\n    // Module path\r\n    basepath = require.resolve(directory);\r\n  }\r\n\r\n  const keys: any = (nodeDir as any)\r\n    .files(basepath, {\r\n      sync: true,\r\n      recursive: recursive || false,\r\n    })\r\n    .filter((file: string) => {\r\n      return file.match(regExp || /\\.(json|js)$/);\r\n    })\r\n    .map((file: string) => {\r\n      return path.join(\".\", file.slice(basepath.length + 1));\r\n    });\r\n\r\n  const context: any = (key: string) => {\r\n    const modulePath: any = context.resolve(key);\r\n    if (/\\.(json|js)$/.test(modulePath)) {\r\n      return require(modulePath);\r\n    } else if (/\\.(yaml|yml)$/.test(modulePath)) {\r\n      return yaml.safeLoad(fs.readFileSync(modulePath, \"utf8\"));\r\n    } else {\r\n      throw new Error(\"unknown type\");\r\n    }\r\n  };\r\n\r\n  context.resolve = (key: string) => {\r\n    return path.join(basepath, key);\r\n  };\r\n\r\n  context.keys = () => {\r\n    return keys;\r\n  };\r\n\r\n  return context;\r\n};\r\n\r\nexport let setBaseDir = (base: string) => {\r\n  baseDir = base;\r\n};\r\n"]}